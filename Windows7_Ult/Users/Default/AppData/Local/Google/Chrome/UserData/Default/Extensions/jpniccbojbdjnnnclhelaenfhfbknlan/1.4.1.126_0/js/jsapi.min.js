/*
 Maps api created at 2GIS. Build on Leaflet.
 (c) 2013-2014, 2GIS
*/

!function(window,document,undefined){function expose(){var t=window.L;L.noConflict=function(){return window.L=t,this},window.L=L}function getPageLang(){var t=document.documentElement,e=t.lang||t.getAttributeNS&&t.getAttributeNS("http://www.w3.org/XML/1998/namespace","lang")||"ru";return e}var L={version:"0.8-dev"};"object"==typeof module&&"object"==typeof module.exports?module.exports=L:"function"==typeof define&&define.amd?define(L):expose(),L.Util={extend:function(t){var e,i,n,o,r=Array.prototype.slice.call(arguments,1);for(i=0,n=r.length;n>i;i++){o=r[i];for(e in o)t[e]=o[e]}return t},create:Object.create||function(){function t(){}return function(e){return t.prototype=e,new t}}(),bind:function(t,e){var i=Array.prototype.slice;if(t.bind)return t.bind.apply(t,i.call(arguments,1));var n=i.call(arguments,2);return function(){return t.apply(e,n.length?n.concat(i.call(arguments)):arguments)}},stamp:function(t){return t._leaflet_id=t._leaflet_id||++L.Util.lastId,t._leaflet_id},lastId:0,throttle:function(t,e,i){var n,o,r,s;return s=function(){n=!1,o&&(r.apply(i,o),o=!1)},r=function(){n?o=arguments:(t.apply(i,arguments),setTimeout(s,e),n=!0)}},wrapNum:function(t,e,i){var n=e[1],o=e[0],r=n-o;return t===n&&i?t:((t-o)%r+r)%r+o},falseFn:function(){return!1},formatNum:function(t,e){var i=Math.pow(10,e||5);return Math.round(t*i)/i},trim:function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},splitWords:function(t){return L.Util.trim(t).split(/\s+/)},setOptions:function(t,e){t.hasOwnProperty("options")||(t.options=t.options?L.Util.create(t.options):{});for(var i in e)t.options[i]=e[i];return t.options},getParamString:function(t,e,i){var n=[];for(var o in t)n.push(encodeURIComponent(i?o.toUpperCase():o)+"="+encodeURIComponent(t[o]));return(e&&-1!==e.indexOf("?")?"&":"?")+n.join("&")},template:function(t,e){return t.replace(L.Util.templateRe,function(t,i){var n=e[i];if(n===undefined)throw new Error("No value provided for variable "+t);return"function"==typeof n&&(n=n(e)),n})},templateRe:/\{ *([\w_]+) *\}/g,isArray:Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},emptyImageUrl:"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs="},function(){function t(t){return window["webkit"+t]||window["moz"+t]||window["ms"+t]}function e(t){var e=+new Date,n=Math.max(0,16-(e-i));return i=e+n,window.setTimeout(t,n)}var i=0,n=window.requestAnimationFrame||t("RequestAnimationFrame")||e,o=window.cancelAnimationFrame||t("CancelAnimationFrame")||t("CancelRequestAnimationFrame")||function(t){window.clearTimeout(t)};L.Util.requestAnimFrame=function(t,i,o,r){return o&&n===e?void t.call(i):n.call(window,L.bind(t,i),r)},L.Util.cancelAnimFrame=function(t){t&&o.call(window,t)}}(),L.extend=L.Util.extend,L.bind=L.Util.bind,L.stamp=L.Util.stamp,L.setOptions=L.Util.setOptions,L.Class=function(){},L.Class.extend=function(t){var e=function(){this.initialize&&this.initialize.apply(this,arguments),this._initHooks.length&&this.callInitHooks()},i=e.__super__=this.prototype,n=L.Util.create(i);n.constructor=e,e.prototype=n;for(var o in this)this.hasOwnProperty(o)&&"prototype"!==o&&(e[o]=this[o]);return t.statics&&(L.extend(e,t.statics),delete t.statics),t.includes&&(L.Util.extend.apply(null,[n].concat(t.includes)),delete t.includes),n.options&&(t.options=L.Util.extend(L.Util.create(n.options),t.options)),L.extend(n,t),n._initHooks=[],n.callInitHooks=function(){if(!this._initHooksCalled){i.callInitHooks&&i.callInitHooks.call(this),this._initHooksCalled=!0;for(var t=0,e=n._initHooks.length;e>t;t++)n._initHooks[t].call(this)}},e},L.Class.include=function(t){L.extend(this.prototype,t)},L.Class.mergeOptions=function(t){L.extend(this.prototype.options,t)},L.Class.addInitHook=function(t){var e=Array.prototype.slice.call(arguments,1),i="function"==typeof t?t:function(){this[t].apply(this,e)};this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(i)},L.Evented=L.Class.extend({on:function(t,e,i){if("object"==typeof t)for(var n in t)this._on(n,t[n],e);else{t=L.Util.splitWords(t);for(var o=0,r=t.length;r>o;o++)this._on(t[o],e,i)}return this},off:function(t,e,i){if(t)if("object"==typeof t)for(var n in t)this._off(n,t[n],e);else{t=L.Util.splitWords(t);for(var o=0,r=t.length;r>o;o++)this._off(t[o],e,i)}else delete this._events;return this},_on:function(t,e,i){var n=this._events=this._events||{},o=i&&i!==this&&L.stamp(i);if(o){var r=t+"_idx",s=t+"_len",a=n[r]=n[r]||{},l=L.stamp(e)+"_"+o;a[l]||(a[l]={fn:e,ctx:i},n[s]=(n[s]||0)+1)}else n[t]=n[t]||[],n[t].push({fn:e})},_off:function(t,e,i){var n=this._events,o=t+"_idx",r=t+"_len";if(n){if(!e)return delete n[t],delete n[o],void delete n[r];var s,a,l,c,u,h=i&&i!==this&&L.stamp(i);if(h)u=L.stamp(e)+"_"+h,s=n[o],s&&s[u]&&(c=s[u],delete s[u],n[r]--);else if(s=n[t])for(a=0,l=s.length;l>a;a++)if(s[a].fn===e){c=s[a],s.splice(a,1);break}c&&(c.fn=L.Util.falseFn)}},fire:function(t,e,i){if(!this.listens(t,i))return this;var n=L.Util.extend({},e,{type:t,target:this}),o=this._events;if(o){var r,s,a,l,c=o[t+"_idx"];if(o[t])for(a=o[t].slice(),r=0,s=a.length;s>r;r++)a[r].fn.call(this,n);for(l in c)c[l].fn.call(c[l].ctx,n)}return i&&this._propagateEvent(n),this},listens:function(t,e){var i=this._events;if(i&&(i[t]||i[t+"_len"]))return!0;if(e)for(var n in this._eventParents)if(this._eventParents[n].listens(t,e))return!0;return!1},once:function(t,e,i){if("object"==typeof t){for(var n in t)this.once(n,t[n],e);return this}var o=L.bind(function(){this.off(t,e,i).off(t,o,i)},this);return this.on(t,e,i).on(t,o,i)},addEventParent:function(t){return this._eventParents=this._eventParents||{},this._eventParents[L.stamp(t)]=t,this},removeEventParent:function(t){return this._eventParents&&delete this._eventParents[L.stamp(t)],this},_propagateEvent:function(t){for(var e in this._eventParents)this._eventParents[e].fire(t.type,L.extend({layer:t.target},t),!0)}});var proto=L.Evented.prototype;proto.addEventListener=proto.on,proto.removeEventListener=proto.clearAllEventListeners=proto.off,proto.addOneTimeEventListener=proto.once,proto.fireEvent=proto.fire,proto.hasEventListeners=proto.listens,L.Mixin={Events:proto},function(){var t=navigator.userAgent.toLowerCase(),e=document.documentElement,i="ActiveXObject"in window,n=-1!==t.indexOf("webkit"),o=-1!==t.indexOf("phantom"),r=-1!==t.search("android [23]"),s=-1!==t.indexOf("chrome"),a="undefined"!=typeof orientation,l=navigator.msPointerEnabled&&navigator.msMaxTouchPoints&&!window.PointerEvent,c=window.PointerEvent&&navigator.pointerEnabled&&navigator.maxTouchPoints||l,u=i&&"transition"in e.style,h="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!r,d="MozPerspective"in e.style,p="OTransition"in e.style,f="devicePixelRatio"in window&&window.devicePixelRatio>1;if(!f&&"matchMedia"in window){var m=window.matchMedia("(min-resolution:144dpi)");f=m&&m.matches}var _=!window.L_NO_TOUCH&&!o&&(c||"ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch);L.Browser={ie:i,ielt9:i&&!document.addEventListener,webkit:n,gecko:-1!==t.indexOf("gecko")&&!n&&!window.opera&&!i,android:-1!==t.indexOf("android"),android23:r,chrome:s,safari:!s&&-1!==t.indexOf("safari"),ie3d:u,webkit3d:h,gecko3d:d,opera3d:p,any3d:!window.L_DISABLE_3D&&(u||h||d||p)&&!o,mobile:a,mobileWebkit:a&&n,mobileWebkit3d:a&&h,mobileOpera:a&&window.opera,touch:!!_,msPointer:!!l,pointer:!!c,retina:!!f}}(),L.Point=function(t,e,i){this.x=i?Math.round(t):t,this.y=i?Math.round(e):e},L.Point.prototype={clone:function(){return new L.Point(this.x,this.y)},add:function(t){return this.clone()._add(L.point(t))},_add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(t){return this.clone()._subtract(L.point(t))},_subtract:function(t){return this.x-=t.x,this.y-=t.y,this},divideBy:function(t){return this.clone()._divideBy(t)},_divideBy:function(t){return this.x/=t,this.y/=t,this},multiplyBy:function(t){return this.clone()._multiplyBy(t)},_multiplyBy:function(t){return this.x*=t,this.y*=t,this},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},distanceTo:function(t){t=L.point(t);var e=t.x-this.x,i=t.y-this.y;return Math.sqrt(e*e+i*i)},equals:function(t){return t=L.point(t),t.x===this.x&&t.y===this.y},contains:function(t){return t=L.point(t),Math.abs(t.x)<=Math.abs(this.x)&&Math.abs(t.y)<=Math.abs(this.y)},toString:function(){return"Point("+L.Util.formatNum(this.x)+", "+L.Util.formatNum(this.y)+")"}},L.point=function(t,e,i){return t instanceof L.Point?t:L.Util.isArray(t)?new L.Point(t[0],t[1]):t===undefined||null===t?t:new L.Point(t,e,i)},L.Bounds=function(t,e){if(t)for(var i=e?[t,e]:t,n=0,o=i.length;o>n;n++)this.extend(i[n])},L.Bounds.prototype={extend:function(t){return t=L.point(t),this.min||this.max?(this.min.x=Math.min(t.x,this.min.x),this.max.x=Math.max(t.x,this.max.x),this.min.y=Math.min(t.y,this.min.y),this.max.y=Math.max(t.y,this.max.y)):(this.min=t.clone(),this.max=t.clone()),this},getCenter:function(t){return new L.Point((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,t)},getBottomLeft:function(){return new L.Point(this.min.x,this.max.y)},getTopRight:function(){return new L.Point(this.max.x,this.min.y)},getSize:function(){return this.max.subtract(this.min)},contains:function(t){var e,i;return t="number"==typeof t[0]||t instanceof L.Point?L.point(t):L.bounds(t),t instanceof L.Bounds?(e=t.min,i=t.max):e=i=t,e.x>=this.min.x&&i.x<=this.max.x&&e.y>=this.min.y&&i.y<=this.max.y},intersects:function(t){t=L.bounds(t);var e=this.min,i=this.max,n=t.min,o=t.max,r=o.x>=e.x&&n.x<=i.x,s=o.y>=e.y&&n.y<=i.y;return r&&s},isValid:function(){return!(!this.min||!this.max)}},L.bounds=function(t,e){return!t||t instanceof L.Bounds?t:new L.Bounds(t,e)},L.Transformation=function(t,e,i,n){this._a=t,this._b=e,this._c=i,this._d=n},L.Transformation.prototype={transform:function(t,e){return this._transform(t.clone(),e)},_transform:function(t,e){return e=e||1,t.x=e*(this._a*t.x+this._b),t.y=e*(this._c*t.y+this._d),t},untransform:function(t,e){return e=e||1,new L.Point((t.x/e-this._b)/this._a,(t.y/e-this._d)/this._c)}},L.DomUtil={get:function(t){return"string"==typeof t?document.getElementById(t):t},getStyle:function(t,e){var i=t.style[e]||t.currentStyle&&t.currentStyle[e];if((!i||"auto"===i)&&document.defaultView){var n=document.defaultView.getComputedStyle(t,null);i=n?n[e]:null}return"auto"===i?null:i},create:function(t,e,i){var n=document.createElement(t);return n.className=e,i&&i.appendChild(n),n},remove:function(t){var e=t.parentNode;e&&e.removeChild(t)},toFront:function(t){t.parentNode.appendChild(t)},toBack:function(t){var e=t.parentNode;e.insertBefore(t,e.firstChild)},hasClass:function(t,e){if(t.classList!==undefined)return t.classList.contains(e);var i=L.DomUtil.getClass(t);return i.length>0&&new RegExp("(^|\\s)"+e+"(\\s|$)").test(i)},addClass:function(t,e){if(t.classList!==undefined)for(var i=L.Util.splitWords(e),n=0,o=i.length;o>n;n++)t.classList.add(i[n]);else if(!L.DomUtil.hasClass(t,e)){var r=L.DomUtil.getClass(t);L.DomUtil.setClass(t,(r?r+" ":"")+e)}},removeClass:function(t,e){t.classList!==undefined?t.classList.remove(e):L.DomUtil.setClass(t,L.Util.trim((" "+L.DomUtil.getClass(t)+" ").replace(" "+e+" "," ")))},setClass:function(t,e){t.className.baseVal===undefined?t.className=e:t.className.baseVal=e},getClass:function(t){return t.className.baseVal===undefined?t.className:t.className.baseVal},setOpacity:function(t,e){if("opacity"in t.style)t.style.opacity=e;else if("filter"in t.style){var i=!1,n="DXImageTransform.Microsoft.Alpha";try{i=t.filters.item(n)}catch(o){if(1===e)return}e=Math.round(100*e),i?(i.Enabled=100!==e,i.Opacity=e):t.style.filter+=" progid:"+n+"(opacity="+e+")"}},testProp:function(t){for(var e=document.documentElement.style,i=0;i<t.length;i++)if(t[i]in e)return t[i];return!1},setTransform:function(t,e,i){var n=e||new L.Point(0,0),o=L.Browser.webkit3d,r="translate"+(o?"3d":"")+"(",s=(o?",0":"")+")";t.style[L.DomUtil.TRANSFORM]=r+n.x+"px,"+n.y+"px"+s+(i?" scale("+i+")":"")},setPosition:function(t,e,i){t._leaflet_pos=e,L.Browser.any3d&&!i?L.DomUtil.setTransform(t,e):(t.style.left=e.x+"px",t.style.top=e.y+"px")},getPosition:function(t){return t._leaflet_pos}},function(){L.DomUtil.TRANSFORM=L.DomUtil.testProp(["transform","WebkitTransform","OTransform","MozTransform","msTransform"]);var t=L.DomUtil.TRANSITION=L.DomUtil.testProp(["webkitTransition","transition","OTransition","MozTransition","msTransition"]);if(L.DomUtil.TRANSITION_END="webkitTransition"===t||"OTransition"===t?t+"End":"transitionend","onselectstart"in document)L.DomUtil.disableTextSelection=function(){L.DomEvent.on(window,"selectstart",L.DomEvent.preventDefault)},L.DomUtil.enableTextSelection=function(){L.DomEvent.off(window,"selectstart",L.DomEvent.preventDefault)};else{var e=L.DomUtil.testProp(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);L.DomUtil.disableTextSelection=function(){if(e){var t=document.documentElement.style;this._userSelect=t[e],t[e]="none"}},L.DomUtil.enableTextSelection=function(){e&&(document.documentElement.style[e]=this._userSelect,delete this._userSelect)}}L.DomUtil.disableImageDrag=function(){L.DomEvent.on(window,"dragstart",L.DomEvent.preventDefault)},L.DomUtil.enableImageDrag=function(){L.DomEvent.off(window,"dragstart",L.DomEvent.preventDefault)}}(),L.LatLng=function(t,e,i){if(isNaN(t)||isNaN(e))throw new Error("Invalid LatLng object: ("+t+", "+e+")");this.lat=+t,this.lng=+e,i!==undefined&&(this.alt=+i)},L.LatLng.prototype={equals:function(t,e){if(!t)return!1;t=L.latLng(t);var i=Math.max(Math.abs(this.lat-t.lat),Math.abs(this.lng-t.lng));return(e===undefined?1e-9:e)>=i},toString:function(t){return"LatLng("+L.Util.formatNum(this.lat,t)+", "+L.Util.formatNum(this.lng,t)+")"},distanceTo:function(t){return L.CRS.Earth.distance(this,L.latLng(t))},wrap:function(){return L.CRS.Earth.wrapLatLng(this)}},L.latLng=function(t,e){return t instanceof L.LatLng?t:L.Util.isArray(t)&&"object"!=typeof t[0]?3===t.length?new L.LatLng(t[0],t[1],t[2]):new L.LatLng(t[0],t[1]):t===undefined||null===t?t:"object"==typeof t&&"lat"in t?new L.LatLng(t.lat,"lng"in t?t.lng:t.lon):e===undefined?null:new L.LatLng(t,e)},L.LatLngBounds=function(t,e){if(t)for(var i=e?[t,e]:t,n=0,o=i.length;o>n;n++)this.extend(i[n])},L.LatLngBounds.prototype={extend:function(t){var e,i,n=this._southWest,o=this._northEast;if(t instanceof L.LatLng)e=t,i=t;else{if(!(t instanceof L.LatLngBounds))return t?this.extend(L.latLng(t)||L.latLngBounds(t)):this;if(e=t._southWest,i=t._northEast,!e||!i)return this}return n||o?(n.lat=Math.min(e.lat,n.lat),n.lng=Math.min(e.lng,n.lng),o.lat=Math.max(i.lat,o.lat),o.lng=Math.max(i.lng,o.lng)):(this._southWest=new L.LatLng(e.lat,e.lng),this._northEast=new L.LatLng(i.lat,i.lng)),this},pad:function(t){var e=this._southWest,i=this._northEast,n=Math.abs(e.lat-i.lat)*t,o=Math.abs(e.lng-i.lng)*t;return new L.LatLngBounds(new L.LatLng(e.lat-n,e.lng-o),new L.LatLng(i.lat+n,i.lng+o))},getCenter:function(){return new L.LatLng((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new L.LatLng(this.getNorth(),this.getWest())},getSouthEast:function(){return new L.LatLng(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(t){t="number"==typeof t[0]||t instanceof L.LatLng?L.latLng(t):L.latLngBounds(t);var e,i,n=this._southWest,o=this._northEast;return t instanceof L.LatLngBounds?(e=t.getSouthWest(),i=t.getNorthEast()):e=i=t,e.lat>=n.lat&&i.lat<=o.lat&&e.lng>=n.lng&&i.lng<=o.lng},intersects:function(t){t=L.latLngBounds(t);var e=this._southWest,i=this._northEast,n=t.getSouthWest(),o=t.getNorthEast(),r=o.lat>=e.lat&&n.lat<=i.lat,s=o.lng>=e.lng&&n.lng<=i.lng;return r&&s},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(t){return t?(t=L.latLngBounds(t),this._southWest.equals(t.getSouthWest())&&this._northEast.equals(t.getNorthEast())):!1},isValid:function(){return!(!this._southWest||!this._northEast)}},L.latLngBounds=function(t,e){return!t||t instanceof L.LatLngBounds?t:new L.LatLngBounds(t,e)},L.Projection={},L.Projection.LonLat={project:function(t){return new L.Point(t.lng,t.lat)},unproject:function(t){return new L.LatLng(t.y,t.x)},bounds:L.bounds([-180,-90],[180,90])},L.Projection.SphericalMercator={R:6378137,project:function(t){var e=Math.PI/180,i=1-1e-15,n=Math.max(Math.min(Math.sin(t.lat*e),i),-i);return new L.Point(this.R*t.lng*e,this.R*Math.log((1+n)/(1-n))/2)},unproject:function(t){var e=180/Math.PI;return new L.LatLng((2*Math.atan(Math.exp(t.y/this.R))-Math.PI/2)*e,t.x*e/this.R)},bounds:function(){var t=6378137*Math.PI;return L.bounds([-t,-t],[t,t])}()},L.CRS={latLngToPoint:function(t,e){var i=this.projection.project(t),n=this.scale(e);return this.transformation._transform(i,n)},pointToLatLng:function(t,e){var i=this.scale(e),n=this.transformation.untransform(t,i);return this.projection.unproject(n)},project:function(t){return this.projection.project(t)},unproject:function(t){return this.projection.unproject(t)},scale:function(t){return 256*Math.pow(2,t)},getProjectedBounds:function(t){if(this.infinite)return null;var e=this.projection.bounds,i=this.scale(t),n=this.transformation.transform(e.min,i),o=this.transformation.transform(e.max,i);return L.bounds(n,o)},wrapLatLng:function(t){var e=this.wrapLng?L.Util.wrapNum(t.lng,this.wrapLng,!0):t.lng,i=this.wrapLat?L.Util.wrapNum(t.lat,this.wrapLat,!0):t.lat;return L.latLng(i,e)}},L.CRS.Simple=L.extend({},L.CRS,{projection:L.Projection.LonLat,transformation:new L.Transformation(1,0,-1,0),scale:function(t){return Math.pow(2,t)},distance:function(t,e){var i=e.lng-t.lng,n=e.lat-t.lat;return Math.sqrt(i*i+n*n)},infinite:!0}),L.CRS.Earth=L.extend({},L.CRS,{wrapLng:[-180,180],R:6378137,distance:function(t,e){var i=Math.PI/180,n=t.lat*i,o=e.lat*i;return this.R*Math.acos(Math.sin(n)*Math.sin(o)+Math.cos(n)*Math.cos(o)*Math.cos((e.lng-t.lng)*i))}}),L.CRS.EPSG3857=L.extend({},L.CRS.Earth,{code:"EPSG:3857",projection:L.Projection.SphericalMercator,transformation:function(){var t=.5/(Math.PI*L.Projection.SphericalMercator.R);return new L.Transformation(t,.5,-t,.5)}()}),L.CRS.EPSG900913=L.extend({},L.CRS.EPSG3857,{code:"EPSG:900913"}),L.CRS.EPSG4326=L.extend({},L.CRS.Earth,{code:"EPSG:4326",projection:L.Projection.LonLat,transformation:new L.Transformation(1/180,1,-1/180,.5)}),L.Map=L.Evented.extend({options:{crs:L.CRS.EPSG3857,fadeAnimation:!0,trackResize:!0,markerZoomAnimation:!0},initialize:function(t,e){e=L.setOptions(this,e),this._initContainer(t),this._initLayout(),this._onResize=L.bind(this._onResize,this),this._initEvents(),e.maxBounds&&this.setMaxBounds(e.maxBounds),e.center&&e.zoom!==undefined&&this.setView(L.latLng(e.center),e.zoom,{reset:!0}),this._handlers=[],this._layers={},this._zoomBoundLayers={},this.callInitHooks(),this._addLayers(this.options.layers)},setView:function(t,e){return e=e===undefined?this.getZoom():e,this._resetView(L.latLng(t),this._limitZoom(e)),this},setZoom:function(t,e){return this._loaded?this.setView(this.getCenter(),t,{zoom:e}):(this._zoom=this._limitZoom(t),this)},zoomIn:function(t,e){return this.setZoom(this._zoom+(t||1),e)},zoomOut:function(t,e){return this.setZoom(this._zoom-(t||1),e)},setZoomAround:function(t,e,i){var n=this.getZoomScale(e),o=this.getSize().divideBy(2),r=t instanceof L.Point?t:this.latLngToContainerPoint(t),s=r.subtract(o).multiplyBy(1-1/n),a=this.containerPointToLatLng(o.add(s));return this.setView(a,e,{zoom:i})},fitBounds:function(t,e){e=e||{},t=t.getBounds?t.getBounds():L.latLngBounds(t);var i=L.point(e.paddingTopLeft||e.padding||[0,0]),n=L.point(e.paddingBottomRight||e.padding||[0,0]),o=this.getBoundsZoom(t,!1,i.add(n));o=e.maxZoom?Math.min(e.maxZoom,o):o;var r=n.subtract(i).divideBy(2),s=this.project(t.getSouthWest(),o),a=this.project(t.getNorthEast(),o),l=this.unproject(s.add(a).divideBy(2).add(r),o);return this.setView(l,o,e)},fitWorld:function(t){return this.fitBounds([[-90,-180],[90,180]],t)},panTo:function(t,e){return this.setView(t,this._zoom,{pan:e})},panBy:function(t){return this.fire("movestart"),this._rawPanBy(L.point(t)),this.fire("move"),this.fire("moveend")},setMaxBounds:function(t){return t=L.latLngBounds(t),this.options.maxBounds=t,t?(this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):this.off("moveend",this._panInsideMaxBounds)},panInsideBounds:function(t,e){var i=this.getCenter(),n=this._limitCenter(i,this._zoom,t);return i.equals(n)?this:this.panTo(n,e)},invalidateSize:function(t){if(!this._loaded)return this;t=L.extend({animate:!1,pan:!0},t===!0?{animate:!0}:t);var e=this.getSize();this._sizeChanged=!0,this._initialCenter=null;var i=this.getSize(),n=e.divideBy(2).round(),o=i.divideBy(2).round(),r=n.subtract(o);return r.x||r.y?(t.animate&&t.pan?this.panBy(r):(t.pan&&this._rawPanBy(r),this.fire("move"),t.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(L.bind(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:e,newSize:i})):this},addHandler:function(t,e){if(!e)return this;var i=this[t]=new e(this);return this._handlers.push(i),this.options[t]&&i.enable(),this},remove:function(){this._initEvents("off");try{delete this._container._leaflet}catch(t){this._container._leaflet=undefined}return L.DomUtil.remove(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._clearHandlers(),this._loaded&&this.fire("unload"),this},createPane:function(t,e){var i="leaflet-pane"+(t?" leaflet-"+t.replace("Pane","")+"-pane":""),n=L.DomUtil.create("div",i,e||this._mapPane);return t&&(this._panes[t]=n),n},getCenter:function(){return this._checkIfLoaded(),this._initialCenter&&!this._moved()?this._initialCenter:this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var t=this.getPixelBounds(),e=this.unproject(t.getBottomLeft()),i=this.unproject(t.getTopRight());return new L.LatLngBounds(e,i)},getMinZoom:function(){return this.options.minZoom===undefined?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===undefined?this._layersMaxZoom===undefined?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(t,e,i){t=L.latLngBounds(t);var n,o=this.getMinZoom()-(e?1:0),r=this.getMaxZoom(),s=this.getSize(),a=t.getNorthWest(),l=t.getSouthEast(),c=!0;i=L.point(i||[0,0]);do o++,n=this.project(l,o).subtract(this.project(a,o)).add(i),c=e?n.x<s.x||n.y<s.y:s.contains(n);while(c&&r>=o);return c&&e?null:e?o:o-1},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new L.Point(this._container.clientWidth,this._container.clientHeight),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(){var t=this._getTopLeftPoint();return new L.Bounds(t,t.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._initialTopLeftPoint},getPixelWorldBounds:function(){return this.options.crs.getProjectedBounds(this.getZoom())},getPane:function(t){return"string"==typeof t?this._panes[t]:t},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(t){var e=this.options.crs;return e.scale(t)/e.scale(this._zoom)},getScaleZoom:function(t){return this._zoom+Math.log(t)/Math.LN2},project:function(t,e){return e=e===undefined?this._zoom:e,this.options.crs.latLngToPoint(L.latLng(t),e)},unproject:function(t,e){return e=e===undefined?this._zoom:e,this.options.crs.pointToLatLng(L.point(t),e)},layerPointToLatLng:function(t){var e=L.point(t).add(this.getPixelOrigin());return this.unproject(e)},latLngToLayerPoint:function(t){var e=this.project(L.latLng(t))._round();return e._subtract(this.getPixelOrigin())},wrapLatLng:function(t){return this.options.crs.wrapLatLng(L.latLng(t))},distance:function(t,e){return this.options.crs.distance(L.latLng(t),L.latLng(e))},containerPointToLayerPoint:function(t){return L.point(t).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(t){return L.point(t).add(this._getMapPanePos())},containerPointToLatLng:function(t){var e=this.containerPointToLayerPoint(L.point(t));return this.layerPointToLatLng(e)},latLngToContainerPoint:function(t){return this.layerPointToContainerPoint(this.latLngToLayerPoint(L.latLng(t)))},mouseEventToContainerPoint:function(t){return L.DomEvent.getMousePosition(t,this._container)},mouseEventToLayerPoint:function(t){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(t))},mouseEventToLatLng:function(t){return this.layerPointToLatLng(this.mouseEventToLayerPoint(t))},_initContainer:function(t){var e=this._container=L.DomUtil.get(t);if(!e)throw new Error("Map container not found.");if(e._leaflet)throw new Error("Map container is already initialized.");e._leaflet=!0},_initLayout:function(){var t=this._container;this._fadeAnimated=this.options.fadeAnimation&&L.Browser.any3d,L.DomUtil.addClass(t,"leaflet-container"+(L.Browser.touch?" leaflet-touch":"")+(L.Browser.retina?" leaflet-retina":"")+(L.Browser.ielt9?" leaflet-oldie":"")+(L.Browser.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var e=L.DomUtil.getStyle(t,"position");"absolute"!==e&&"relative"!==e&&"fixed"!==e&&(t.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var t=this._panes={};this._mapPane=this.createPane("mapPane",this._container),this.createPane("tilePane"),this.createPane("shadowPane"),this.createPane("overlayPane"),this.createPane("markerPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(L.DomUtil.addClass(t.markerPane,"leaflet-zoom-hide"),L.DomUtil.addClass(t.shadowPane,"leaflet-zoom-hide"))},_resetView:function(t,e,i,n){var o=this._zoom!==e;n||(this.fire("movestart"),o&&this.fire("zoomstart")),this._zoom=e,this._initialCenter=t,this._initialTopLeftPoint=this._getNewTopLeftPoint(t),i?this._initialTopLeftPoint._add(this._getMapPanePos()):L.DomUtil.setPosition(this._mapPane,new L.Point(0,0));var r=!this._loaded;this._loaded=!0,this.fire("viewreset",{hard:!i}),r&&this.fire("load"),this.fire("move"),(o||n)&&this.fire("zoomend"),this.fire("moveend",{hard:!i})},_rawPanBy:function(t){L.DomUtil.setPosition(this._mapPane,this._getMapPanePos().subtract(t))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(t){L.DomEvent&&(t=t||"on",L.DomEvent[t](this._container,"click dblclick mousedown mouseup mouseenter mouseleave mousemove contextmenu",this._handleMouseEvent,this),this.options.trackResize&&L.DomEvent[t](window,"resize",this._onResize,this))},_onResize:function(){L.Util.cancelAnimFrame(this._resizeRequest),this._resizeRequest=L.Util.requestAnimFrame(function(){this.invalidateSize({debounceMoveend:!0})},this,!1,this._container)},_handleMouseEvent:function(t){this._loaded&&this._fireMouseEvent(this,t,"mouseenter"===t.type?"mouseover":"mouseleave"===t.type?"mouseout":t.type)},_fireMouseEvent:function(t,e,i,n,o){if(i=i||e.type,!L.DomEvent._skipped(e)){if("click"===i){if(!e._simulated&&(this.dragging&&this.dragging.moved()||this.boxZoom&&this.boxZoom.moved()))return;t.fire("preclick")}if(t.listens(i,n)){"contextmenu"===i&&L.DomEvent.preventDefault(e),("click"===i||"dblclick"===i||"contextmenu"===i)&&L.DomEvent.stopPropagation(e);var r={originalEvent:e,containerPoint:this.mouseEventToContainerPoint(e)};r.layerPoint=this.containerPointToLayerPoint(r.containerPoint),r.latlng=o||this.layerPointToLatLng(r.layerPoint),t.fire(i,r,n)}}},_clearHandlers:function(){for(var t=0,e=this._handlers.length;e>t;t++)this._handlers[t].disable()},whenReady:function(t,e){return this._loaded?t.call(e||this,{target:this}):this.on("load",t,e),this},_getMapPanePos:function(){return L.DomUtil.getPosition(this._mapPane)},_moved:function(){var t=this._getMapPanePos();return t&&!t.equals([0,0])},_getTopLeftPoint:function(){return this.getPixelOrigin().subtract(this._getMapPanePos())},_getNewTopLeftPoint:function(t,e){var i=this.getSize()._divideBy(2);return this.project(t,e)._subtract(i)._round()},_latLngToNewLayerPoint:function(t,e,i){var n=this._getNewTopLeftPoint(i,e).add(this._getMapPanePos());return this.project(t,e)._subtract(n)},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(t){return this.latLngToLayerPoint(t).subtract(this._getCenterLayerPoint())},_limitCenter:function(t,e,i){if(!i)return t;var n=this.project(t,e),o=this.getSize().divideBy(2),r=new L.Bounds(n.subtract(o),n.add(o)),s=this._getBoundsOffset(r,i,e);return this.unproject(n.add(s),e)},_limitOffset:function(t,e){if(!e)return t;var i=this.getPixelBounds(),n=new L.Bounds(i.min.add(t),i.max.add(t));return t.add(this._getBoundsOffset(n,e))},_getBoundsOffset:function(t,e,i){var n=this.project(e.getNorthWest(),i).subtract(t.min),o=this.project(e.getSouthEast(),i).subtract(t.max),r=this._rebound(n.x,-o.x),s=this._rebound(n.y,-o.y);return new L.Point(r,s)},_rebound:function(t,e){return t+e>0?Math.round(t-e)/2:Math.max(0,Math.ceil(t))-Math.max(0,Math.floor(e))},_limitZoom:function(t){var e=this.getMinZoom(),i=this.getMaxZoom();return Math.max(e,Math.min(i,t))}}),L.map=function(t,e){return new L.Map(t,e)},L.Layer=L.Evented.extend({options:{pane:"overlayPane"},addTo:function(t){return t.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(t){return t&&t.removeLayer(this),this},getPane:function(t){return this._map.getPane(t?this.options[t]||t:this.options.pane)},_layerAdd:function(t){var e=t.target;e.hasLayer(this)&&(this._map=e,this._zoomAnimated=e._zoomAnimated,this.onAdd(e),this.getAttribution&&this._map.attributionControl&&this._map.attributionControl.addAttribution(this.getAttribution()),this.getEvents&&e.on(this.getEvents(),this),this.fire("add"),e.fire("layeradd",{layer:this}))}}),L.Map.include({addLayer:function(t){var e=L.stamp(t);return this._layers[e]?t:(this._layers[e]=t,t._mapToAdd=this,t.beforeAdd&&t.beforeAdd(this),this.whenReady(t._layerAdd,t),this)},removeLayer:function(t){var e=L.stamp(t);return this._layers[e]?(this._loaded&&t.onRemove(this),t.getAttribution&&this.attributionControl&&this.attributionControl.removeAttribution(t.getAttribution()),t.getEvents&&this.off(t.getEvents(),t),delete this._layers[e],this._loaded&&(this.fire("layerremove",{layer:t}),t.fire("remove")),t._map=t._mapToAdd=null,this):this},hasLayer:function(t){return!!t&&L.stamp(t)in this._layers},eachLayer:function(t,e){for(var i in this._layers)t.call(e,this._layers[i]);return this},_addLayers:function(t){t=t?L.Util.isArray(t)?t:[t]:[];for(var e=0,i=t.length;i>e;e++)this.addLayer(t[e])},_addZoomLimit:function(t){(isNaN(t.options.maxZoom)||!isNaN(t.options.minZoom))&&(this._zoomBoundLayers[L.stamp(t)]=t,this._updateZoomLevels())},_removeZoomLimit:function(t){var e=L.stamp(t);this._zoomBoundLayers[e]&&(delete this._zoomBoundLayers[e],this._updateZoomLevels())},_updateZoomLevels:function(){var t=1/0,e=-1/0,i=this._getZoomSpan();for(var n in this._zoomBoundLayers){var o=this._zoomBoundLayers[n].options;t=o.minZoom===undefined?t:Math.min(t,o.minZoom),e=o.maxZoom===undefined?e:Math.max(e,o.maxZoom)}this._layersMaxZoom=e===-1/0?undefined:e,this._layersMinZoom=1/0===t?undefined:t,i!==this._getZoomSpan()&&this.fire("zoomlevelschange")
}}),L.Projection.Mercator={R:6378137,R_MINOR:6356752.314245179,bounds:L.bounds([-20037508.34279,-15496570.73972],[20037508.34279,18764656.23138]),project:function(t){var e=Math.PI/180,i=this.R,n=t.lat*e,o=this.R_MINOR/i,r=Math.sqrt(1-o*o),s=r*Math.sin(n),a=Math.tan(Math.PI/4-n/2)/Math.pow((1-s)/(1+s),r/2);return n=-i*Math.log(Math.max(a,1e-10)),new L.Point(t.lng*e*i,n)},unproject:function(t){for(var e,i=180/Math.PI,n=this.R,o=this.R_MINOR/n,r=Math.sqrt(1-o*o),s=Math.exp(-t.y/n),a=Math.PI/2-2*Math.atan(s),l=0,c=.1;15>l&&Math.abs(c)>1e-7;l++)e=r*Math.sin(a),e=Math.pow((1-e)/(1+e),r/2),c=Math.PI/2-2*Math.atan(s*e)-a,a+=c;return new L.LatLng(a*i,t.x*i/n)}},L.CRS.EPSG3395=L.extend({},L.CRS.Earth,{code:"EPSG:3395",projection:L.Projection.Mercator,transformation:function(){var t=.5/(Math.PI*L.Projection.Mercator.R);return new L.Transformation(t,.5,-t,.5)}()}),L.GridLayer=L.Layer.extend({options:{pane:"tilePane",tileSize:256,opacity:1,unloadInvisibleTiles:L.Browser.mobile,updateWhenIdle:L.Browser.mobile,updateInterval:150},initialize:function(t){t=L.setOptions(this,t)},onAdd:function(){this._initContainer(),this.options.updateWhenIdle||(this._update=L.Util.throttle(this._update,this.options.updateInterval,this)),this._reset(),this._update()},beforeAdd:function(t){t._addZoomLimit(this)},onRemove:function(t){this._clearBgBuffer(),L.DomUtil.remove(this._container),t._removeZoomLimit(this),this._container=null},bringToFront:function(){return this._map&&(L.DomUtil.toFront(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(L.DomUtil.toBack(this._container),this._setAutoZIndex(Math.min)),this},getAttribution:function(){return this.options.attribution},getContainer:function(){return this._container},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},redraw:function(){return this._map&&(this._reset({hard:!0}),this._update()),this},getEvents:function(){var t={viewreset:this._reset,moveend:this._update};return this.options.updateWhenIdle||(t.move=this._update),this._zoomAnimated&&(t.zoomstart=this._startZoomAnim,t.zoomanim=this._animateZoom,t.zoomend=this._endZoomAnim),t},_updateZIndex:function(){this._container&&this.options.zIndex!==undefined&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(t){for(var e,i=this.getPane().children,n=-t(-1/0,1/0),o=0,r=i.length;r>o;o++)e=i[o].style.zIndex,i[o]!==this._container&&e&&(n=t(n,+e));isFinite(n)&&(this.options.zIndex=n+t(-1,1),this._updateZIndex())},_updateOpacity:function(){var t=this.options.opacity;if(L.Browser.ielt9)for(var e in this._tiles)L.DomUtil.setOpacity(this._tiles[e],t);else L.DomUtil.setOpacity(this._container,t)},_initContainer:function(){if(!this._container){if(this._container=L.DomUtil.create("div","leaflet-layer"),this._updateZIndex(),this._zoomAnimated){var t="leaflet-tile-container leaflet-zoom-animated";this._bgBuffer=L.DomUtil.create("div",t,this._container),this._tileContainer=L.DomUtil.create("div",t,this._container),L.DomUtil.setTransform(this._tileContainer)}else this._tileContainer=this._container;this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container)}},_reset:function(t){for(var e in this._tiles)this.fire("tileunload",{tile:this._tiles[e]});this._tiles={},this._tilesToLoad=0,this._tilesTotal=0,this._tileContainer.innerHTML="",this._zoomAnimated&&t&&t.hard&&this._clearBgBuffer(),this._tileNumBounds=this._getTileNumBounds(),this._resetWrap()},_resetWrap:function(){var t=this._map,e=t.options.crs;if(!e.infinite){var i=this._getTileSize();e.wrapLng&&(this._wrapLng=[Math.floor(t.project([0,e.wrapLng[0]]).x/i),Math.ceil(t.project([0,e.wrapLng[1]]).x/i)]),e.wrapLat&&(this._wrapLat=[Math.floor(t.project([e.wrapLat[0],0]).y/i),Math.ceil(t.project([e.wrapLat[1],0]).y/i)])}},_getTileSize:function(){return this.options.tileSize},_update:function(){if(this._map){var t=this._map.getPixelBounds(),e=this._map.getZoom(),i=this._getTileSize();if(!(e>this.options.maxZoom||e<this.options.minZoom)){var n=L.bounds(t.min.divideBy(i).floor(),t.max.divideBy(i).floor());this._addTiles(n),this.options.unloadInvisibleTiles&&this._removeOtherTiles(n)}}},_addTiles:function(t){var e,i,n,o=[],r=t.getCenter(),s=this._map.getZoom();for(e=t.min.y;e<=t.max.y;e++)for(i=t.min.x;i<=t.max.x;i++)n=new L.Point(i,e),n.z=s,this._tileCoordsToKey(n)in this._tiles||!this._isValidTile(n)||o.push(n);var a=o.length;if(0!==a){this._tilesToLoad||this.fire("loading"),this._tilesToLoad+=a,this._tilesTotal+=a,o.sort(function(t,e){return t.distanceTo(r)-e.distanceTo(r)});var l=document.createDocumentFragment();for(i=0;a>i;i++)this._addTile(o[i],l);this._tileContainer.appendChild(l)}},_isValidTile:function(t){var e=this._map.options.crs;if(!e.infinite){var i=this._tileNumBounds;if(!e.wrapLng&&(t.x<i.min.x||t.x>i.max.x)||!e.wrapLat&&(t.y<i.min.y||t.y>i.max.y))return!1}if(!this.options.bounds)return!0;var n=this._tileCoordsToBounds(t);return L.latLngBounds(this.options.bounds).intersects(n)},_tileCoordsToBounds:function(t){var e=this._map,i=this.options.tileSize,n=t.multiplyBy(i),o=n.add([i,i]),r=e.wrapLatLng(e.unproject(n,t.z)),s=e.wrapLatLng(e.unproject(o,t.z));return new L.LatLngBounds(r,s)},_tileCoordsToKey:function(t){return t.x+":"+t.y},_keyToTileCoords:function(t){var e=t.split(":"),i=parseInt(e[0],10),n=parseInt(e[1],10);return new L.Point(i,n)},_removeOtherTiles:function(t){for(var e in this._tiles)t.contains(this._keyToTileCoords(e))||this._removeTile(e)},_removeTile:function(t){var e=this._tiles[t];L.DomUtil.remove(e),delete this._tiles[t],this.fire("tileunload",{tile:e})},_initTile:function(t){var e=this._getTileSize();L.DomUtil.addClass(t,"leaflet-tile"),t.style.width=e+"px",t.style.height=e+"px",t.onselectstart=L.Util.falseFn,t.onmousemove=L.Util.falseFn,L.Browser.ielt9&&this.options.opacity<1&&L.DomUtil.setOpacity(t,this.options.opacity),L.Browser.android&&!L.Browser.android23&&(t.style.WebkitBackfaceVisibility="hidden")},_addTile:function(t,e){var i=this._getTilePos(t);this._wrapCoords(t);var n=this.createTile(t,L.bind(this._tileReady,this));this._initTile(n),this.createTile.length<2&&setTimeout(L.bind(this._tileReady,this,null,n),0),L.DomUtil.setPosition(n,i,!0),this._tiles[this._tileCoordsToKey(t)]=n,e.appendChild(n),this.fire("tileloadstart",{tile:n})},_tileReady:function(t,e){t&&this.fire("tileerror",{error:t,tile:e}),L.DomUtil.addClass(e,"leaflet-tile-loaded"),this.fire("tileload",{tile:e}),this._tilesToLoad--,0===this._tilesToLoad&&this._visibleTilesReady()},_visibleTilesReady:function(){this.fire("load"),this._zoomAnimated&&(clearTimeout(this._clearBgBufferTimer),this._clearBgBufferTimer=setTimeout(L.bind(this._clearBgBuffer,this),300))},_getTilePos:function(t){return t.multiplyBy(this._getTileSize()).subtract(this._map.getPixelOrigin())},_wrapCoords:function(t){t.x=this._wrapLng?L.Util.wrapNum(t.x,this._wrapLng):t.x,t.y=this._wrapLat?L.Util.wrapNum(t.y,this._wrapLat):t.y},_getTileNumBounds:function(){var t=this._map.getPixelWorldBounds(),e=this._getTileSize();return t?L.bounds(t.min.divideBy(e).floor(),t.max.divideBy(e).ceil().subtract([1,1])):null},_startZoomAnim:function(){this._prepareBgBuffer(),this._prevTranslate=this._translate||new L.Point(0,0),this._prevScale=this._scale},_animateZoom:function(t){this._translate=this._prevTranslate.multiplyBy(t.scale).add(t.origin.multiplyBy(1-t.scale)),this._scale=this._prevScale*t.scale,L.DomUtil.setTransform(this._bgBuffer,this._translate,this._scale)},_endZoomAnim:function(){var t=this._tileContainer;t.style.visibility="",L.DomUtil.toFront(t)},_clearBgBuffer:function(){var t=this._map,e=this._bgBuffer;t&&!t._animatingZoom&&!t.touchZoom._zooming&&e&&(e.innerHTML="",L.DomUtil.setTransform(e))},_prepareBgBuffer:function(){var t=this._tileContainer,e=this._bgBuffer;return this._abortLoading&&this._abortLoading(),this._tilesToLoad/this._tilesTotal>.5?void(t.style.visibility="hidden"):(e.style.visibility="hidden",L.DomUtil.setTransform(e),this._tileContainer=e,this._bgBuffer=t,this._translate=new L.Point(0,0),this._scale=1,void clearTimeout(this._clearBgBufferTimer))}}),L.gridLayer=function(t){return new L.GridLayer(t)},L.TileLayer=L.GridLayer.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",zoomOffset:0},initialize:function(t,e){this._url=t,e=L.setOptions(this,e),e.detectRetina&&L.Browser.retina&&e.maxZoom>0&&(e.tileSize=Math.floor(e.tileSize/2),e.zoomOffset++,e.minZoom=Math.max(0,e.minZoom),e.maxZoom--),"string"==typeof e.subdomains&&(e.subdomains=e.subdomains.split(""))},setUrl:function(t,e){return this._url=t,e||this.redraw(),this},createTile:function(t,e){var i=document.createElement("img");return i.onload=L.bind(this._tileOnLoad,this,e,i),i.onerror=L.bind(this._tileOnError,this,e,i),i.alt="",i.src=this.getTileUrl(t),i},getTileUrl:function(t){return L.Util.template(this._url,L.extend({r:this.options.detectRetina&&L.Browser.retina&&this.options.maxZoom>0?"@2x":"",s:this._getSubdomain(t),x:t.x,y:this.options.tms?this._tileNumBounds.max.y-t.y:t.y,z:this._getZoomForUrl()},this.options))},_tileOnLoad:function(t,e){t(null,e)},_tileOnError:function(t,e,i){var n=this.options.errorTileUrl;n&&(e.src=n),t(i,e)},_getTileSize:function(){var t=this._map,e=this.options,i=t.getZoom()+e.zoomOffset,n=e.maxNativeZoom;return n&&i>n?Math.round(t.getZoomScale(i)/t.getZoomScale(n)*e.tileSize):e.tileSize},_removeTile:function(t){var e=this._tiles[t];L.GridLayer.prototype._removeTile.call(this,t),L.Browser.android||(e.onload=null,e.src=L.Util.emptyImageUrl)},_getZoomForUrl:function(){var t=this.options,e=this._map.getZoom();return t.zoomReverse&&(e=t.maxZoom-e),e+=t.zoomOffset,t.maxNativeZoom?Math.min(e,t.maxNativeZoom):e},_getSubdomain:function(t){var e=Math.abs(t.x+t.y)%this.options.subdomains.length;return this.options.subdomains[e]},_abortLoading:function(){var t,e;for(t in this._tiles)e=this._tiles[t],e.complete||(e.onload=L.Util.falseFn,e.onerror=L.Util.falseFn,e.src=L.Util.emptyImageUrl,L.DomUtil.remove(e))}}),L.tileLayer=function(t,e){return new L.TileLayer(t,e)},L.TileLayer.WMS=L.TileLayer.extend({defaultWmsParams:{service:"WMS",request:"GetMap",version:"1.1.1",layers:"",styles:"",format:"image/jpeg",transparent:!1},initialize:function(t,e){this._url=t;var i=L.extend({},this.defaultWmsParams);for(var n in e)this.options.hasOwnProperty(n)||"crs"===n||(i[n]=e[n]);e=L.setOptions(this,e),i.width=i.height=e.tileSize*(e.detectRetina&&L.Browser.retina?2:1),this.wmsParams=i},onAdd:function(t){this._crs=this.options.crs||t.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var e=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[e]=this._crs.code,L.TileLayer.prototype.onAdd.call(this,t)},getTileUrl:function(t){var e=this._tileCoordsToBounds(t),i=this._crs.project(e.getNorthWest()),n=this._crs.project(e.getSouthEast()),o=(this._wmsVersion>=1.3&&this._crs===L.CRS.EPSG4326?[n.y,i.x,i.y,n.x]:[i.x,n.y,n.x,i.y]).join(","),r=L.Util.template(this._url,{s:this._getSubdomain(t)});return r+L.Util.getParamString(this.wmsParams,r,!0)+"&BBOX="+o},setParams:function(t,e){return L.extend(this.wmsParams,t),e||this.redraw(),this}}),L.tileLayer.wms=function(t,e){return new L.TileLayer.WMS(t,e)},L.ImageOverlay=L.Layer.extend({options:{opacity:1},initialize:function(t,e,i){this._url=t,this._bounds=L.latLngBounds(e),L.setOptions(this,i)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){L.DomUtil.remove(this._image)},setOpacity:function(t){return this.options.opacity=t,this._image&&this._updateOpacity(),this},bringToFront:function(){return this._map&&L.DomUtil.toFront(this._image),this},bringToBack:function(){return this._map&&L.DomUtil.toBack(this._image),this},setUrl:function(t){return this._url=t,this._image&&(this._image.src=t),this},getAttribution:function(){return this.options.attribution},getEvents:function(){var t={viewreset:this._reset};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},_initImage:function(){var t=this._image=L.DomUtil.create("img","leaflet-image-layer "+(this._zoomAnimated?"leaflet-zoom-animated":""));t.onselectstart=L.Util.falseFn,t.onmousemove=L.Util.falseFn,t.onload=L.bind(this.fire,this,"load"),t.src=this._url},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._bounds.getNorthWest(),t.zoom,t.center),i=this._map._latLngToNewLayerPoint(this._bounds.getSouthEast(),t.zoom,t.center).subtract(e),n=e.add(i._multiplyBy((1-1/t.scale)/2));L.DomUtil.setTransform(this._image,n,t.scale)},_reset:function(){var t=this._image,e=new L.Bounds(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),i=e.getSize();L.DomUtil.setPosition(t,e.min),t.style.width=i.x+"px",t.style.height=i.y+"px"},_updateOpacity:function(){L.DomUtil.setOpacity(this._image,this.options.opacity)}}),L.imageOverlay=function(t,e,i){return new L.ImageOverlay(t,e,i)},L.Icon=L.Class.extend({initialize:function(t){L.setOptions(this,t)},createIcon:function(t){return this._createIcon("icon",t)},createShadow:function(t){return this._createIcon("shadow",t)},_createIcon:function(t,e){var i=this._getIconUrl(t);if(!i){if("icon"===t)throw new Error("iconUrl not set in Icon options (see the docs).");return null}var n=this._createImg(i,e&&"IMG"===e.tagName?e:null);return this._setIconStyles(n,t),n},_setIconStyles:function(t,e){var i=this.options,n=L.point(i[e+"Size"]),o=L.point("shadow"===e&&i.shadowAnchor||i.iconAnchor||n&&n.divideBy(2,!0));t.className="leaflet-marker-"+e+" "+(i.className||""),o&&(t.style.marginLeft=-o.x+"px",t.style.marginTop=-o.y+"px"),n&&(t.style.width=n.x+"px",t.style.height=n.y+"px")},_createImg:function(t,e){return e=e||document.createElement("img"),e.src=t,e},_getIconUrl:function(t){return L.Browser.retina&&this.options[t+"RetinaUrl"]||this.options[t+"Url"]}}),L.icon=function(t){return new L.Icon(t)},L.Icon.Default=L.Icon.extend({options:{iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]},_getIconUrl:function(t){var e=t+"Url";if(this.options[e])return this.options[e];var i=L.Icon.Default.imagePath;if(!i)throw new Error("Couldn't autodetect L.Icon.Default.imagePath, set it manually.");return i+"/marker-"+t+(L.Browser.retina&&"icon"===t?"-2x":"")+".png"}}),L.Icon.Default.imagePath=function(){var t,e,i,n,o=document.getElementsByTagName("script"),r=/[\/^]leaflet[\-\._]?([\w\-\._]*)\.js\??/;for(t=0,e=o.length;e>t;t++)if(i=o[t].src,i.match(r))return n=i.split(r)[0],(n?n+"/":"")+"images"}(),L.Marker=L.Layer.extend({options:{pane:"markerPane",icon:new L.Icon.Default,clickable:!0,keyboard:!0,zIndexOffset:0,opacity:1,riseOffset:250},initialize:function(t,e){L.setOptions(this,e),this._latlng=L.latLng(t)},onAdd:function(t){this._zoomAnimated=this._zoomAnimated&&t.options.markerZoomAnimation,this._initIcon(),this.update()},onRemove:function(){this.dragging&&this.dragging.disable(),this._removeIcon(),this._removeShadow()},getEvents:function(){var t={viewreset:this.update};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},getLatLng:function(){return this._latlng},setLatLng:function(t){var e=this._latlng;return this._latlng=L.latLng(t),this.update(),this.fire("move",{oldLatLng:e,latlng:this._latlng})},setZIndexOffset:function(t){return this.options.zIndexOffset=t,this.update()},setIcon:function(t){return this.options.icon=t,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup),this},update:function(){if(this._icon){var t=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(t)}return this},_initIcon:function(){var t=this.options,e="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),i=t.icon.createIcon(this._icon),n=!1;i!==this._icon&&(this._icon&&this._removeIcon(),n=!0,t.title&&(i.title=t.title),t.alt&&(i.alt=t.alt)),L.DomUtil.addClass(i,e),t.keyboard&&(i.tabIndex="0"),this._icon=i,this._initInteraction(),t.riseOnHover&&L.DomEvent.on(i,{mouseover:this._bringToFront,mouseout:this._resetZIndex},this);var o=t.icon.createShadow(this._shadow),r=!1;o!==this._shadow&&(this._removeShadow(),r=!0),o&&L.DomUtil.addClass(o,e),this._shadow=o,t.opacity<1&&this._updateOpacity(),n&&this.getPane().appendChild(this._icon),o&&r&&this.getPane("shadowPane").appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&L.DomEvent.off(this._icon,{mouseover:this._bringToFront,mouseout:this._resetZIndex},this),L.DomUtil.remove(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&L.DomUtil.remove(this._shadow),this._shadow=null},_setPos:function(t){L.DomUtil.setPosition(this._icon,t),this._shadow&&L.DomUtil.setPosition(this._shadow,t),this._zIndex=t.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(t){this._icon.style.zIndex=this._zIndex+t},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center).round();this._setPos(e)},_initInteraction:function(){this.options.clickable&&(L.DomUtil.addClass(this._icon,"leaflet-clickable"),L.DomEvent.on(this._icon,"click dblclick mousedown mouseup mouseover mouseout contextmenu keypress",this._fireMouseEvent,this),L.Handler.MarkerDrag&&(this.dragging=new L.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable()))},_fireMouseEvent:function(t,e){return"mousedown"===t.type&&L.DomEvent.preventDefault(t),"click"===t.type&&this.dragging&&this.dragging.moved()?void L.DomEvent.stopPropagation(t):("keypress"===t.type&&13===t.keyCode&&(e="click"),void(this._map&&this._map._fireMouseEvent(this,t,e,!0,this._latlng)))},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var t=this.options.opacity;L.DomUtil.setOpacity(this._icon,t),this._shadow&&L.DomUtil.setOpacity(this._shadow,t)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)}}),L.marker=function(t,e){return new L.Marker(t,e)},L.DivIcon=L.Icon.extend({options:{iconSize:[12,12],className:"leaflet-div-icon",html:!1},createIcon:function(t){var e=t&&"DIV"===t.tagName?t:document.createElement("div"),i=this.options;return e.innerHTML=i.html!==!1?i.html:"",i.bgPos&&(e.style.backgroundPosition=-i.bgPos.x+"px "+-i.bgPos.y+"px"),this._setIconStyles(e,"icon"),e},createShadow:function(){return null}}),L.divIcon=function(t){return new L.DivIcon(t)},L.Map.mergeOptions({closePopupOnClick:!0}),L.Popup=L.Layer.extend({options:{pane:"popupPane",minWidth:50,maxWidth:300,offset:[0,7],autoPan:!0,autoPanPadding:[5,5],closeButton:!0,zoomAnimation:!0},initialize:function(t,e){L.setOptions(this,t),this._source=e},onAdd:function(t){this._zoomAnimated=this._zoomAnimated&&this.options.zoomAnimation,this._container||this._initLayout(),t._fadeAnimated&&L.DomUtil.setOpacity(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),t._fadeAnimated&&L.DomUtil.setOpacity(this._container,1),t.fire("popupopen",{popup:this}),this._source&&this._source.fire("popupopen",{popup:this},!0)},openOn:function(t){return t.openPopup(this),this},onRemove:function(t){t._fadeAnimated?(L.DomUtil.setOpacity(this._container,0),this._removeTimeout=setTimeout(L.bind(L.DomUtil.remove,L.DomUtil,this._container),200)):L.DomUtil.remove(this._container),t.fire("popupclose",{popup:this}),this._source&&this._source.fire("popupclose",{popup:this},!0)},getLatLng:function(){return this._latlng},setLatLng:function(t){return this._latlng=L.latLng(t),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(t){return this._content=t,this.update(),this},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var t={viewreset:this._updatePosition},e=this.options;return this._zoomAnimated&&(t.zoomanim=this._animateZoom),("closeOnClick"in e?e.closeOnClick:this._map.options.closePopupOnClick)&&(t.preclick=this._close),e.keepInView&&(t.moveend=this._adjustPan),t},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},_close:function(){this._map&&this._map.closePopup(this)},_initLayout:function(){var t="leaflet-popup",e=this._container=L.DomUtil.create("div",t+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"));if(this.options.closeButton){var i=this._closeButton=L.DomUtil.create("a",t+"-close-button",e);i.href="#close",i.innerHTML="&#215;",L.DomEvent.on(i,"click",this._onCloseButtonClick,this)}var n=this._wrapper=L.DomUtil.create("div",t+"-content-wrapper",e);this._contentNode=L.DomUtil.create("div",t+"-content",n),L.DomEvent.disableClickPropagation(n).disableScrollPropagation(this._contentNode).on(n,"contextmenu",L.DomEvent.stopPropagation),this._tipContainer=L.DomUtil.create("div",t+"-tip-container",e),this._tip=L.DomUtil.create("div",t+"-tip",this._tipContainer)},_updateContent:function(){if(this._content){var t=this._contentNode;if("string"==typeof this._content)t.innerHTML=this._content;else{for(;t.hasChildNodes();)t.removeChild(t.firstChild);t.appendChild(this._content)}this.fire("contentupdate")}},_updateLayout:function(){var t=this._contentNode,e=t.style;e.width="",e.whiteSpace="nowrap";var i=t.offsetWidth;i=Math.min(i,this.options.maxWidth),i=Math.max(i,this.options.minWidth),e.width=i+1+"px",e.whiteSpace="",e.height="";var n=t.offsetHeight,o=this.options.maxHeight,r="leaflet-popup-scrolled";o&&n>o?(e.height=o+"px",L.DomUtil.addClass(t,r)):L.DomUtil.removeClass(t,r),this._containerWidth=this._container.offsetWidth},_updatePosition:function(){if(this._map){var t=this._map.latLngToLayerPoint(this._latlng),e=L.point(this.options.offset);this._zoomAnimated?L.DomUtil.setPosition(this._container,t):e=e.add(t);var i=this._containerBottom=-e.y,n=this._containerLeft=-Math.round(this._containerWidth/2)+e.x;this._container.style.bottom=i+"px",this._container.style.left=n+"px"}},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center);L.DomUtil.setPosition(this._container,e)},_adjustPan:function(){if(this.options.autoPan){var t=this._map,e=this._container.offsetHeight,i=this._containerWidth,n=new L.Point(this._containerLeft,-e-this._containerBottom);this._zoomAnimated&&n._add(L.DomUtil.getPosition(this._container));var o=t.layerPointToContainerPoint(n),r=L.point(this.options.autoPanPadding),s=L.point(this.options.autoPanPaddingTopLeft||r),a=L.point(this.options.autoPanPaddingBottomRight||r),l=t.getSize(),c=0,u=0;o.x+i+a.x>l.x&&(c=o.x+i-l.x+a.x),o.x-c-s.x<0&&(c=o.x-s.x),o.y+e+a.y>l.y&&(u=o.y+e-l.y+a.y),o.y-u-s.y<0&&(u=o.y-s.y),(c||u)&&t.fire("autopanstart").panBy([c,u])}},_onCloseButtonClick:function(t){this._close(),L.DomEvent.stop(t)}}),L.popup=function(t,e){return new L.Popup(t,e)},L.Map.include({openPopup:function(t,e,i){if(!(t instanceof L.Popup)){var n=t;t=new L.Popup(i).setContent(n)}return e&&t.setLatLng(e),this.hasLayer(t)?this:(this.closePopup(),this._popup=t,this.addLayer(t))},closePopup:function(t){return t&&t!==this._popup||(t=this._popup,this._popup=null),t&&this.removeLayer(t),this}}),L.Layer.include({bindPopup:function(t,e){return t instanceof L.Popup?(this._popup=t,t._source=this):((!this._popup||e)&&(this._popup=new L.Popup(e,this)),this._popup.setContent(t)),this._popupHandlersAdded||(this.on({click:this._openPopup,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.on({click:this._openPopup,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(t){return this._popup&&this._map&&this._map.openPopup(this._popup,t||this._latlng||this.getCenter()),this},closePopup:function(){return this._popup&&this._popup._close(),this},togglePopup:function(){return this._popup&&(this._popup._map?this.closePopup():this.openPopup()),this},setPopupContent:function(t){return this._popup&&this._popup.setContent(t),this},getPopup:function(){return this._popup},_openPopup:function(t){this._map.openPopup(this._popup,t.latlng)},_movePopup:function(t){this._popup.setLatLng(t.latlng)}}),L.Marker.include({bindPopup:function(t,e){var i=L.point(this.options.icon.options.popupAnchor||[0,0]).add(L.Popup.prototype.options.offset);return e=L.extend({offset:i},e),L.Layer.prototype.bindPopup.call(this,t,e)},_openPopup:L.Layer.prototype.togglePopup}),L.LayerGroup=L.Layer.extend({initialize:function(t){this._layers={};var e,i;if(t)for(e=0,i=t.length;i>e;e++)this.addLayer(t[e])},addLayer:function(t){var e=this.getLayerId(t);return this._layers[e]=t,this._map&&this._map.addLayer(t),this},removeLayer:function(t){var e=t in this._layers?t:this.getLayerId(t);return this._map&&this._layers[e]&&this._map.removeLayer(this._layers[e]),delete this._layers[e],this},hasLayer:function(t){return!!t&&(t in this._layers||this.getLayerId(t)in this._layers)},clearLayers:function(){for(var t in this._layers)this.removeLayer(this._layers[t]);return this},invoke:function(t){var e,i,n=Array.prototype.slice.call(arguments,1);for(e in this._layers)i=this._layers[e],i[t]&&i[t].apply(i,n);return this},onAdd:function(t){for(var e in this._layers)t.addLayer(this._layers[e])},onRemove:function(t){for(var e in this._layers)t.removeLayer(this._layers[e])},eachLayer:function(t,e){for(var i in this._layers)t.call(e,this._layers[i]);return this},getLayer:function(t){return this._layers[t]},getLayers:function(){var t=[];for(var e in this._layers)t.push(this._layers[e]);return t},setZIndex:function(t){return this.invoke("setZIndex",t)},getLayerId:function(t){return L.stamp(t)}}),L.layerGroup=function(t){return new L.LayerGroup(t)},L.FeatureGroup=L.LayerGroup.extend({addLayer:function(t){return this.hasLayer(t)?this:(t.addEventParent(this),L.LayerGroup.prototype.addLayer.call(this,t),this._popupContent&&t.bindPopup&&t.bindPopup(this._popupContent,this._popupOptions),this.fire("layeradd",{layer:t}))},removeLayer:function(t){return this.hasLayer(t)?(t in this._layers&&(t=this._layers[t]),t.removeEventParent(this),L.LayerGroup.prototype.removeLayer.call(this,t),this._popupContent&&this.invoke("unbindPopup"),this.fire("layerremove",{layer:t})):this},bindPopup:function(t,e){return this._popupContent=t,this._popupOptions=e,this.invoke("bindPopup",t,e)},openPopup:function(t){for(var e in this._layers){this._layers[e].openPopup(t);break}return this},setStyle:function(t){return this.invoke("setStyle",t)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var t=new L.LatLngBounds;return this.eachLayer(function(e){t.extend(e.getBounds?e.getBounds():e.getLatLng())}),t}}),L.featureGroup=function(t){return new L.FeatureGroup(t)},L.Renderer=L.Layer.extend({options:{padding:0},initialize:function(t){L.setOptions(this,t),L.stamp(this)},onAdd:function(){this._container||(this._initContainer(),this._zoomAnimated&&L.DomUtil.addClass(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update()},onRemove:function(){L.DomUtil.remove(this._container)},getEvents:function(){var t={moveend:this._update};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},_animateZoom:function(t){var e=t.origin.subtract(this._map._getCenterLayerPoint()),i=this._bounds.min.add(e.multiplyBy(1-t.scale));L.DomUtil.setTransform(this._container,i,t.scale)},_update:function(){var t=this.options.padding,e=this._map.getSize(),i=this._map.containerPointToLayerPoint(e.multiplyBy(-t)).round();this._bounds=new L.Bounds(i,i.add(e.multiplyBy(1+2*t)).round())}}),L.Map.include({getRenderer:function(t){var e=t.options.renderer||this.options.renderer||this._renderer;return e||(e=this._renderer=L.SVG&&L.svg()||L.Canvas&&L.canvas()),this.hasLayer(e)||this.addLayer(e),e}}),L.Path=L.Layer.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",fillOpacity:.2,clickable:!0},onAdd:function(){this._renderer=this._map.getRenderer(this),this._renderer._initPath(this),this._project(),this._update(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},getEvents:function(){return{viewreset:this._project,moveend:this._update}},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(t){return L.setOptions(this,t),this._renderer&&this._renderer._updateStyle(this),this},bringToFront:function(){return this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer._bringToBack(this),this},_fireMouseEvent:function(t,e){this._map._fireMouseEvent(this,t,e,!0)},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(L.Browser.touch?10:0)}}),L.LineUtil={simplify:function(t,e){if(!e||!t.length)return t.slice();var i=e*e;return t=this._reducePoints(t,i),t=this._simplifyDP(t,i)},pointToSegmentDistance:function(t,e,i){return Math.sqrt(this._sqClosestPointOnSegment(t,e,i,!0))},closestPointOnSegment:function(t,e,i){return this._sqClosestPointOnSegment(t,e,i)},_simplifyDP:function(t,e){var i=t.length,n=typeof Uint8Array!=undefined+""?Uint8Array:Array,o=new n(i);o[0]=o[i-1]=1,this._simplifyDPStep(t,o,e,0,i-1);var r,s=[];for(r=0;i>r;r++)o[r]&&s.push(t[r]);return s},_simplifyDPStep:function(t,e,i,n,o){var r,s,a,l=0;for(s=n+1;o-1>=s;s++)a=this._sqClosestPointOnSegment(t[s],t[n],t[o],!0),a>l&&(r=s,l=a);l>i&&(e[r]=1,this._simplifyDPStep(t,e,i,n,r),this._simplifyDPStep(t,e,i,r,o))},_reducePoints:function(t,e){for(var i=[t[0]],n=1,o=0,r=t.length;r>n;n++)this._sqDist(t[n],t[o])>e&&(i.push(t[n]),o=n);return r-1>o&&i.push(t[r-1]),i},clipSegment:function(t,e,i,n){var o,r,s,a=n?this._lastCode:this._getBitCode(t,i),l=this._getBitCode(e,i);for(this._lastCode=l;;){if(!(a|l))return[t,e];if(a&l)return!1;o=a||l,r=this._getEdgeIntersection(t,e,o,i),s=this._getBitCode(r,i),o===a?(t=r,a=s):(e=r,l=s)}},_getEdgeIntersection:function(t,e,i,n){var o,r,s=e.x-t.x,a=e.y-t.y,l=n.min,c=n.max;return 8&i?(o=t.x+s*(c.y-t.y)/a,r=c.y):4&i?(o=t.x+s*(l.y-t.y)/a,r=l.y):2&i?(o=c.x,r=t.y+a*(c.x-t.x)/s):1&i&&(o=l.x,r=t.y+a*(l.x-t.x)/s),new L.Point(o,r,!0)},_getBitCode:function(t,e){var i=0;return t.x<e.min.x?i|=1:t.x>e.max.x&&(i|=2),t.y<e.min.y?i|=4:t.y>e.max.y&&(i|=8),i},_sqDist:function(t,e){var i=e.x-t.x,n=e.y-t.y;return i*i+n*n},_sqClosestPointOnSegment:function(t,e,i,n){var o,r=e.x,s=e.y,a=i.x-r,l=i.y-s,c=a*a+l*l;return c>0&&(o=((t.x-r)*a+(t.y-s)*l)/c,o>1?(r=i.x,s=i.y):o>0&&(r+=a*o,s+=l*o)),a=t.x-r,l=t.y-s,n?a*a+l*l:new L.Point(r,s)}},L.Polyline=L.Path.extend({options:{smoothFactor:1},initialize:function(t,e){L.setOptions(this,e),this._setLatLngs(t)},getLatLngs:function(){return this._latlngs},setLatLngs:function(t){return this._setLatLngs(t),this.redraw()},addLatLng:function(t){return t=L.latLng(t),this._latlngs.push(t),this._bounds.extend(t),this.redraw()},spliceLatLngs:function(){var t=[].splice.apply(this._latlngs,arguments);return this._setLatLngs(this._latlngs),this.redraw(),t},closestLayerPoint:function(t){for(var e,i,n=1/0,o=null,r=L.LineUtil._sqClosestPointOnSegment,s=0,a=this._parts.length;a>s;s++)for(var l=this._parts[s],c=1,u=l.length;u>c;c++){e=l[c-1],i=l[c];var h=r(t,e,i,!0);n>h&&(n=h,o=r(t,e,i))}return o&&(o.distance=Math.sqrt(n)),o},getCenter:function(){var t,e,i,n,o,r,s,a=this._rings[0],l=a.length;for(t=0,e=0;l-1>t;t++)e+=a[t].distanceTo(a[t+1])/2;for(t=0,n=0;l-1>t;t++)if(o=a[t],r=a[t+1],i=o.distanceTo(r),n+=i,n>e)return s=(n-e)/i,this._map.layerPointToLatLng([r.x-s*(r.x-o.x),r.y-s*(r.y-o.y)])},getBounds:function(){return this._bounds},_setLatLngs:function(t){this._bounds=new L.LatLngBounds,this._latlngs=this._convertLatLngs(t)},_convertLatLngs:function(t){for(var e=[],i=this._flat(t),n=0,o=t.length;o>n;n++)i?(e[n]=L.latLng(t[n]),this._bounds.extend(e[n])):e[n]=this._convertLatLngs(t[n]);
return e},_flat:function(t){return!L.Util.isArray(t[0])||"object"!=typeof t[0][0]},_project:function(){this._rings=[],this._projectLatlngs(this._latlngs,this._rings);var t=this._clickTolerance(),e=new L.Point(t,-t);this._latlngs.length&&(this._pxBounds=new L.Bounds(this._map.latLngToLayerPoint(this._bounds.getSouthWest())._subtract(e),this._map.latLngToLayerPoint(this._bounds.getNorthEast())._add(e)))},_projectLatlngs:function(t,e){var i,n,o=t[0]instanceof L.LatLng,r=t.length;if(o){for(n=[],i=0;r>i;i++)n[i]=this._map.latLngToLayerPoint(t[i]);e.push(n)}else for(i=0;r>i;i++)this._projectLatlngs(t[i],e)},_clipPoints:function(){if(this.options.noClip)return void(this._parts=this._rings);this._parts=[];var t,e,i,n,o,r,s,a=this._parts,l=this._renderer._bounds;for(t=0,i=0,n=this._rings.length;n>t;t++)for(s=this._rings[t],e=0,o=s.length;o-1>e;e++)r=L.LineUtil.clipSegment(s[e],s[e+1],l,e),r&&(a[i]=a[i]||[],a[i].push(r[0]),(r[1]!==s[e+1]||e===o-2)&&(a[i].push(r[1]),i++))},_simplifyPoints:function(){for(var t=this._parts,e=this.options.smoothFactor,i=0,n=t.length;n>i;i++)t[i]=L.LineUtil.simplify(t[i],e)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)}}),L.polyline=function(t,e){return new L.Polyline(t,e)},L.PolyUtil={},L.PolyUtil.clipPolygon=function(t,e){var i,n,o,r,s,a,l,c,u,h=[1,4,2,8],d=L.LineUtil;for(n=0,l=t.length;l>n;n++)t[n]._code=d._getBitCode(t[n],e);for(r=0;4>r;r++){for(c=h[r],i=[],n=0,l=t.length,o=l-1;l>n;o=n++)s=t[n],a=t[o],s._code&c?a._code&c||(u=d._getEdgeIntersection(a,s,c,e),u._code=d._getBitCode(u,e),i.push(u)):(a._code&c&&(u=d._getEdgeIntersection(a,s,c,e),u._code=d._getBitCode(u,e),i.push(u)),i.push(s));t=i}return t},L.Polygon=L.Polyline.extend({options:{fill:!0},getCenter:function(){var t,e,i,n,o,r,s,a,l,c=this._rings[0];for(s=a=l=0,t=0,i=c.length,e=i-1;i>t;e=t++)n=c[t],o=c[e],r=n.y*o.x-o.y*n.x,a+=(n.x+o.x)*r,l+=(n.y+o.y)*r,s+=3*r;return this._map.layerPointToLatLng([a/s,l/s])},_convertLatLngs:function(t){var e=L.Polyline.prototype._convertLatLngs.call(this,t),i=e.length;return i>=2&&e[0]instanceof L.LatLng&&e[0].equals(e[i-1])&&e.pop(),e},_clipPoints:function(){if(this.options.noClip)return void(this._parts=this._rings);var t=this._renderer._bounds,e=this.options.weight,i=new L.Point(e,e);t=new L.Bounds(t.min.subtract(i),t.max.add(i)),this._parts=[];for(var n,o=0,r=this._rings.length;r>o;o++)n=L.PolyUtil.clipPolygon(this._rings[o],t),n.length&&this._parts.push(n)},_updatePath:function(){this._renderer._updatePoly(this,!0)}}),L.polygon=function(t,e){return new L.Polygon(t,e)},L.Rectangle=L.Polygon.extend({initialize:function(t,e){L.Polygon.prototype.initialize.call(this,this._boundsToLatLngs(t),e)},setBounds:function(t){this.setLatLngs(this._boundsToLatLngs(t))},_boundsToLatLngs:function(t){return t=L.latLngBounds(t),[t.getSouthWest(),t.getNorthWest(),t.getNorthEast(),t.getSouthEast()]}}),L.rectangle=function(t,e){return new L.Rectangle(t,e)},L.CircleMarker=L.Path.extend({options:{fill:!0,radius:10},initialize:function(t,e){L.setOptions(this,e),this._latlng=L.latLng(t),this._radius=this.options.radius},setLatLng:function(t){return this._latlng=L.latLng(t),this.redraw(),this.fire("move",{latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(t){return this.options.radius=this._radius=t,this.redraw()},getRadius:function(){return this._radius},setStyle:function(t){var e=t&&t.radius||this._radius;return L.Path.prototype.setStyle.call(this,t),this.setRadius(e),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var t=this._radius,e=this._radiusY||t,i=this._clickTolerance(),n=[t+i,e+i];this._pxBounds=new L.Bounds(this._point.subtract(n),this._point.add(n))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)}}),L.circleMarker=function(t,e){return new L.CircleMarker(t,e)},L.Circle=L.CircleMarker.extend({initialize:function(t,e,i){L.setOptions(this,i),this._latlng=L.latLng(t),this._mRadius=e},setRadius:function(t){return this._mRadius=t,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var t=[this._radius,this._radiusY];return new L.LatLngBounds(this._map.layerPointToLatLng(this._point.subtract(t)),this._map.layerPointToLatLng(this._point.add(t)))},setStyle:L.Path.prototype.setStyle,_project:function(){var t=this._latlng.lng,e=this._latlng.lat,i=this._map,n=i.options.crs;if(n.distance===L.CRS.Earth.distance){var o=Math.PI/180,r=this._mRadius/L.CRS.Earth.R/o,s=i.project([e+r,t]),a=i.project([e-r,t]),l=s.add(a).divideBy(2),c=i.unproject(l).lat,u=Math.acos((Math.cos(r*o)-Math.sin(e*o)*Math.sin(c*o))/(Math.cos(e*o)*Math.cos(c*o)))/o;this._point=l.subtract(i.getPixelOrigin()),this._radius=isNaN(u)?0:Math.max(Math.round(l.x-i.project([c,t-u]).x),1),this._radiusY=Math.max(Math.round(l.y-s.y),1)}else{var h=n.unproject(n.project(this._latlng).subtract([this._mRadius,0]));this._point=i.latLngToLayerPoint(this._latlng),this._radius=this._point.x-i.latLngToLayerPoint(h).x}this._updateBounds()}}),L.circle=function(t,e,i){return new L.Circle(t,e,i)},L.SVG=L.Renderer.extend({_initContainer:function(){this._container=L.SVG.create("svg"),this._paths={},this._initEvents(),this._container.setAttribute("pointer-events","none")},_update:function(){if(!this._map._animatingZoom||!this._bounds){L.Renderer.prototype._update.call(this);var t=this._bounds,e=t.getSize(),i=this._container,n=this.getPane();L.Browser.mobileWebkit&&n.removeChild(i),L.DomUtil.setPosition(i,t.min),i.setAttribute("width",e.x),i.setAttribute("height",e.y),i.setAttribute("viewBox",[t.min.x,t.min.y,e.x,e.y].join(" ")),L.Browser.mobileWebkit&&n.appendChild(i)}},_initPath:function(t){var e=t._path=L.SVG.create("path");t.options.className&&L.DomUtil.addClass(e,t.options.className),t.options.clickable&&L.DomUtil.addClass(e,"leaflet-clickable"),this._updateStyle(t)},_addPath:function(t){var e=t._path;this._container.appendChild(e),this._paths[L.stamp(e)]=t},_removePath:function(t){var e=t._path;L.DomUtil.remove(e),delete this._paths[L.stamp(e)]},_updatePath:function(t){t._project(),t._update()},_updateStyle:function(t){var e=t._path,i=t.options;e&&(i.stroke?(e.setAttribute("stroke",i.color),e.setAttribute("stroke-opacity",i.opacity),e.setAttribute("stroke-width",i.weight),e.setAttribute("stroke-linecap",i.lineCap),e.setAttribute("stroke-linejoin",i.lineJoin),i.dashArray?e.setAttribute("stroke-dasharray",i.dashArray):e.removeAttribute("stroke-dasharray"),i.dashOffset?e.setAttribute("stroke-dashoffset",i.dashOffset):e.removeAttribute("stroke-dashoffset")):e.setAttribute("stroke","none"),i.fill?(e.setAttribute("fill",i.fillColor||i.color),e.setAttribute("fill-opacity",i.fillOpacity),e.setAttribute("fill-rule","evenodd")):e.setAttribute("fill","none"),e.setAttribute("pointer-events",i.pointerEvents||(i.clickable?"visiblePainted":"none")))},_updatePoly:function(t,e){this._setPath(t,L.SVG.pointsToPath(t._parts,e))},_updateCircle:function(t){var e=t._point,i=t._radius,n=t._radiusY||i,o="a"+i+","+n+" 0 1,0 ",r=t._empty()?"M0 0":"M"+(e.x-i)+","+e.y+o+2*i+",0 "+o+2*-i+",0 ";this._setPath(t,r)},_setPath:function(t,e){t._path.setAttribute("d",e)},_bringToFront:function(t){L.DomUtil.toFront(t._path)},_bringToBack:function(t){L.DomUtil.toBack(t._path)},_initEvents:function(){L.DomEvent.on(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu",this._fireMouseEvent,this)},_fireMouseEvent:function(t){this._paths[L.stamp(t.target||t.srcElement)]&&this._paths[L.stamp(t.target||t.srcElement)]._fireMouseEvent(t)}}),L.extend(L.SVG,{create:function(t){return document.createElementNS("http://www.w3.org/2000/svg",t)},pointsToPath:function(t,e){var i,n,o,r,s,a,l="";for(i=0,o=t.length;o>i;i++){for(s=t[i],n=0,r=s.length;r>n;n++)a=s[n],l+=(n?"L":"M")+a.x+" "+a.y;l+=e?L.Browser.svg?"z":"x":""}return l||"M0 0"}}),L.Browser.svg=!(!document.createElementNS||!L.SVG.create("svg").createSVGRect),L.svg=function(t){return L.Browser.svg||L.Browser.vml?new L.SVG(t):null},L.Browser.vml=!L.Browser.svg&&function(){try{var t=document.createElement("div");t.innerHTML='<v:shape adj="1"/>';var e=t.firstChild;return e.style.behavior="url(#default#VML)",e&&"object"==typeof e.adj}catch(i){return!1}}(),L.SVG.include(L.Browser.vml?{_initContainer:function(){this._container=L.DomUtil.create("div","leaflet-vml-container"),this._paths={},this._initEvents()},_update:function(){this._map._animatingZoom||L.Renderer.prototype._update.call(this)},_initPath:function(t){var e=t._container=L.SVG.create("shape");L.DomUtil.addClass(e,"leaflet-vml-shape "+(this.options.className||"")),e.coordsize="1 1",t._path=L.SVG.create("path"),e.appendChild(t._path),this._updateStyle(t)},_addPath:function(t){var e=t._container;this._container.appendChild(e),this._paths[L.stamp(e)]=t},_removePath:function(t){var e=t._container;L.DomUtil.remove(e),delete this._paths[L.stamp(e)]},_updateStyle:function(t){var e=t._stroke,i=t._fill,n=t.options,o=t._container;o.stroked=!!n.stroke,o.filled=!!n.fill,n.stroke?(e||(e=t._stroke=L.SVG.create("stroke"),o.appendChild(e)),e.weight=n.weight+"px",e.color=n.color,e.opacity=n.opacity,e.dashStyle=n.dashArray?L.Util.isArray(n.dashArray)?n.dashArray.join(" "):n.dashArray.replace(/( *, *)/g," "):"",e.endcap=n.lineCap.replace("butt","flat"),e.joinstyle=n.lineJoin):e&&(o.removeChild(e),t._stroke=null),n.fill?(i||(i=t._fill=L.SVG.create("fill"),o.appendChild(i)),i.color=n.fillColor||n.color,i.opacity=n.fillOpacity):i&&(o.removeChild(i),t._fill=null)},_updateCircle:function(t){var e=t._point,i=Math.round(t._radius),n=Math.round(t._radiusY||i);this._setPath(t,t._empty()?"M0 0":"AL "+e.x+","+e.y+" "+i+","+n+" 0,23592600")},_setPath:function(t,e){t._path.v=e},_bringToFront:function(t){L.DomUtil.toFront(t._path.parentNode)},_bringToBack:function(t){L.DomUtil.toBack(t._path.parentNode)}}:{}),L.Browser.vml&&(L.SVG.create=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(t){return document.createElement("<lvml:"+t+' class="lvml">')}}catch(t){return function(t){return document.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}}()),L.Canvas=L.Renderer.extend({onAdd:function(){L.Renderer.prototype.onAdd.call(this),this._layers=this._layers||{},this._draw()},_initContainer:function(){var t=this._container=document.createElement("canvas");L.DomEvent.on(t,"mousemove",this._onMouseMove,this).on(t,"click dblclick mousedown mouseup contextmenu",this._onClick,this),this._ctx=t.getContext("2d")},_update:function(){if(!this._map._animatingZoom||!this._bounds){L.Renderer.prototype._update.call(this);var t=this._bounds,e=this._container,i=t.getSize(),n=L.Browser.retina?2:1;L.DomUtil.setPosition(e,t.min),e.width=n*i.x,e.height=n*i.y,e.style.width=i.x+"px",e.style.height=i.y+"px",L.Browser.retina&&this._ctx.scale(2,2),this._ctx.translate(-t.min.x,-t.min.y)}},_initPath:function(t){this._layers[L.stamp(t)]=t},_addPath:L.Util.falseFn,_removePath:function(t){t._removed=!0,this._requestRedraw(t)},_updatePath:function(t){this._redrawBounds=t._pxBounds,this._draw(!0),t._project(),t._update(),this._draw(),this._redrawBounds=null},_updateStyle:function(t){this._requestRedraw(t)},_requestRedraw:function(t){this._map&&(this._redrawBounds=this._redrawBounds||new L.Bounds,this._redrawBounds.extend(t._pxBounds.min).extend(t._pxBounds.max),this._redrawRequest=this._redrawRequest||L.Util.requestAnimFrame(this._redraw,this))},_redraw:function(){this._redrawRequest=null,this._draw(!0),this._draw(),this._redrawBounds=null},_draw:function(t){this._clear=t;var e;for(var i in this._layers)e=this._layers[i],(!this._redrawBounds||e._pxBounds.intersects(this._redrawBounds))&&e._updatePath(),t&&e._removed&&(delete e._removed,delete this._layers[i])},_updatePoly:function(t,e){var i,n,o,r,s=t._parts,a=s.length,l=this._ctx;if(a){for(l.beginPath(),i=0;a>i;i++){for(n=0,o=s[i].length;o>n;n++)r=s[i][n],l[n?"lineTo":"moveTo"](r.x,r.y);e&&l.closePath()}this._fillStroke(l,t)}},_updateCircle:function(t){if(!t._empty()){var e=t._point,i=this._ctx,n=t._radius,o=(t._radiusY||n)/n;1!==o&&(i.save(),i.scale(1,o)),i.beginPath(),i.arc(e.x,e.y/o,n,0,2*Math.PI,!1),1!==o&&i.restore(),this._fillStroke(i,t)}},_fillStroke:function(t,e){var i=this._clear,n=e.options;t.globalCompositeOperation=i?"destination-out":"source-over",n.fill&&(t.globalAlpha=i?1:n.fillOpacity,t.fillStyle=n.fillColor||n.color,t.fill("evenodd")),n.stroke&&(t.globalAlpha=i?1:n.opacity,e._prevWeight=t.lineWidth=i?e._prevWeight+1:n.weight,t.strokeStyle=n.color,t.lineCap=n.lineCap,t.lineJoin=n.lineJoin,t.stroke())},_onClick:function(t){var e=this._map.mouseEventToLayerPoint(t);for(var i in this._layers)this._layers[i]._containsPoint(e)&&this._layers[i]._fireMouseEvent(t)},_onMouseMove:function(t){if(this._map&&!this._map._animatingZoom){var e=this._map.mouseEventToLayerPoint(t);for(var i in this._layers)this._handleHover(this._layers[i],t,e)}},_handleHover:function(t,e,i){t.options.clickable&&(t._containsPoint(i)?(t._mouseInside||(L.DomUtil.addClass(this._container,"leaflet-clickable"),t._fireMouseEvent(e,"mouseover"),t._mouseInside=!0),t._fireMouseEvent(e)):t._mouseInside&&(L.DomUtil.removeClass(this._container,"leaflet-clickable"),t._fireMouseEvent(e,"mouseout"),t._mouseInside=!1))},_bringToFront:L.Util.falseFn,_bringToBack:L.Util.falseFn}),L.Browser.canvas=function(){return!!document.createElement("canvas").getContext}(),L.canvas=function(t){return L.Browser.canvas?new L.Canvas(t):null},L.Polyline.prototype._containsPoint=function(t,e){var i,n,o,r,s,a,l=this._clickTolerance();if(!this._pxBounds.contains(t))return!1;for(i=0,r=this._parts.length;r>i;i++)for(a=this._parts[i],n=0,s=a.length,o=s-1;s>n;o=n++)if((e||0!==n)&&L.LineUtil.pointToSegmentDistance(t,a[o],a[n])<=l)return!0;return!1},L.Polygon.prototype._containsPoint=function(t){var e,i,n,o,r,s,a,l,c=!1;if(!this._pxBounds.contains(t))return!1;for(o=0,a=this._parts.length;a>o;o++)for(e=this._parts[o],r=0,l=e.length,s=l-1;l>r;s=r++)i=e[r],n=e[s],i.y>t.y!=n.y>t.y&&t.x<(n.x-i.x)*(t.y-i.y)/(n.y-i.y)+i.x&&(c=!c);return c||L.Polyline.prototype._containsPoint.call(this,t,!0)},L.CircleMarker.prototype._containsPoint=function(t){return t.distanceTo(this._point)<=this._radius+this._clickTolerance()},L.GeoJSON=L.FeatureGroup.extend({initialize:function(t,e){L.setOptions(this,e),this._layers={},t&&this.addData(t)},addData:function(t){var e,i,n,o=L.Util.isArray(t)?t:t.features;if(o){for(e=0,i=o.length;i>e;e++)n=o[e],(n.geometries||n.geometry||n.features||n.coordinates)&&this.addData(n);return this}var r=this.options;if(!r.filter||r.filter(t)){var s=L.GeoJSON.geometryToLayer(t,r);return s.feature=L.GeoJSON.asFeature(t),s.defaultOptions=s.options,this.resetStyle(s),r.onEachFeature&&r.onEachFeature(t,s),this.addLayer(s)}},resetStyle:function(t){t.options=t.defaultOptions,this._setLayerStyle(t,this.options.style)},setStyle:function(t){this.eachLayer(function(e){this._setLayerStyle(e,t)},this)},_setLayerStyle:function(t,e){"function"==typeof e&&(e=e(t.feature)),t.setStyle&&t.setStyle(e)}}),L.extend(L.GeoJSON,{geometryToLayer:function(t,e){var i,n,o,r,s="Feature"===t.type?t.geometry:t,a=s.coordinates,l=[],c=e&&e.pointToLayer,u=e&&e.coordsToLatLng||this.coordsToLatLng;switch(s.type){case"Point":return i=u(a),c?c(t,i):new L.Marker(i);case"MultiPoint":for(o=0,r=a.length;r>o;o++)i=u(a[o]),l.push(c?c(t,i):new L.Marker(i));return new L.FeatureGroup(l);case"LineString":case"MultiLineString":return n=this.coordsToLatLngs(a,"LineString"===s.type?0:1,u),new L.Polyline(n,e);case"Polygon":case"MultiPolygon":return n=this.coordsToLatLngs(a,"Polygon"===s.type?1:2,u),new L.Polygon(n,e);case"GeometryCollection":for(o=0,r=s.geometries.length;r>o;o++)l.push(this.geometryToLayer({geometry:s.geometries[o],type:"Feature",properties:t.properties},e));return new L.FeatureGroup(l);default:throw new Error("Invalid GeoJSON object.")}},coordsToLatLng:function(t){return new L.LatLng(t[1],t[0],t[2])},coordsToLatLngs:function(t,e,i){for(var n,o=[],r=0,s=t.length;s>r;r++)n=e?this.coordsToLatLngs(t[r],e-1,i):(i||this.coordsToLatLng)(t[r]),o.push(n);return o},latLngToCoords:function(t){return t.alt!==undefined?[t.lng,t.lat,t.alt]:[t.lng,t.lat]},latLngsToCoords:function(t,e,i){for(var n=[],o=0,r=t.length;r>o;o++)n.push(e?L.GeoJSON.latLngsToCoords(t[o],e-1,i):L.GeoJSON.latLngToCoords(t[o]));return!e&&i&&n.push(n[0]),n},getFeature:function(t,e){return t.feature?L.extend({},t.feature,{geometry:e}):L.GeoJSON.asFeature(e)},asFeature:function(t){return"Feature"===t.type?t:{type:"Feature",properties:{},geometry:t}}});var PointToGeoJSON={toGeoJSON:function(){return L.GeoJSON.getFeature(this,{type:"Point",coordinates:L.GeoJSON.latLngToCoords(this.getLatLng())})}};L.Marker.include(PointToGeoJSON),L.Circle.include(PointToGeoJSON),L.CircleMarker.include(PointToGeoJSON),L.Polyline.prototype.toGeoJSON=function(){var t=!this._flat(this._latlngs),e=L.GeoJSON.latLngsToCoords(this._latlngs,t?1:0);return L.GeoJSON.getFeature(this,{type:(t?"Multi":"")+"LineString",coordinates:e})},L.Polygon.prototype.toGeoJSON=function(){var t=!this._flat(this._latlngs),e=t&&!this._flat(this._latlngs[0]),i=L.GeoJSON.latLngsToCoords(this._latlngs,e?2:t?1:0,!0);return t&&1===this._latlngs.length&&(e=!0,i=[i]),t||(i=[i]),L.GeoJSON.getFeature(this,{type:(e?"Multi":"")+"Polygon",coordinates:i})},L.LayerGroup.include({toMultiPoint:function(){var t=[];return this.eachLayer(function(e){t.push(e.toGeoJSON().geometry.coordinates)}),L.GeoJSON.getFeature(this,{type:"MultiPoint",coordinates:t})},toGeoJSON:function(){var t=this.feature&&this.feature.geometry&&this.feature.geometry.type;if("MultiPoint"===t)return this.toMultiPoint();var e="GeometryCollection"===t,i=[];return this.eachLayer(function(t){if(t.toGeoJSON){var n=t.toGeoJSON();i.push(e?n.geometry:L.GeoJSON.asFeature(n))}}),e?L.GeoJSON.getFeature(this,{geometries:i,type:"GeometryCollection"}):{type:"FeatureCollection",features:i}}}),L.geoJson=function(t,e){return new L.GeoJSON(t,e)};var eventsKey="_leaflet_events";L.DomEvent={on:function(t,e,i,n){if("object"==typeof e)for(var o in e)this._on(t,o,e[o],i);else{e=L.Util.splitWords(e);for(var r=0,s=e.length;s>r;r++)this._on(t,e[r],i,n)}return this},off:function(t,e,i,n){if("object"==typeof e)for(var o in e)this._off(t,o,e[o],i);else{e=L.Util.splitWords(e);for(var r=0,s=e.length;s>r;r++)this._off(t,e[r],i,n)}return this},_on:function(t,e,i,n){var o=e+L.stamp(i)+(n?"_"+L.stamp(n):"");if(t[eventsKey]&&t[eventsKey][o])return this;var r=function(e){return i.call(n||t,e||window.event)},s=r;return L.Browser.pointer&&0===e.indexOf("touch")?this.addPointerListener(t,e,r,o):(L.Browser.touch&&"dblclick"===e&&this.addDoubleTapListener&&this.addDoubleTapListener(t,r,o),"addEventListener"in t?"mousewheel"===e?(t.addEventListener("DOMMouseScroll",r,!1),t.addEventListener(e,r,!1)):"mouseenter"===e||"mouseleave"===e?(r=function(e){return e=e||window.event,L.DomEvent._checkMouse(t,e)?s(e):void 0},t.addEventListener("mouseenter"===e?"mouseover":"mouseout",r,!1)):("click"===e&&L.Browser.android&&(r=function(t){return L.DomEvent._filterClick(t,s)}),t.addEventListener(e,r,!1)):"attachEvent"in t&&t.attachEvent("on"+e,r),t[eventsKey]=t[eventsKey]||{},t[eventsKey][o]=r,this)},_off:function(t,e,i,n){var o=e+L.stamp(i)+(n?"_"+L.stamp(n):""),r=t[eventsKey]&&t[eventsKey][o];return r?(L.Browser.pointer&&0===e.indexOf("touch")?this.removePointerListener(t,e,o):L.Browser.touch&&"dblclick"===e&&this.removeDoubleTapListener?this.removeDoubleTapListener(t,o):"removeEventListener"in t?"mousewheel"===e?(t.removeEventListener("DOMMouseScroll",r,!1),t.removeEventListener(e,r,!1)):t.removeEventListener("mouseenter"===e?"mouseover":"mouseleave"===e?"mouseout":e,r,!1):"detachEvent"in t&&t.detachEvent("on"+e,r),t[eventsKey][o]=null,this):this},stopPropagation:function(t){return t.stopPropagation?t.stopPropagation():t.cancelBubble=!0,L.DomEvent._skipped(t),this},disableScrollPropagation:function(t){return L.DomEvent.on(t,"mousewheel MozMousePixelScroll",L.DomEvent.stopPropagation)},disableClickPropagation:function(t){var e=L.DomEvent.stopPropagation;return L.DomEvent.on(t,L.Draggable.START.join(" "),e),L.DomEvent.on(t,{click:L.DomEvent._fakeStop,dblclick:e})},preventDefault:function(t){return t.preventDefault?t.preventDefault():t.returnValue=!1,this},stop:function(t){return L.DomEvent.preventDefault(t).stopPropagation(t)},getMousePosition:function(t,e){if(!e)return new L.Point(t.clientX,t.clientY);var i=e.getBoundingClientRect();return new L.Point(t.clientX-i.left-e.clientLeft,t.clientY-i.top-e.clientTop)},getWheelDelta:function(t){var e=0;return t.wheelDelta&&(e=t.wheelDelta/120),t.detail&&(e=-t.detail/3),e},_skipEvents:{},_fakeStop:function(t){L.DomEvent._skipEvents[t.type]=!0},_skipped:function(t){var e=this._skipEvents[t.type];return this._skipEvents[t.type]=!1,e},_checkMouse:function(t,e){var i=e.relatedTarget;if(!i)return!0;try{for(;i&&i!==t;)i=i.parentNode}catch(n){return!1}return i!==t},_filterClick:function(t,e){var i=t.timeStamp||t.originalEvent.timeStamp,n=L.DomEvent._lastClick&&i-L.DomEvent._lastClick;return n&&n>100&&500>n||t.target._simulatedClick&&!t._simulated?void L.DomEvent.stop(t):(L.DomEvent._lastClick=i,e(t))}},L.DomEvent.addListener=L.DomEvent.on,L.DomEvent.removeListener=L.DomEvent.off,L.Draggable=L.Evented.extend({statics:{START:L.Browser.touch?["touchstart","mousedown"]:["mousedown"],END:{mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},MOVE:{mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"}},initialize:function(t,e){this._element=t,this._dragStartTarget=e||t},enable:function(){this._enabled||(L.DomEvent.on(this._dragStartTarget,L.Draggable.START.join(" "),this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(L.DomEvent.off(this._dragStartTarget,L.Draggable.START.join(" "),this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(t){if(this._moved=!1,!(t.shiftKey||1!==t.which&&1!==t.button&&!t.touches||(L.DomEvent.stopPropagation(t),L.Draggable._disabled||(L.DomUtil.disableImageDrag(),L.DomUtil.disableTextSelection(),this._moving)))){this.fire("down");var e=t.touches?t.touches[0]:t;this._startPoint=new L.Point(e.clientX,e.clientY),this._startPos=this._newPos=L.DomUtil.getPosition(this._element),L.DomEvent.on(document,L.Draggable.MOVE[t.type],this._onMove,this).on(document,L.Draggable.END[t.type],this._onUp,this)}},_onMove:function(t){if(t.touches&&t.touches.length>1)return void(this._moved=!0);var e=t.touches&&1===t.touches.length?t.touches[0]:t,i=new L.Point(e.clientX,e.clientY),n=i.subtract(this._startPoint);(n.x||n.y)&&(L.Browser.touch&&Math.abs(n.x)+Math.abs(n.y)<3||(L.DomEvent.preventDefault(t),this._moved||(this.fire("dragstart"),this._moved=!0,this._startPos=L.DomUtil.getPosition(this._element).subtract(n),L.DomUtil.addClass(document.body,"leaflet-dragging"),L.DomUtil.addClass(t.target||t.srcElement,"leaflet-drag-target")),this._newPos=this._startPos.add(n),this._moving=!0,L.Util.cancelAnimFrame(this._animRequest),this._animRequest=L.Util.requestAnimFrame(this._updatePosition,this,!0,this._dragStartTarget)))},_updatePosition:function(){this.fire("predrag"),L.DomUtil.setPosition(this._element,this._newPos),this.fire("drag")},_onUp:function(t){L.DomUtil.removeClass(document.body,"leaflet-dragging"),L.DomUtil.removeClass(t.target||t.srcElement,"leaflet-drag-target");for(var e in L.Draggable.MOVE)L.DomEvent.off(document,L.Draggable.MOVE[e],this._onMove,this).off(document,L.Draggable.END[e],this._onUp,this);L.DomUtil.enableImageDrag(),L.DomUtil.enableTextSelection(),this._moved&&this._moving&&(L.Util.cancelAnimFrame(this._animRequest),this.fire("dragend",{distance:this._newPos.distanceTo(this._startPos)})),this._moving=!1}}),L.Handler=L.Class.extend({initialize:function(t){this._map=t},enable:function(){this._enabled||(this._enabled=!0,this.addHooks())},disable:function(){this._enabled&&(this._enabled=!1,this.removeHooks())},enabled:function(){return!!this._enabled}}),L.Map.mergeOptions({dragging:!0,inertia:!L.Browser.android23,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,inertiaThreshold:L.Browser.touch?32:18,easeLinearity:.25,worldCopyJump:!1}),L.Map.Drag=L.Handler.extend({addHooks:function(){if(!this._draggable){var t=this._map;this._draggable=new L.Draggable(t._mapPane,t._container),this._draggable.on({down:this._onDown,dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),t.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDrag,this),t.on("viewreset",this._onViewReset,this),t.whenReady(this._onViewReset,this))}this._draggable.enable()},removeHooks:function(){this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},_onDown:function(){this._map._panAnim&&this._map._panAnim.stop()},_onDragStart:function(){var t=this._map;t.fire("movestart").fire("dragstart"),t.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(){if(this._map.options.inertia){var t=this._lastTime=+new Date,e=this._lastPos=this._draggable._newPos;this._positions.push(e),this._times.push(t),t-this._times[0]>200&&(this._positions.shift(),this._times.shift())}this._map.fire("move").fire("drag")},_onViewReset:function(){var t=this._map.getSize().divideBy(2),e=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=e.subtract(t).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_onPreDrag:function(){var t=this._worldWidth,e=Math.round(t/2),i=this._initialWorldOffset,n=this._draggable._newPos.x,o=(n-e+i)%t+e-i,r=(n+e+i)%t-e-i,s=Math.abs(o+i)<Math.abs(r+i)?o:r;this._draggable._newPos.x=s},_onDragEnd:function(t){var e=this._map,i=e.options,n=+new Date-this._lastTime,o=!i.inertia||n>i.inertiaThreshold||!this._positions[0];if(e.fire("dragend",t),o)e.fire("moveend");else{var r=this._lastPos.subtract(this._positions[0]),s=(this._lastTime+n-this._times[0])/1e3,a=i.easeLinearity,l=r.multiplyBy(a/s),c=l.distanceTo([0,0]),u=Math.min(i.inertiaMaxSpeed,c),h=l.multiplyBy(u/c),d=u/(i.inertiaDeceleration*a),p=h.multiplyBy(-d/2).round();p.x&&p.y?(p=e._limitOffset(p,e.options.maxBounds),L.Util.requestAnimFrame(function(){e.panBy(p,{duration:d,easeLinearity:a,noMoveStart:!0})})):e.fire("moveend")}}}),L.Map.addInitHook("addHandler","dragging",L.Map.Drag),L.Map.mergeOptions({doubleClickZoom:!0}),L.Map.DoubleClickZoom=L.Handler.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(t){var e=this._map,i=e.getZoom()+(t.originalEvent.shiftKey?-1:1);"center"===e.options.doubleClickZoom?e.setZoom(i):e.setZoomAround(t.containerPoint,i)}}),L.Map.addInitHook("addHandler","doubleClickZoom",L.Map.DoubleClickZoom),L.Map.mergeOptions({scrollWheelZoom:!0}),L.Map.ScrollWheelZoom=L.Handler.extend({addHooks:function(){L.DomEvent.on(this._map._container,{mousewheel:this._onWheelScroll,MozMousePixelScroll:L.DomEvent.preventDefault},this),this._delta=0},removeHooks:function(){L.DomEvent.off(this._map._container,{mousewheel:this._onWheelScroll,MozMousePixelScroll:L.DomEvent.preventDefault},this)},_onWheelScroll:function(t){var e=L.DomEvent.getWheelDelta(t);this._delta+=e,this._lastMousePos=this._map.mouseEventToContainerPoint(t),this._startTime||(this._startTime=+new Date);var i=Math.max(40-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(L.bind(this._performZoom,this),i),L.DomEvent.stop(t)},_performZoom:function(){var t=this._map,e=this._delta,i=t.getZoom();e=e>0?Math.ceil(e):Math.floor(e),e=Math.max(Math.min(e,4),-4),e=t._limitZoom(i+e)-i,this._delta=0,this._startTime=null,e&&("center"===t.options.scrollWheelZoom?t.setZoom(i+e):t.setZoomAround(this._lastMousePos,i+e))}}),L.Map.addInitHook("addHandler","scrollWheelZoom",L.Map.ScrollWheelZoom),L.PosAnimation=L.Evented.extend({run:function(t,e,i,n){this.stop(),this._el=t,this._inProgress=!0,this._newPos=e,this.fire("start"),t.style[L.DomUtil.TRANSITION]="all "+(i||.25)+"s cubic-bezier(0,0,"+(n||.5)+",1)",L.DomEvent.on(t,L.DomUtil.TRANSITION_END,this._onTransitionEnd,this),L.DomUtil.setPosition(t,e),L.Util.falseFn(t.offsetWidth),this._stepTimer=setInterval(L.bind(this._onStep,this),50)},stop:function(){this._inProgress&&(this._newPos=this._getPos(),L.DomUtil.setPosition(this._el,this._newPos),this._onTransitionEnd(),L.Util.falseFn(this._el.offsetWidth))},_onStep:function(){var t=this._getPos();return t?(this._el._leaflet_pos=t,void this.fire("step")):void this._onTransitionEnd()},_transformRe:/([-+]?(?:\d*\.)?\d+)\D*, ([-+]?(?:\d*\.)?\d+)\D*\)/,_getPos:function(){var t,e,i,n=this._el,o=window.getComputedStyle(n);if(L.Browser.any3d){if(i=o[L.DomUtil.TRANSFORM].match(this._transformRe),!i)return;t=parseFloat(i[1]),e=parseFloat(i[2])}else t=parseFloat(o.left),e=parseFloat(o.top);return new L.Point(t,e,!0)},_onTransitionEnd:function(){L.DomEvent.off(this._el,L.DomUtil.TRANSITION_END,this._onTransitionEnd,this),this._inProgress&&(this._inProgress=!1,this._el.style[L.DomUtil.TRANSITION]="",this._el._leaflet_pos=this._newPos,clearInterval(this._stepTimer),this.fire("step").fire("end"))}}),L.Map.include({setView:function(t,e,i){if(e=e===undefined?this._zoom:this._limitZoom(e),t=this._limitCenter(L.latLng(t),e,this.options.maxBounds),i=i||{},this._panAnim&&this._panAnim.stop(),this._loaded&&!i.reset&&i!==!0){i.animate!==undefined&&(i.zoom=L.extend({animate:i.animate},i.zoom),i.pan=L.extend({animate:i.animate},i.pan));var n=this._zoom!==e?this._tryAnimatedZoom&&this._tryAnimatedZoom(t,e,i.zoom):this._tryAnimatedPan(t,i.pan);if(n)return clearTimeout(this._sizeTimer),this}return this._resetView(t,e),this},panBy:function(t,e){if(t=L.point(t).round(),e=e||{},!t.x&&!t.y)return this;if(this._panAnim||(this._panAnim=new L.PosAnimation,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),e.noMoveStart||this.fire("movestart"),e.animate!==!1){L.DomUtil.addClass(this._mapPane,"leaflet-pan-anim");var i=this._getMapPanePos().subtract(t);this._panAnim.run(this._mapPane,i,e.duration||.25,e.easeLinearity)}else this._rawPanBy(t),this.fire("move").fire("moveend");return this},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){L.DomUtil.removeClass(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(t,e){var i=this._getCenterOffset(t)._floor();return(e&&e.animate)===!0||this.getSize().contains(i)?(this.panBy(i,e),!0):!1}}),L.Map.mergeOptions({zoomAnimation:!0,zoomAnimationThreshold:4});var zoomAnimated=L.DomUtil.TRANSITION&&L.Browser.any3d&&!L.Browser.mobileOpera;zoomAnimated&&L.Map.addInitHook(function(){this._zoomAnimated=this.options.zoomAnimation,this._zoomAnimated&&L.DomEvent.on(this._mapPane,L.DomUtil.TRANSITION_END,this._catchTransitionEnd,this)}),L.Map.include(zoomAnimated?{_catchTransitionEnd:function(t){this._animatingZoom&&t.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(t,e,i){if(this._animatingZoom)return!0;if(i=i||{},!this._zoomAnimated||i.animate===!1||this._nothingToAnimate()||Math.abs(e-this._zoom)>this.options.zoomAnimationThreshold)return!1;var n=this.getZoomScale(e),o=this._getCenterOffset(t)._divideBy(1-1/n);return i.animate===!0||this.getSize().contains(o)?(L.Util.requestAnimFrame(function(){this.fire("movestart").fire("zoomstart")._animateZoom(t,e,!0)},this),!0):!1},_animateZoom:function(t,e,i){i&&(this._animatingZoom=!0,this._animateToCenter=t,this._animateToZoom=e,L.Draggable&&(L.Draggable._disabled=!0),L.DomUtil.addClass(this._mapPane,"leaflet-zoom-anim"));var n=this.getZoomScale(e),o=this._getCenterLayerPoint().add(this._getCenterOffset(t)._divideBy(1-1/n));
this.fire("zoomanim",{center:t,zoom:e,origin:o,scale:n})},_onZoomTransitionEnd:function(){this._animatingZoom=!1,L.DomUtil.removeClass(this._mapPane,"leaflet-zoom-anim"),this._resetView(this._animateToCenter,this._animateToZoom,!0,!0),L.Draggable&&(L.Draggable._disabled=!1)}}:{}),L.extend(L.DomEvent,{_touchstart:L.Browser.msPointer?"MSPointerDown":L.Browser.pointer?"pointerdown":"touchstart",_touchend:L.Browser.msPointer?"MSPointerUp":L.Browser.pointer?"pointerup":"touchend",addDoubleTapListener:function(t,e,i){function n(t){var e;if(L.Browser.pointer?(c.push(t.pointerId),e=c.length):e=t.touches.length,!(e>1)){var i=Date.now(),n=i-(r||i);s=t.touches?t.touches[0]:t,a=n>0&&l>=n,r=i}}function o(t){if(L.Browser.pointer){var i=c.indexOf(t.pointerId);if(-1===i)return;c.splice(i,1)}if(a){if(L.Browser.pointer){var n,o,l={};for(o in s)n=s[o],l[o]=n&&n.bind?n.bind(s):n;s=l}s.type="dblclick",e(s),r=null}}var r,s,a=!1,l=250,c=[],u="_leaflet_",h=this._touchstart,d=this._touchend;t[u+h+i]=n,t[u+d+i]=o;var p=L.Browser.pointer?document.documentElement:t;return t.addEventListener(h,n,!1),p.addEventListener(d,o,!1),L.Browser.pointer&&p.addEventListener(L.DomEvent.POINTER_CANCEL,o,!1),this},removeDoubleTapListener:function(t,e){var i="_leaflet_",n=L.Browser.pointer?document.documentElement:t,o=t[i+this._touchend+e];return t.removeEventListener(this._touchstart,t[i+this._touchstart+e],!1),n.removeEventListener(this._touchend,o,!1),L.Browser.pointer&&n.removeEventListener(L.DomEvent.POINTER_CANCEL,o,!1),this}}),L.extend(L.DomEvent,{POINTER_DOWN:L.Browser.msPointer?"MSPointerDown":"pointerdown",POINTER_MOVE:L.Browser.msPointer?"MSPointerMove":"pointermove",POINTER_UP:L.Browser.msPointer?"MSPointerUp":"pointerup",POINTER_CANCEL:L.Browser.msPointer?"MSPointerCancel":"pointercancel",_pointers:{},addPointerListener:function(t,e,i,n){return"touchstart"===e?this._addPointerStart(t,i,n):"touchmove"===e?this._addPointerMove(t,i,n):"touchend"===e&&this._addPointerEnd(t,i,n),this},removePointerListener:function(t,e,i){var n=t["_leaflet_"+e+i];return"touchstart"===e?t.removeEventListener(this.POINTER_DOWN,n,!1):"touchmove"===e?t.removeEventListener(this.POINTER_MOVE,n,!1):"touchend"===e&&(t.removeEventListener(this.POINTER_UP,n,!1),t.removeEventListener(this.POINTER_CANCEL,n,!1)),this},_addPointerStart:function(t,e,i){var n=L.bind(function(t){L.DomEvent.preventDefault(t),this._pointers[t.pointerId]=t,this._handlePointer(t,e)},this);if(t["_leaflet_touchstart"+i]=n,t.addEventListener(this.POINTER_DOWN,n,!1),!this._pointerDocListener){var o=L.bind(function(t){delete this._pointers[t.pointerId]},this);document.documentElement.addEventListener(this.POINTER_UP,o,!1),document.documentElement.addEventListener(this.POINTER_CANCEL,o,!1),this._pointerDocListener=!0}},_handlePointer:function(t,e){t.touches=[];for(var i in this._pointers)t.touches.push(this._pointers[i]);t.changedTouches=[t],e(t)},_addPointerMove:function(t,e,i){var n=L.bind(function(t){(t.pointerType!==t.MSPOINTER_TYPE_MOUSE&&"mouse"!==t.pointerType||0!==t.buttons)&&(this._pointers[t.pointerId]=t,this._handlePointer(t,e))},this);t["_leaflet_touchmove"+i]=n,t.addEventListener(this.POINTER_MOVE,n,!1)},_addPointerEnd:function(t,e,i){var n=L.bind(function(t){delete this._pointers[t.pointerId],this._handlePointer(t,e)},this);t["_leaflet_touchend"+i]=n,t.addEventListener(this.POINTER_UP,n,!1),t.addEventListener(this.POINTER_CANCEL,n,!1)}}),L.Map.mergeOptions({touchZoom:L.Browser.touch&&!L.Browser.android23,bounceAtZoomLimits:!0}),L.Map.TouchZoom=L.Handler.extend({addHooks:function(){L.DomEvent.on(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){L.DomEvent.off(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(t){var e=this._map;if(t.touches&&2===t.touches.length&&!e._animatingZoom&&!this._zooming){var i=e.mouseEventToLayerPoint(t.touches[0]),n=e.mouseEventToLayerPoint(t.touches[1]),o=e._getCenterLayerPoint();this._startCenter=i.add(n)._divideBy(2),this._startDist=i.distanceTo(n),this._moved=!1,this._zooming=!0,this._centerOffset=o.subtract(this._startCenter),e._panAnim&&e._panAnim.stop(),L.DomEvent.on(document,"touchmove",this._onTouchMove,this).on(document,"touchend",this._onTouchEnd,this),L.DomEvent.preventDefault(t)}},_onTouchMove:function(t){if(t.touches&&2===t.touches.length&&this._zooming){var e=this._map,i=e.mouseEventToLayerPoint(t.touches[0]),n=e.mouseEventToLayerPoint(t.touches[1]);this._scale=i.distanceTo(n)/this._startDist,this._delta=i._add(n)._divideBy(2)._subtract(this._startCenter),(e.options.bounceAtZoomLimits||!(e.getZoom()===e.getMinZoom()&&this._scale<1||e.getZoom()===e.getMaxZoom()&&this._scale>1))&&(this._moved||(e.fire("movestart").fire("zoomstart"),this._moved=!0),L.Util.cancelAnimFrame(this._animRequest),this._animRequest=L.Util.requestAnimFrame(this._updateOnMove,this,!0,this._map._container),L.DomEvent.preventDefault(t))}},_updateOnMove:function(){var t=this._map;this._center="center"===t.options.touchZoom?t.getCenter():t.layerPointToLatLng(this._getTargetCenter()),this._zoom=t.getScaleZoom(this._scale),t._animateZoom(this._center,this._zoom)},_onTouchEnd:function(){if(!this._moved||!this._zooming)return void(this._zooming=!1);this._zooming=!1,L.Util.cancelAnimFrame(this._animRequest),L.DomEvent.off(document,"touchmove",this._onTouchMove).off(document,"touchend",this._onTouchEnd);var t=this._map,e=t.getZoom(),i=this._zoom-e,n=t._limitZoom(e+(i>0?Math.ceil(i):Math.floor(i)));t._animateZoom(this._center,n,!0)},_getTargetCenter:function(){var t=this._centerOffset.subtract(this._delta).divideBy(this._scale);return this._startCenter.add(t)}}),L.Map.addInitHook("addHandler","touchZoom",L.Map.TouchZoom),L.Map.mergeOptions({tap:!0,tapTolerance:15}),L.Map.Tap=L.Handler.extend({addHooks:function(){L.DomEvent.on(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){L.DomEvent.off(this._map._container,"touchstart",this._onDown,this)},_onDown:function(t){if(t.touches){if(L.DomEvent.preventDefault(t),this._fireClick=!0,t.touches.length>1)return this._fireClick=!1,void clearTimeout(this._holdTimeout);var e=t.touches[0],i=e.target;this._startPos=this._newPos=new L.Point(e.clientX,e.clientY),i.tagName&&"a"===i.tagName.toLowerCase()&&L.DomUtil.addClass(i,"leaflet-active"),this._holdTimeout=setTimeout(L.bind(function(){this._isTapValid()&&(this._fireClick=!1,this._onUp(),this._simulateEvent("contextmenu",e))},this),1e3),this._simulateEvent("mousedown",e),L.DomEvent.on(document,{touchmove:this._onMove,touchend:this._onUp},this)}},_onUp:function(t){if(clearTimeout(this._holdTimeout),L.DomEvent.off(document,{touchmove:this._onMove,touchend:this._onUp},this),this._fireClick&&t&&t.changedTouches){var e=t.changedTouches[0],i=e.target;i&&i.tagName&&"a"===i.tagName.toLowerCase()&&L.DomUtil.removeClass(i,"leaflet-active"),this._simulateEvent("mouseup",e),this._isTapValid()&&this._simulateEvent("click",e)}},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_onMove:function(t){var e=t.touches[0];this._newPos=new L.Point(e.clientX,e.clientY)},_simulateEvent:function(t,e){var i=document.createEvent("MouseEvents");i._simulated=!0,e.target._simulatedClick=!0,i.initMouseEvent(t,!0,!0,window,1,e.screenX,e.screenY,e.clientX,e.clientY,!1,!1,!1,!1,0,null),e.target.dispatchEvent(i)}}),L.Browser.touch&&!L.Browser.pointer&&L.Map.addInitHook("addHandler","tap",L.Map.Tap),L.Map.mergeOptions({boxZoom:!0}),L.Map.BoxZoom=L.Handler.extend({initialize:function(t){this._map=t,this._container=t._container,this._pane=t._panes.overlayPane},addHooks:function(){L.DomEvent.on(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){L.DomEvent.off(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_onMouseDown:function(t){return this._moved=!1,!t.shiftKey||1!==t.which&&1!==t.button?!1:(L.DomUtil.disableTextSelection(),L.DomUtil.disableImageDrag(),this._startPoint=this._map.mouseEventToContainerPoint(t),void L.DomEvent.on(document,{mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this))},_onMouseMove:function(t){this._moved||(this._moved=!0,this._box=L.DomUtil.create("div","leaflet-zoom-box",this._container),L.DomUtil.addClass(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(t);var e=new L.Bounds(this._point,this._startPoint),i=e.getSize();L.DomUtil.setPosition(this._box,e.min),this._box.style.width=i.x+"px",this._box.style.height=i.y+"px"},_finish:function(){this._moved&&(L.DomUtil.remove(this._box),L.DomUtil.removeClass(this._container,"leaflet-crosshair")),L.DomUtil.enableTextSelection(),L.DomUtil.enableImageDrag(),L.DomEvent.off(document,{mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(){if(this._finish(),this._moved){var t=new L.LatLngBounds(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(t).fire("boxzoomend",{boxZoomBounds:t})}},_onKeyDown:function(t){27===t.keyCode&&this._finish()}}),L.Map.addInitHook("addHandler","boxZoom",L.Map.BoxZoom),L.Map.mergeOptions({keyboard:!0,keyboardPanOffset:80,keyboardZoomOffset:1}),L.Map.Keyboard=L.Handler.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,173]},initialize:function(t){this._map=t,this._setPanOffset(t.options.keyboardPanOffset),this._setZoomOffset(t.options.keyboardZoomOffset)},addHooks:function(){var t=this._map._container;-1===t.tabIndex&&(t.tabIndex="0"),L.DomEvent.on(t,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),L.DomEvent.off(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var t=document.body,e=document.documentElement,i=t.scrollTop||e.scrollTop,n=t.scrollLeft||e.scrollLeft;this._map._container.focus(),window.scrollTo(n,i)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanOffset:function(t){var e,i,n=this._panKeys={},o=this.keyCodes;for(e=0,i=o.left.length;i>e;e++)n[o.left[e]]=[-1*t,0];for(e=0,i=o.right.length;i>e;e++)n[o.right[e]]=[t,0];for(e=0,i=o.down.length;i>e;e++)n[o.down[e]]=[0,t];for(e=0,i=o.up.length;i>e;e++)n[o.up[e]]=[0,-1*t]},_setZoomOffset:function(t){var e,i,n=this._zoomKeys={},o=this.keyCodes;for(e=0,i=o.zoomIn.length;i>e;e++)n[o.zoomIn[e]]=t;for(e=0,i=o.zoomOut.length;i>e;e++)n[o.zoomOut[e]]=-t},_addHooks:function(){L.DomEvent.on(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){L.DomEvent.off(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(t){if(!(t.altKey||t.ctrlKey||t.metaKey)){var e=t.keyCode,i=this._map;if(e in this._panKeys){if(i._panAnim&&i._panAnim._inProgress)return;i.panBy(this._panKeys[e]),i.options.maxBounds&&i.panInsideBounds(i.options.maxBounds)}else{if(!(e in this._zoomKeys))return;i.setZoom(i.getZoom()+this._zoomKeys[e])}L.DomEvent.stop(t)}}}),L.Map.addInitHook("addHandler","keyboard",L.Map.Keyboard),L.Handler.MarkerDrag=L.Handler.extend({initialize:function(t){this._marker=t},addHooks:function(){var t=this._marker._icon;this._draggable||(this._draggable=new L.Draggable(t,t)),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),L.DomUtil.addClass(t,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),L.DomUtil.removeClass(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){this._marker.closePopup().fire("movestart").fire("dragstart")},_onDrag:function(){var t=this._marker,e=t._shadow,i=L.DomUtil.getPosition(t._icon),n=t._map.layerPointToLatLng(i);e&&L.DomUtil.setPosition(e,i),t._latlng=n,t.fire("move",{latlng:n}).fire("drag")},_onDragEnd:function(t){this._marker.fire("moveend").fire("dragend",t)}}),L.Control=L.Class.extend({options:{position:"topright"},initialize:function(t){L.setOptions(this,t)},getPosition:function(){return this.options.position},setPosition:function(t){var e=this._map;return e&&e.removeControl(this),this.options.position=t,e&&e.addControl(this),this},getContainer:function(){return this._container},addTo:function(t){this._map=t;var e=this._container=this.onAdd(t),i=this.getPosition(),n=t._controlCorners[i];return L.DomUtil.addClass(e,"leaflet-control"),-1!==i.indexOf("bottom")?n.insertBefore(e,n.firstChild):n.appendChild(e),this},remove:function(){return L.DomUtil.remove(this._container),this.onRemove&&this.onRemove(this._map),this._map=null,this},_refocusOnMap:function(){this._map&&this._map.getContainer().focus()}}),L.control=function(t){return new L.Control(t)},L.Map.include({addControl:function(t){return t.addTo(this),this},removeControl:function(t){return t.remove(),this},_initControlPos:function(){function t(t,o){var r=i+t+" "+i+o;e[t+o]=L.DomUtil.create("div",r,n)}var e=this._controlCorners={},i="leaflet-",n=this._controlContainer=L.DomUtil.create("div",i+"control-container",this._container);t("top","left"),t("top","right"),t("bottom","left"),t("bottom","right")},_clearControlPos:function(){L.DomUtil.remove(this._controlContainer)}}),L.Control.Attribution=L.Control.extend({options:{position:"bottomright",prefix:'<a href="http://leafletjs.com" title="A JS library for interactive maps">Leaflet</a>'},initialize:function(t){L.setOptions(this,t),this._attributions={}},onAdd:function(t){this._container=L.DomUtil.create("div","leaflet-control-attribution"),L.DomEvent.disableClickPropagation(this._container);for(var e in t._layers)t._layers[e].getAttribution&&this.addAttribution(t._layers[e].getAttribution());return this._update(),this._container},setPrefix:function(t){return this.options.prefix=t,this._update(),this},addAttribution:function(t){return t?(this._attributions[t]||(this._attributions[t]=0),this._attributions[t]++,this._update(),this):void 0},removeAttribution:function(t){return t?(this._attributions[t]&&(this._attributions[t]--,this._update()),this):void 0},_update:function(){if(this._map){var t=[];for(var e in this._attributions)this._attributions[e]&&t.push(e);var i=[];this.options.prefix&&i.push(this.options.prefix),t.length&&i.push(t.join(", ")),this._container.innerHTML=i.join(" | ")}}}),L.Map.mergeOptions({attributionControl:!0}),L.Map.addInitHook(function(){this.options.attributionControl&&(this.attributionControl=(new L.Control.Attribution).addTo(this))}),L.control.attribution=function(t){return new L.Control.Attribution(t)},L.Control.Zoom=L.Control.extend({options:{position:"topleft",zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"-",zoomOutTitle:"Zoom out"},onAdd:function(t){var e="leaflet-control-zoom",i=L.DomUtil.create("div",e+" leaflet-bar"),n=this.options;return this._zoomInButton=this._createButton(n.zoomInText,n.zoomInTitle,e+"-in",i,this._zoomIn),this._zoomOutButton=this._createButton(n.zoomOutText,n.zoomOutTitle,e+"-out",i,this._zoomOut),this._updateDisabled(),t.on("zoomend zoomlevelschange",this._updateDisabled,this),i},onRemove:function(t){t.off("zoomend zoomlevelschange",this._updateDisabled,this)},_zoomIn:function(t){this._map.zoomIn(t.shiftKey?3:1)},_zoomOut:function(t){this._map.zoomOut(t.shiftKey?3:1)},_createButton:function(t,e,i,n,o){var r=L.DomUtil.create("a",i,n);return r.innerHTML=t,r.href="#",r.title=e,L.DomEvent.on(r,"mousedown dblclick",L.DomEvent.stopPropagation).on(r,"click",L.DomEvent.stop).on(r,"click",o,this).on(r,"click",this._refocusOnMap,this),r},_updateDisabled:function(){var t=this._map,e="leaflet-disabled";L.DomUtil.removeClass(this._zoomInButton,e),L.DomUtil.removeClass(this._zoomOutButton,e),t._zoom===t.getMinZoom()&&L.DomUtil.addClass(this._zoomOutButton,e),t._zoom===t.getMaxZoom()&&L.DomUtil.addClass(this._zoomInButton,e)}}),L.Map.mergeOptions({zoomControl:!0}),L.Map.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new L.Control.Zoom,this.addControl(this.zoomControl))}),L.control.zoom=function(t){return new L.Control.Zoom(t)},L.Control.Scale=L.Control.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(t){var e="leaflet-control-scale",i=L.DomUtil.create("div",e),n=this.options;return this._addScales(n,e+"-line",i),t.on(n.updateWhenIdle?"moveend":"move",this._update,this),t.whenReady(this._update,this),i},onRemove:function(t){t.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(t,e,i){t.metric&&(this._mScale=L.DomUtil.create("div",e,i)),t.imperial&&(this._iScale=L.DomUtil.create("div",e,i))},_update:function(){var t=this._map,e=t.getSize().y/2,i=L.CRS.Earth.distance(t.containerPointToLatLng([0,e]),t.containerPointToLatLng([this.options.maxWidth,e]));this._updateScales(i)},_updateScales:function(t){this.options.metric&&t&&this._updateMetric(t),this.options.imperial&&t&&this._updateImperial(t)},_updateMetric:function(t){var e=this._getRoundNum(t),i=1e3>e?e+" m":e/1e3+" km";this._updateScale(this._mScale,i,e/t)},_updateImperial:function(t){var e,i,n,o=3.2808399*t;o>5280?(e=o/5280,i=this._getRoundNum(e),this._updateScale(this._iScale,i+" mi",i/e)):(n=this._getRoundNum(o),this._updateScale(this._iScale,n+" ft",n/o))},_updateScale:function(t,e,i){t.style.width=Math.round(this.options.maxWidth*i)-10+"px",t.innerHTML=e},_getRoundNum:function(t){var e=Math.pow(10,(Math.floor(t)+"").length-1),i=t/e;return i=i>=10?10:i>=5?5:i>=3?3:i>=2?2:1,e*i}}),L.control.scale=function(t){return new L.Control.Scale(t)},L.Control.Layers=L.Control.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0},initialize:function(t,e,i){L.setOptions(this,i),this._layers={},this._lastZIndex=0,this._handlingClick=!1;for(var n in t)this._addLayer(t[n],n);for(n in e)this._addLayer(e[n],n,!0)},onAdd:function(){return this._initLayout(),this._update(),this._container},addBaseLayer:function(t,e){return this._addLayer(t,e),this._update()},addOverlay:function(t,e){return this._addLayer(t,e,!0),this._update()},removeLayer:function(t){return t.off("add remove",this._onLayerChange,this),delete this._layers[L.stamp(t)],this._update()},_initLayout:function(){var t="leaflet-control-layers",e=this._container=L.DomUtil.create("div",t);e.setAttribute("aria-haspopup",!0),L.Browser.touch?L.DomEvent.on(e,"click",L.DomEvent.stopPropagation):L.DomEvent.disableClickPropagation(e).disableScrollPropagation(e);var i=this._form=L.DomUtil.create("form",t+"-list");if(this.options.collapsed){L.Browser.android||L.DomEvent.on(e,{mouseenter:this._expand,mouseleave:this._collapse},this);var n=this._layersLink=L.DomUtil.create("a",t+"-toggle",e);n.href="#",n.title="Layers",L.Browser.touch?L.DomEvent.on(n,"click",L.DomEvent.stop).on(n,"click",this._expand,this):L.DomEvent.on(n,"focus",this._expand,this),L.DomEvent.on(i,"click",function(){setTimeout(L.bind(this._onInputClick,this),0)},this),this._map.on("click",this._collapse,this)}else this._expand();this._baseLayersList=L.DomUtil.create("div",t+"-base",i),this._separator=L.DomUtil.create("div",t+"-separator",i),this._overlaysList=L.DomUtil.create("div",t+"-overlays",i),e.appendChild(i)},_addLayer:function(t,e,i){t.on("add remove",this._onLayerChange,this);var n=L.stamp(t);this._layers[n]={layer:t,name:e,overlay:i},this.options.autoZIndex&&t.setZIndex&&(this._lastZIndex++,t.setZIndex(this._lastZIndex))},_update:function(){if(this._container){this._baseLayersList.innerHTML="",this._overlaysList.innerHTML="";var t,e,i,n;for(i in this._layers)n=this._layers[i],this._addItem(n),e=e||n.overlay,t=t||!n.overlay;return this._separator.style.display=e&&t?"":"none",this}},_onLayerChange:function(t){this._handlingClick||this._update();var e=this._layers[L.stamp(t.target)].overlay,i=e?"add"===t.type?"overlayadd":"overlayremove":"add"===t.type?"baselayerchange":null;i&&this._map.fire(i,t.target)},_createRadioElement:function(t,e){var i='<input type="radio" class="leaflet-control-layers-selector" name="'+t+'"'+(e?' checked="checked"':"")+"/>",n=document.createElement("div");return n.innerHTML=i,n.firstChild},_addItem:function(t){var e,i=document.createElement("label"),n=this._map.hasLayer(t.layer);t.overlay?(e=document.createElement("input"),e.type="checkbox",e.className="leaflet-control-layers-selector",e.defaultChecked=n):e=this._createRadioElement("leaflet-base-layers",n),e.layerId=L.stamp(t.layer),L.DomEvent.on(e,"click",this._onInputClick,this);var o=document.createElement("span");o.innerHTML=" "+t.name,i.appendChild(e),i.appendChild(o);var r=t.overlay?this._overlaysList:this._baseLayersList;return r.appendChild(i),i},_onInputClick:function(){var t,e,i,n=this._form.getElementsByTagName("input");this._handlingClick=!0;for(var o=0,r=n.length;r>o;o++)t=n[o],e=this._layers[t.layerId].layer,i=this._map.hasLayer(e),t.checked&&!i?this._map.addLayer(e):!t.checked&&i&&this._map.removeLayer(e);this._handlingClick=!1,this._refocusOnMap()},_expand:function(){L.DomUtil.addClass(this._container,"leaflet-control-layers-expanded")},_collapse:function(){L.DomUtil.removeClass(this._container,"leaflet-control-layers-expanded")}}),L.control.layers=function(t,e,i){return new L.Control.Layers(t,e,i)},L.PosAnimation=L.DomUtil.TRANSITION?L.PosAnimation:L.PosAnimation.extend({run:function(t,e,i,n){this.stop(),this._el=t,this._inProgress=!0,this._duration=i||.25,this._easeOutPower=1/Math.max(n||.5,.2),this._startPos=L.DomUtil.getPosition(t),this._offset=e.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(),this._complete())},_animate:function(){this._animId=L.Util.requestAnimFrame(this._animate,this),this._step()},_step:function(){var t=+new Date-this._startTime,e=1e3*this._duration;e>t?this._runFrame(this._easeOut(t/e)):(this._runFrame(1),this._complete())},_runFrame:function(t){var e=this._startPos.add(this._offset.multiplyBy(t));L.DomUtil.setPosition(this._el,e),this.fire("step")},_complete:function(){L.Util.cancelAnimFrame(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(t){return 1-Math.pow(1-t,this._easeOutPower)}}),L.Map.include({_defaultLocateOptions:{timeout:1e4,watch:!1},locate:function(t){if(t=this._locateOptions=L.extend(this._defaultLocateOptions,t),!navigator.geolocation)return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var e=L.bind(this._handleGeolocationResponse,this),i=L.bind(this._handleGeolocationError,this);return t.watch?this._locationWatchId=navigator.geolocation.watchPosition(e,i,t):navigator.geolocation.getCurrentPosition(e,i,t),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(t){var e=t.code,i=t.message||(1===e?"permission denied":2===e?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:e,message:"Geolocation error: "+i+"."})},_handleGeolocationResponse:function(t){var e=t.coords.latitude,i=t.coords.longitude,n=new L.LatLng(e,i),o=180*t.coords.accuracy/40075017,r=o/Math.cos(Math.PI/180*e),s=L.latLngBounds([e-o,i-r],[e+o,i+r]),a=this._locateOptions;if(a.setView){var l=this.getBoundsZoom(s);this.setView(n,a.maxZoom?Math.min(l,a.maxZoom):l)}var c={latlng:n,bounds:s,timestamp:t.timestamp};for(var u in t.coords)"number"==typeof t.coords[u]&&(c[u]=t.coords[u]);this.fire("locationfound",c)}}),"object"!=typeof JSON&&(JSON={}),function(){"use strict";function f(t){return 10>t?"0"+t:t}function quote(t){return escapable.lastIndex=0,escapable.test(t)?'"'+t.replace(escapable,function(t){var e=meta[t];return"string"==typeof e?e:"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+t+'"'}function str(t,e){var i,n,o,r,s,a=gap,l=e[t];switch(l&&"object"==typeof l&&"function"==typeof l.toJSON&&(l=l.toJSON(t)),"function"==typeof rep&&(l=rep.call(e,t,l)),typeof l){case"string":return quote(l);case"number":return isFinite(l)?String(l):"null";case"boolean":case"null":return String(l);case"object":if(!l)return"null";if(gap+=indent,s=[],"[object Array]"===Object.prototype.toString.apply(l)){for(r=l.length,i=0;r>i;i+=1)s[i]=str(i,l)||"null";return o=0===s.length?"[]":gap?"[\n"+gap+s.join(",\n"+gap)+"\n"+a+"]":"["+s.join(",")+"]",gap=a,o}if(rep&&"object"==typeof rep)for(r=rep.length,i=0;r>i;i+=1)"string"==typeof rep[i]&&(n=rep[i],o=str(n,l),o&&s.push(quote(n)+(gap?": ":":")+o));else for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(o=str(n,l),o&&s.push(quote(n)+(gap?": ":":")+o));return o=0===s.length?"{}":gap?"{\n"+gap+s.join(",\n"+gap)+"\n"+a+"}":"{"+s.join(",")+"}",gap=a,o}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;"function"!=typeof JSON.stringify&&(JSON.stringify=function(t,e,i){var n;if(gap="",indent="","number"==typeof i)for(n=0;i>n;n+=1)indent+=" ";else"string"==typeof i&&(indent=i);if(rep=e,e&&"function"!=typeof e&&("object"!=typeof e||"number"!=typeof e.length))throw new Error("JSON.stringify");return str("",{"":t})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(t,e){var i,n,o=t[e];if(o&&"object"==typeof o)for(i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n=walk(o,i),n!==undefined?o[i]=n:delete o[i]);return reviver.call(t,e,o)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(t){return"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),function(t,e){function i(t,e){var i=t.createElement("p"),n=t.getElementsByTagName("head")[0]||t.documentElement;return i.innerHTML="x<style>"+e+"</style>",n.insertBefore(i.lastChild,n.firstChild)}function n(){var t=y.elements;return"string"==typeof t?t.split(" "):t}function o(t){var e=g[t[m]];return e||(e={},_++,t[m]=_,g[_]=e),e}function r(t,i,n){if(i||(i=e),u)return i.createElement(t);n||(n=o(i));var r;return r=n.cache[t]?n.cache[t].cloneNode():f.test(t)?(n.cache[t]=n.createElem(t)).cloneNode():n.createElem(t),!r.canHaveChildren||p.test(t)||r.tagUrn?r:n.frag.appendChild(r)}function s(t,i){if(t||(t=e),u)return t.createDocumentFragment();i=i||o(t);for(var r=i.frag.cloneNode(),s=0,a=n(),l=a.length;l>s;s++)r.createElement(a[s]);return r}function a(t,e){e.cache||(e.cache={},e.createElem=t.createElement,e.createFrag=t.createDocumentFragment,e.frag=e.createFrag()),t.createElement=function(i){return y.shivMethods?r(i,t,e):e.createElem(i)},t.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&("+n().join().replace(/[\w\-]+/g,function(t){return e.createElem(t),e.frag.createElement(t),'c("'+t+'")'})+");return n}")(y,e.frag)}function l(t){t||(t=e);var n=o(t);return!y.shivCSS||c||n.hasCSS||(n.hasCSS=!!i(t,"article,aside,dialog,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}mark{background:#FF0;color:#000}template{display:none}")),u||a(t,n),t}var c,u,h="3.7.0",d=t.html5||{},p=/^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i,f=/^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i,m="_html5shiv",_=0,g={};!function(){try{var t=e.createElement("a");t.innerHTML="<xyz></xyz>",c="hidden"in t,u=1==t.childNodes.length||function(){e.createElement("a");var t=e.createDocumentFragment();return"undefined"==typeof t.cloneNode||"undefined"==typeof t.createDocumentFragment||"undefined"==typeof t.createElement}()}catch(i){c=!0,u=!0}}();var y={elements:d.elements||"abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output progress section summary template time video",version:h,shivCSS:d.shivCSS!==!1,supportsUnknownElements:u,shivMethods:d.shivMethods!==!1,type:"default",shivDocument:l,createElement:r,createDocumentFragment:s};t.html5=y,l(e)}(this,document),Array.prototype.map||(Array.prototype.map=function(t){"use strict";if(void 0===this||null===this)throw new TypeError;var e=Object(this),i=e.length>>>0;if("function"!=typeof t)throw new TypeError;for(var n=new Array(i),o=arguments.length>=2?arguments[1]:void 0,r=0;i>r;r++)r in e&&(n[r]=t.call(o,e[r],r,e));return n}),"function"!=typeof Array.prototype.reduce&&(Array.prototype.reduce=function(t,e){"use strict";if(null===this||"undefined"==typeof this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof t)throw new TypeError(t+" is not a function");var i,n,o=this.length>>>0,r=!1;for(1<arguments.length&&(n=e,r=!0),i=0;o>i;++i)this.hasOwnProperty(i)&&(r?n=t(n,this[i],i,this):(n=this[i],r=!0));if(!r)throw new TypeError("Reduce of empty array with no initial value");return n}),Array.prototype.forEach||(Array.prototype.forEach=function(t,e){"use strict";var i,n;if(null==this)throw new TypeError("this is null or not defined");var o,r=Object(this),s=r.length>>>0;if("[object Function]"!=={}.toString.call(t))throw new TypeError(t+" is not a function");for(arguments.length>=2&&(i=e),n=0;s>n;)n in r&&(o=r[n],t.call(i,o,n,r)),n++}),Object.keys||(Object.keys=function(){"use strict";var t=Object.prototype.hasOwnProperty,e=!{toString:null}.propertyIsEnumerable("toString"),i=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],n=i.length;return function(o){if("object"!=typeof o&&("function"!=typeof o||null===o))throw new TypeError("Object.keys called on non-object");var r,s,a=[];for(r in o)t.call(o,r)&&a.push(r);if(e)for(s=0;n>s;s++)t.call(o,i[s])&&a.push(i[s]);return a}}()),Array.prototype.some||(Array.prototype.some=function(t){"use strict";if(void 0===this||null===this)throw new TypeError;var e=Object(this),i=e.length>>>0;if("function"!=typeof t)throw new TypeError;for(var n=arguments.length>=2?arguments[1]:void 0,o=0;i>o;o++)if(o in e&&t.call(n,e[o],o,e))return!0;return!1}),Array.prototype.map||(Array.prototype.map=function(t){"use strict";if(void 0===this||null===this)throw new TypeError;var e=Object(this),i=e.length>>>0;if("function"!=typeof t)throw new TypeError;for(var n=new Array(i),o=arguments.length>=2?arguments[1]:void 0,r=0;i>r;r++)r in e&&(n[r]=t.call(o,e[r],r,e));return n}),Array.prototype.filter||(Array.prototype.filter=function(t){"use strict";if(void 0===this||null===this)throw new TypeError;var e=Object(this),i=e.length>>>0;if("function"!=typeof t)throw new TypeError;for(var n=[],o=arguments.length>=2?arguments[1]:void 0,r=0;i>r;r++)if(r in e){var s=e[r];t.call(o,s,r,e)&&n.push(s)}return n}),Function.prototype.bind||(Function.prototype.bind=function(t){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");
var e=Array.prototype.slice.call(arguments,1),i=this,n=function(){},o=function(){return i.apply(this instanceof n&&t?this:t,e.concat(Array.prototype.slice.call(arguments)))};return n.prototype=this.prototype,o.prototype=new n,o}),Array.prototype.indexOf||(Array.prototype.indexOf=function(t,e){if(this===undefined||null===this)throw new TypeError('"this" is null or not defined');var i=this.length>>>0;for(e=+e||0,1/0===Math.abs(e)&&(e=0),0>e&&(e+=i,0>e&&(e=0));i>e;e++)if(this[e]===t)return e;return-1}),"function"!=typeof Promise&&!function(){var t,e,i,n;!function(){var o={},r={};t=function(t,e,i){o[t]={deps:e,callback:i}},n=i=e=function(t){function i(e){if("."!==e.charAt(0))return e;for(var i=e.split("/"),n=t.split("/").slice(0,-1),o=0,r=i.length;r>o;o++){var s=i[o];if(".."===s)n.pop();else{if("."===s)continue;n.push(s)}}return n.join("/")}if(n._eak_seen=o,r[t])return r[t];if(r[t]={},!o[t])throw new Error("Could not find module "+t);for(var s,a=o[t],l=a.deps,c=a.callback,u=[],h=0,d=l.length;d>h;h++)u.push("exports"===l[h]?s={}:e(i(l[h])));var p=c.apply(this,u);return r[t]=s||p}}(),t("promise/all",["./utils","exports"],function(t,e){"use strict";function i(t){var e=this;if(!n(t))throw new TypeError("You must pass an array to all.");return new e(function(e,i){function n(t){return function(e){r(t,e)}}function r(t,i){a[t]=i,0===--l&&e(a)}var s,a=[],l=t.length;0===l&&e([]);for(var c=0;c<t.length;c++)s=t[c],s&&o(s.then)?s.then(n(c),i):r(c,s)})}var n=t.isArray,o=t.isFunction;e.all=i}),t("promise/asap",["exports"],function(t){"use strict";function e(){return function(){process.nextTick(o)}}function i(){var t=0,e=new l(o),i=document.createTextNode("");return e.observe(i,{characterData:!0}),function(){i.data=t=++t%2}}function n(){return function(){c.setTimeout(o,1)}}function o(){for(var t=0;t<u.length;t++){var e=u[t],i=e[0],n=e[1];i(n)}u=[]}function r(t,e){var i=u.push([t,e]);1===i&&s()}var s,a="undefined"!=typeof window?window:{},l=a.MutationObserver||a.WebKitMutationObserver,c="undefined"!=typeof global?global:this===undefined?window:this,u=[];s="undefined"!=typeof process&&"[object process]"==={}.toString.call(process)?e():l?i():n(),t.asap=r}),t("promise/config",["exports"],function(t){"use strict";function e(t,e){return 2!==arguments.length?i[t]:void(i[t]=e)}var i={instrument:!1};t.config=i,t.configure=e}),t("promise/polyfill",["./promise","./utils","exports"],function(t,e,i){"use strict";function n(){var t;t="undefined"!=typeof global?global:"undefined"!=typeof window&&window.document?window:self;var e="Promise"in t&&"resolve"in t.Promise&&"reject"in t.Promise&&"all"in t.Promise&&"race"in t.Promise&&function(){var e;return new t.Promise(function(t){e=t}),r(e)}();e||(t.Promise=o)}var o=t.Promise,r=e.isFunction;i.polyfill=n}),t("promise/promise",["./config","./utils","./all","./race","./resolve","./reject","./asap","exports"],function(t,e,i,n,o,r,s,a){"use strict";function l(t){if(!b(t))throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");if(!(this instanceof l))throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this._subscribers=[],c(t,this)}function c(t,e){function i(t){f(e,t)}function n(t){_(e,t)}try{t(i,n)}catch(o){n(o)}}function u(t,e,i,n){var o,r,s,a,l=b(i);if(l)try{o=i(n),s=!0}catch(c){a=!0,r=c}else o=n,s=!0;p(e,o)||(l&&s?f(e,o):a?_(e,r):t===E?f(e,o):t===O&&_(e,o))}function h(t,e,i,n){var o=t._subscribers,r=o.length;o[r]=e,o[r+E]=i,o[r+O]=n}function d(t,e){for(var i,n,o=t._subscribers,r=t._detail,s=0;s<o.length;s+=3)i=o[s],n=o[s+e],u(e,i,n,r);t._subscribers=null}function p(t,e){var i,n=null;try{if(t===e)throw new TypeError("A promises callback cannot return that same promise.");if(L(e)&&(n=e.then,b(n)))return n.call(e,function(n){return i?!0:(i=!0,void(e!==n?f(t,n):m(t,n)))},function(e){return i?!0:(i=!0,void _(t,e))}),!0}catch(o){return i?!0:(_(t,o),!0)}return!1}function f(t,e){t===e?m(t,e):p(t,e)||m(t,e)}function m(t,e){t._state===P&&(t._state=T,t._detail=e,v.async(g,t))}function _(t,e){t._state===P&&(t._state=T,t._detail=e,v.async(y,t))}function g(t){d(t,t._state=E)}function y(t){d(t,t._state=O)}var v=t.config,L=(t.configure,e.objectOrFunction),b=e.isFunction,w=(e.now,i.all),x=n.race,D=o.resolve,k=r.reject,C=s.asap;v.async=C;var P=void 0,T=0,E=1,O=2;l.prototype={constructor:l,_state:undefined,_detail:undefined,_subscribers:undefined,then:function(t,e){var i=this,n=new this.constructor(function(){});if(this._state){var o=arguments;v.async(function(){u(i._state,n,o[i._state-1],i._detail)})}else h(this,n,t,e);return n},"catch":function(t){return this.then(null,t)}},l.all=w,l.race=x,l.resolve=D,l.reject=k,a.Promise=l}),t("promise/race",["./utils","exports"],function(t,e){"use strict";function i(t){var e=this;if(!n(t))throw new TypeError("You must pass an array to race.");return new e(function(e,i){for(var n,o=0;o<t.length;o++)n=t[o],n&&"function"==typeof n.then?n.then(e,i):e(n)})}var n=t.isArray;e.race=i}),t("promise/reject",["exports"],function(t){"use strict";function e(t){var e=this;return new e(function(e,i){i(t)})}t.reject=e}),t("promise/resolve",["exports"],function(t){"use strict";function e(t){if(t&&"object"==typeof t&&t.constructor===this)return t;var e=this;return new e(function(e){e(t)})}t.resolve=e}),t("promise/utils",["exports"],function(t){"use strict";function e(t){return i(t)||"object"==typeof t&&null!==t}function i(t){return"function"==typeof t}function n(t){return"[object Array]"===Object.prototype.toString.call(t)}var o=Date.now||function(){return(new Date).getTime()};t.objectOrFunction=e,t.isFunction=i,t.isArray=n,t.now=o}),e("promise/polyfill").polyfill()}(),DG=new(function(){var t=function(){},e=function(){};return e.prototype=L,t.prototype=new e,t}()),window.__dgApi__=window.__dgApi__||{},DG.version=window.__dgApi__.version,DG.debug=window.__dgApi__.debug,DG.Icon.Default.imagePath="../img/vendors/leaflet",function(t,e,i,n,o,r,s){t.GoogleAnalyticsObject=o,t[o]=t[o]||function(){(t[o].q=t[o].q||[]).push(arguments)},t[o].l=1*new Date,r=e.createElement(i),s=e.getElementsByTagName(i)[0],r.async=1,r.src=n,s.parentNode.insertBefore(r,s)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-38243181-2","none"),ga("send","pageview");var newImg=new Image;newImg.src="http://maps.api.2gis.ru/analytics/track-user.png?sr="+window.screen.width+"x"+window.screen.height+"&v="+DG.version,DG.Map.include({addHandler:function(t,e){if(e){var i=this.options[t],n=i===Object(i)?i:null,o=this[t]=new e(this,n);return this._handlers.push(o),i&&o.enable(),this}}}),DG.Map.addInitHook(function(){!DG.Browser.touch&&DG.DomUtil.addClass(this._container,"no-touch")});var handlers=window.__dgApi__.callbacks||[],chain=Promise.resolve();try{delete window.__dgApi__}catch(e){window.__dgApi__=undefined}handlers.forEach(function(t){chain=chain.then(t[0],t[1])}),DG.then=function(t,e){return chain.then(t,e)},DG.plugin=function(t){var e,i=new RegExp(/.js$/i),n=new RegExp(/.css$/i),o=new Promise(function(o){function r(){e--,0===e&&o()}function s(t){var e=document.createElement("script");e.setAttribute("type","text/javascript"),e.setAttribute("src",t),e.onload=function(){r()},e.onerror=function(){r()},e.onreadystatechange=function(){("complete"===e.readyState||"loaded"===e.readyState)&&r()},document.getElementsByTagName("head")[0].appendChild(e)}function a(t){var e=document.createElement("link");e.setAttribute("rel","stylesheet"),e.setAttribute("type","text/css"),e.setAttribute("href",t),document.getElementsByTagName("head")[0].appendChild(e),r()}function l(t){return i.test(t)}function c(t){return n.test(t)}function u(t){l(t)?s(t):c(t)?a(t):e--}DG.Util.isArray(t)&&(e=t.length,t.forEach(function(t){u(t)})),"string"==typeof t&&(e=1,u(t))});return o},DG.ajax=function(){function handleReadyState(t,e,i){return function(){return t._aborted?i(t.request):void(t.request&&4===t.request[readyState]&&(t.request.onreadystatechange=noop,twoHundo.test(t.request.status)?e(t.request):i(t.request)))}}function setHeaders(t,e){var i,n=e.headers||{};n.Accept=n.Accept||defaultHeaders.accept[e.dataType]||defaultHeaders.accept["*"],e.crossDomain||n[requestedWith]||(n[requestedWith]=defaultHeaders.requestedWith),n[contentType]||(n[contentType]=e.contentType||defaultHeaders.contentType);for(i in n)n.hasOwnProperty(i)&&"setRequestHeader"in t&&t.setRequestHeader(i,n[i])}function setCredentials(t,e){"undefined"!=typeof e.withCredentials&&"undefined"!=typeof t.withCredentials&&(t.withCredentials=!!e.withCredentials)}function generalCallback(t){lastValue=t}function urlappend(t,e){return t+(/\?/.test(t)?"&":"?")+e}function handleJsonp(t,e,i,n){var o=uniqid++,r=t.jsonpCallback||"callback",s=t.jsonpCallbackName||callbackPrefix,a=new RegExp("((^|\\?|&)"+r+")=([^&]+)"),l=n.match(a),c=doc.createElement("script"),u=0,h=-1!==navigator.userAgent.indexOf("MSIE 10.0");return l?"?"===l[3]?n=n.replace(a,"$1="+s):s=l[3]:n=urlappend(n,r+"="+s),win[s]=generalCallback,c.type="text/javascript",c.src=n,c.async=!0,"undefined"==typeof c.onreadystatechange||h||(c.event="onclick",c.htmlFor=c.id="_request_"+o),c.onerror=function(){c.onerror=c.onload=c.onreadystatechange=null,i({},"Request unknown error",{}),lastValue=undefined,head.removeChild(c),u=1},c.onload=c.onreadystatechange=function(){return c[readyState]&&"complete"!==c[readyState]&&"loaded"!==c[readyState]||u?!1:(c.onerror=c.onload=c.onreadystatechange=null,c.onclick&&c.onclick(),e(lastValue),lastValue=undefined,head.removeChild(c),void(u=1))},head.appendChild(c),{abort:function(){c.onerror=c.onload=c.onreadystatechange=null,i({},"Request is aborted: timeout",{}),lastValue=undefined,head.removeChild(c),u=1}}}function getRequest(t,e){var i,n=this.options,o=(n.type||"GET").toUpperCase(),r="string"==typeof n?n:n.url,s=n.processData!==!1&&n.data&&"string"!=typeof n.data?Ajax.toQueryString(n.data):n.data||null,a=!1;return"jsonp"!==n.type&&"GET"!==o||!s||(r=urlappend(r,s),s=null),"jsonp"===n.type?handleJsonp(n,t,e,r):(i=xhr(n),i.open(o,r,n.async===!1?!1:!0),setHeaders(i,n),setCredentials(i,n),win[xDomainRequest]&&i instanceof win[xDomainRequest]?(i.onload=t,i.onerror=e,a=!0):i.onreadystatechange=handleReadyState(this,t,e),a?setTimeout(function(){i.send(s)},200):i.send(s),i)}function buildParams(t,e,i,n){var o,r,s,a=/\[\]$/;if(DG.Util.isArray(e))for(r=0;e&&r<e.length;r++)s=e[r],i||a.test(t)?n(t,s):buildParams(t+"["+("object"==typeof s?r:"")+"]",s,i,n);else if(e&&"[object Object]"===e.toString())for(o in e)e.hasOwnProperty(o)&&buildParams(t+"["+o+"]",e[o],i,n);else n(t,e)}function setType(t){var e=t.match(/\.(json|jsonp|html|xml)(\?|$)/);return e?e[1]:"js"}function isCrossDomain(t){var e=rurl.exec(t.toLowerCase());return!(!e||e[1]===ajaxLocParts[1]&&e[2]===ajaxLocParts[2]&&(e[3]||("http:"===e[1]?"80":"443"))===(ajaxLocParts[3]||("http:"===ajaxLocParts[1]?"80":"443")))}function doRequest(o){"crossDomain"in o||(o.crossDomain=isCrossDomain(o.url));var self={};return self.promise=new Promise(function(resolve,reject){function complete(t){o.timeout&&clearTimeout(self.timeout),self.timeout=null,self._erred?reject(t):resolve(t)}function success(resp){resp="jsonp"!==type?self.request:resp;var filteredResponse=globalSetupOptions.dataFilter(resp.responseText,type),r=filteredResponse;try{resp.responseText=r}catch(e){}if(r)switch(type){case"json":try{resp=win.JSON?win.JSON.parse(r):eval("("+r+")")}catch(err){return error(resp,"Could not parse JSON in response",err)}break;case"js":resp=eval("("+r+")");break;case"html":resp=r;break;case"xml":resp=resp.responseXML&&resp.responseXML.parseError&&resp.responseXML.parseError.errorCode&&resp.responseXML.parseError.reason?null:resp.responseXML}self._responseArgs.resp=resp,complete(resp)}function error(t,e,i){t=self.request,self._responseArgs.resp=t,self._responseArgs.msg=e,self._responseArgs.t=i,self._erred=!0,complete(t)}self.abort=function(){self._aborted=!0},self.abort=function(){self._aborted=!0,reject("aborted")},self.url=o.url,self.timeout=null,self.options=o,self._aborted=!1,self._erred=!1,self._responseArgs={};var type="jsonp"===o.type?o.type:o.dataType||setType(self.url);o.timeout&&(self.timeout=setTimeout(function(){self.abort()},o.timeout)),self.request=getRequest.call(self,success,error)}),self}function Ajax(t,e){"[object Object]"===Object.prototype.toString.call(t)&&(e=t,t=undefined),e=e||{},e.url=t||e.url;var i=doRequest(e),n=i.promise;return(e.success||e.error||e.complete)&&n.then(e.success,e.error),n.abort=i.abort,n}var win=window,doc=document,rurl=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,twoHundo=/^20\d$/,ajaxLocParts,ajaxLocation,byTag="getElementsByTagName",readyState="readyState",contentType="Content-Type",requestedWith="X-Requested-With",head=doc[byTag]("head")[0],uniqid=0,callbackPrefix="l_dg_ajax_callback_"+ +new Date,lastValue,xmlHttpRequest="XMLHttpRequest",xDomainRequest="XDomainRequest",noop=function(){},defaultHeaders={contentType:"application/x-www-form-urlencoded",requestedWith:xmlHttpRequest,accept:{"*":"text/javascript, text/html, application/xml, text/xml, */*",xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript",js:"application/javascript, text/javascript"}},xhr=function(t){if(t.crossDomain===!0){var e=win[xmlHttpRequest]?new XMLHttpRequest:null;if(e&&"withCredentials"in e)return e;if(win[xDomainRequest])return new XDomainRequest;throw new Error("Browser does not support cross-origin requests")}return win[xmlHttpRequest]?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")},globalSetupOptions={dataFilter:function(t){return t}};try{ajaxLocation=location.href}catch(e){ajaxLocation=document.createElement("a"),ajaxLocation.href="",ajaxLocation=ajaxLocation.href}ajaxLocParts=rurl.exec(ajaxLocation.toLowerCase())||[],Ajax.setup=function(t){t=t||{};for(var e in t)t.hasOwnProperty(e)&&(globalSetupOptions[e]=t[e])},Ajax.toQueryString=function(t,e){var i,n,o=e||!1,r=[],s=encodeURIComponent,a=function(t,e){e="function"==typeof e?e():e?e:"",r[r.length]=s(t)+"="+s(e)};if(DG.Util.isArray(t))for(n=0;t&&n<t.length;n++)a(t[n].name,t[n].value);else for(i in t)t.hasOwnProperty(i)&&buildParams(i,t[i],o,a);return r.join("&").replace(/%20/g,"+")};var testxhr=win[xmlHttpRequest]?new XMLHttpRequest:null;return Ajax.corsSupport=!!(testxhr&&"withCredentials"in testxhr||win[xDomainRequest]),Ajax}(),DG.Label=DG.Layer.extend({options:{offset:new DG.Point(12,15),className:"dg-label",zIndexOffset:0},_typeOfString:Object.prototype.toString.call("s"),_defaultZIndex:100,initialize:function(t,e){DG.Util.setOptions(this,e),this._animated=DG.Browser.any3d,this._content=t},onAdd:function(t){this._map=t,this._el||this._initDOM(),this._visible=!0,this.setContent(this._content)._onViewReset(),t.on("viewreset",this._onViewReset,this).on("zoomanim",this._onZoomAnimation,this)},onRemove:function(t){t.off("viewreset",this._onViewReset,this).off("zoomanim",this._onZoomAnimation,this),this._visible=!1,this._el.removeChild(this._container),DG.Util.falseFn(this._container.offsetWidth),this._container=null,t.getPanes().markerPane.removeChild(this._el),this._el=null},_initDOM:function(){this._el=DG.DomUtil.create("div",this.options.className+" leaflet-zoom-"+(this._animated?"animated":"hide"),this._map.getPanes().markerPane),this._el.style.zIndex=this._defaultZIndex+this.options.zIndexOffset,this._container=DG.DomUtil.create("div",this.options.className+"__content",this._el),DG.DomUtil.disableTextSelection(this._container),DG.DomEvent.disableClickPropagation(this._el).on(this._container,"mousewheel",DG.DomEvent.stopPropagation).on(this._container,"contextmenu",DG.DomEvent.stopPropagation)},_onViewReset:function(){this._visible&&this._latlng&&DG.DomUtil.setPosition(this._el,this._map.latLngToLayerPoint(this._latlng).add(this.options.offset),DG.Browser.ie)},_onZoomAnimation:function(t){this._latlng&&DG.DomUtil.setPosition(this._el,this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center).add(this.options.offset))},setOffset:function(t){return t instanceof DG.Point&&(this.options.offset=t,this._onViewReset()),this},setZIndexOffset:function(t){return isNaN(+t)||(this.options.zIndexOffset=+t,this._visible&&(this._el.style.zIndex=this._defaultZIndex+this.options.zIndexOffset)),this},setContent:function(t){return Object.prototype.toString.call(t)!==this._typeOfString?this:(this._content=t,this._visible&&(this._container.innerHTML=t),this)},setPosition:function(t){return t instanceof DG.LatLng?(this._latlng=t,this._onViewReset(),this):this}}),DG.label=function(t,e){return new DG.Label(t,e)},DG.Marker.include({bindLabel:function(t,e){return this._label?(this._label.setContent(t),e&&(this.options.offset!==e.offset&&this._label.setOffset(this.options.offset=e.offset),this.options.static!==e.static&&this.unbindLabel().bindLabel(t,e))):(e=DG.extend({offset:new DG.Point(5,5)},e),this._label=DG.label(t,e),this.once("remove",this.unbindLabel),e.static?this.showLabel():this.once("mouseover",this._mouseOverLabel),"undefined"!=typeof this._map?this._updateLabelZIndex():this.once("add",this._updateLabelZIndex)),this},unbindLabel:function(){return this._label&&(this.hideLabel().off("remove",this.unbindLabel).off("mouseover",this._mouseOverLabel).off("mouseout",this._mouseOutLabel).off("dragstart",this._dragStartLabel).off("dragend",this._dragEndLabel).off("move",this._updatePosition).off("add",this._updateLabelZIndex),this._label=null),this},getLabel:function(){return this._label?this._label:null},_originalUpdateZIndex:DG.Marker.prototype._updateZIndex,_updateZIndex:function(t){return this._originalUpdateZIndex(t),this._updateLabelZIndex(),this},_updateLabelZIndex:function(){return this._label&&this._icon&&this._label.setZIndexOffset(this._icon.style.zIndex),this},showLabel:function(){return this._label&&this.on("move",this._updatePosition)._map.addLayer(this._label.setPosition(this.getLatLng())),this},hideLabel:function(){return this._label&&this.off("move",this._updatePosition)._map.removeLayer(this._label),this},_updatePosition:function(){this._label.setPosition(this.getLatLng())},_dragStartLabel:function(){this.off("mouseout",this._mouseOutLabel).off("dragstart",this._mouseOutLabel).once("dragend",this._dragEndLabel).hideLabel()},_dragEndLabel:function(){this.once("mouseover",this._mouseOverLabel)},_mouseOverLabel:function(){this.showLabel().on("dragstart",this._dragStartLabel).on("mouseout",this._mouseOutLabel)},_mouseOutLabel:function(){this.hideLabel().off("mouseout",this._mouseOutLabel).off("dragstart",this._dragStartLabel).once("mouseover",this._mouseOverLabel)}}),DG.Marker.addInitHook(function(){"undefined"!=typeof this.options.label&&this.bindLabel(this.options.label)}),DG.Path.include({bindLabel:function(t,e){return this._label?(this._label.setContent(t),this._label.options.offset!==e.offset&&this._label.setOffset(e.offset)):(this._label=DG.label(t,e),this.on(this._labelEvents,this)),this},unbindLabel:function(){return this._label&&(this.off(this._labelEvents,this),this._map.removeLayer(this._label),this._label=null),this},getLabel:function(){return this._label?this._label:null},_labelEvents:{mouseover:function(t){this._map.addLayer(this._label.setPosition(t.latlng))},mousemove:function(t){this._label.setPosition(t.latlng)},mouseout:function(){this._map.removeLayer(this._label)},remove:function(){this._map.removeLayer(this._label)}}}),DG.Path.addInitHook(function(){"undefined"!=typeof this.options.label&&this.bindLabel(this.options.label)}),DG.Wkt={},DG.Wkt.toGeoJSON=function(t){function e(e){var i=t.substring(m).match(e);return i?(m+=i[0].length,i[0]):null}function i(t){return t&&_.match(/\d+/)&&(t.crs={type:"name",properties:{name:"urn:ogc:def:crs:EPSG::"+_}}),t}function n(){e(/^\s*/)}function o(){n();for(var t,i=0,o=[],r=[o],s=o;t=e(/^(\()/)||e(/^(\))/)||e(/^(\,)/)||e(/^[-+]?([0-9]*\.[0-9]+|[0-9]+)/);){if("("===t)r.push(s),s=[],r[r.length-1].push(s),i++;else if(")"===t){if(s=r.pop(),i--,0===i)break}else","===t?(s=[],r[r.length-1].push(s)):s.push(parseFloat(t));n()}return r.length=0,0!==i?null:o}function r(){for(var t,i,o=[];i=e(/^[-+]?([0-9]*\.[0-9]+|[0-9]+)/)||e(/^(\,)/);)","===i?(o.push(t),t=[]):(t||(t=[]),t.push(parseFloat(i))),n();return t&&o.push(t),o.length?o:null}function s(){if(!e(/^(point)/i))return null;if(n(),!e(/^(\()/))return null;var t=r();return n(),e(/^(\))/)?{type:"Point",coordinates:t[0]}:null}function a(){if(!e(/^(multipoint)/i))return null;n();var t=o();return n(),{type:"MultiPoint",coordinates:t}}function l(){if(!e(/^(multilinestring)/i))return null;n();var t=o();return n(),{type:"MultiLineString",coordinates:t}}function c(){if(!e(/^(linestring)/i))return null;if(n(),!e(/^(\()/))return null;var t=r();return e(/^(\))/)?{type:"LineString",coordinates:t}:null}function u(){return e(/^(polygon)/i)?(n(),{type:"Polygon",coordinates:o()}):null}function h(){return e(/^(multipolygon)/i)?(n(),{type:"MultiPolygon",coordinates:o()}):null}function d(){var t,i=[];if(!e(/^(geometrycollection)/i))return null;if(n(),!e(/^(\()/))return null;for(;t=p();)i.push(t),n(),e(/^(\,)/),n();return e(/^(\))/)?{type:"GeometryCollection",geometries:i}:null}function p(){return s()||c()||u()||a()||l()||h()||d()}DG.Util.isArray(t)&&(t=t[0]);var f=t.split(";");t=f.pop();var m=0,_=(f.shift()||"").split("=").pop();return i(p())},DG.Wkt.geoJsonLayer=function(t,e){return DG.geoJson(DG.Wkt.toGeoJSON(t),e)},DG.Wkt.toLatLngs=function(t){var e=DG.Wkt.toGeoJSON(t).coordinates;return DG.Util.isArray(e)?e.map(function(t){return DG.Util.isArray(t[0])?DG.GeoJSON.coordsToLatLngs(t):[DG.GeoJSON.coordsToLatLng(t)]}).reduce(function(t,e){return t.concat(e)}):DG.GeoJSON.coordsToLatLngs(e)},DG.Wkt.toPoints=function(t){return DG.Wkt.toGeoJSON(t).coordinates},DG.Wkt.pointsToLatLngOnMap=function(t,e){return function i(t){return Array.isArray(t)&&Array.isArray(t[0])?t.map(i):e.containerPointToLatLng(t)}(DG.Wkt.toPoints(t))},DG.Dictionary={},DG.Dictionary.ru={pluralRules:function(t){return t%10===1&&t%100!==11?0:t%10>=2&&4>=t%10&&t%10%1===0&&(12>t%100||t%100>14)?1:t%10===0||t%10>=5&&9>=t%10&&t%10%1===0||t%100>=11&&14>=t%100&&t%100%1===0?2:void 0}},DG.Dictionary.en={pluralRules:function(t){return 1===t?0:1}},DG.Dictionary.it={pluralRules:function(t){return 1===t?0:1}},DG.Dictionary.cs={pluralRules:function(t){return 1===t?0:t>=2&&4>=t?1:2}},DG.Dictionary.sp={pluralRules:function(t){return t>=2?1:0}},DG.Locale={t:function(t,e){var i,n,o,r=this._map.options.currentLang,s=!1;return"undefined"==typeof this.constructor.Dictionary[r]&&(r="ru",this._map.setLang(r)),n=this.constructor.Dictionary[r][t],(s="undefined"!=typeof n)?(i=s?n:t,e!==undefined&&(e=parseInt(e,10),e=isNaN(e)?0:e,o=this.constructor.Dictionary[r].pluralRules(e),i=n[o]),i=DG.Util.template(i,{n:e}),i?i:t):t}},DG.Map.mergeOptions({currentLang:getPageLang()}),DG.Map.include({setLang:function(t){t&&"[object String]"===Object.prototype.toString.call(t)&&(this.options.currentLang=t,this.fire("langchange",{lang:t}))},getLang:function(){return this.options.currentLang}}),DG.RoundControl=DG.Control.extend({includes:DG.Mixin.Events,options:{position:"topright",iconClass:"default"},onAdd:function(t){var e=this._controlCLass="dg-control-round",i=this._controlIconCLass=this._controlCLass+"__icon",n=DG.DomUtil.create("div","");return this._disable?n:(DG.DomUtil.addClass(n,e),this._link=DG.DomUtil.create("a",i+" "+i+"_name_"+this.options.iconClass,n),this._link.href="#",this._renderTranslation(),this._map=t,this.fireEvent("add"),DG.DomEvent.on(n,"click",this._toggleControl,this).on(n,"dblclick",DG.DomEvent.stopPropagation),this.fireEvent("add"),n)},onRemove:function(){this.fireEvent("remove"),DG.DomEvent.off(this._link,"click",this._toggleControl)},setState:function(t){return this._link&&this._container?(this._state&&(DG.DomUtil.removeClass(this._container,this._controlCLass+"_state_"+this._state),DG.DomUtil.removeClass(this._link,this._controlIconCLass+"_state_"+this._state),this._state=null),t&&(this._state=t,DG.DomUtil.addClass(this._container,this._controlCLass+"_state_"+this._state),DG.DomUtil.addClass(this._link,this._controlIconCLass+"_state_"+this._state)),this):this},_toggleControl:function(t){DG.DomEvent.stop(t),this.fireEvent("click")}}),DG.RoundControl.include(DG.Locale),DG.roundControl=function(t){return new DG.RoundControl(t)},DG.ProjectDetector=DG.Handler.extend({initialize:function(t){this._map=t,this._osmViewport=!1,this.project=null,this._loadProjectList()},addHooks:function(){this._map.on("move",this._projectWatch,this)},removeHooks:function(){this._map.off("move",this._projectWatch,this)},getProject:function(){return this.project?DG.Util.extend({},this.project):!1},getProjectsList:function(){return DG.projectsList.slice(0)},isProjectHere:function(t,e,i){return t?(t instanceof DG.LatLng||t instanceof DG.LatLngBounds||(t=DG.latLng(t)),t=t instanceof DG.LatLngBounds?DG.latLngBounds(t.getSouthWest().wrap(),t.getNorthEast().wrap()):t.wrap(),i=i||(t instanceof DG.LatLngBounds?"intersects":"contains"),e?this._testProject(i,t,e):DG.projectsList.filter(this._testProject.bind(this,i,t))[0]):void 0},_projectWatch:function(){this._osmViewport===(this.project&&this._boundInProject(this.project,"contains"))&&(this._osmViewport=!this._osmViewport,this._map.attributionControl._update(null,this._osmViewport)),this.project&&this._boundInProject(this.project)&&this._zoomInProject(this.project)||(this.project&&(this.project=null,this._map.fire("projectleave")),this._searchProject())},_loadProjectList:function(){DG.projectsList.map(function(t){return t.latLngBounds=new DG.LatLngBounds(t.bound),t})},_searchProject:function(){DG.projectsList.filter(function(t){return this._boundInProject(t)&&this._zoomInProject(t)},this).some(function(t){var e=this;return this.project=t,setTimeout(function(){e._map.fire("projectchange",{getProject:e.getProject.bind(e)})},1),!0},this)},_boundInProject:function(t,e){try{return this.isProjectHere(this._map.getBounds(),t,e)}catch(i){return!1}},_testProject:function(t,e,i){return i.latLngBounds[t](e)},_zoomInProject:function(t){return this._map.getZoom()>=t.minZoom}}),DG.Map.mergeOptions({projectDetector:!0}),DG.Map.addInitHook("addHandler","projectDetector",DG.ProjectDetector),DG.configTheme={balloonOptions:{offset:{x:1,y:9}},markersData:{iconSize:[22,34],className:"dg-customization__marker dg-customization__marker_type_mushroom",iconAnchor:[10,32]}},function(t,e){"use strict";function i(e,i,n){e._eventHandlers=e._eventHandlers||[{element:e.scroller,handler:function(t){e.scroll(t)},type:"scroll"},{element:e.bar,handler:function(t){t.preventDefault?t.preventDefault():t.returnValue=!1,e.selection(),e.drag.now=1},type:"touchstart mousedown"},{element:document,handler:function(){e.selection(1),e.drag.now=0},type:"mouseup blur touchend"},{element:e.bar,handler:function(t){2!=t.button&&e._pos0(t)},type:"touchstart mousedown"},{element:document,handler:function(t){e.drag.now&&e.drag(t)},type:"mousemove touchmove"},{element:t,handler:function(){e.update()},type:"resize"},{element:e.root,handler:function(){e.update()},type:"sizeChange"}],h(e._eventHandlers,function(t){t.element&&i(t.element,t.type,t.handler,n)})}function n(t,e,i){var n="data-baron-"+e;if("on"==i)t.setAttribute(n,"inited");else{if("off"!=i)return t.getAttribute(n);t.removeAttribute(n)}}function o(t){if(!n(t.root,t.direction)){var e=new p.prototype.constructor(t);return i(e,t.event,"on"),n(e.root,t.direction,"on"),e.update(),e}}function r(t){var e={};t=t||{};for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e}function s(t){var e=r(t);e.direction=e.direction||"v";var i=t.event||function(t,i,n,o){e.$(t)[o||"on"](i,n)};return e.event=function(t,e,n,o){h(t,function(t){i(t,e,n,o)})},e}function a(t){if(this.events&&this.events[t])for(var e=0;e<this.events[t].length;e++){var i=Array.prototype.slice.call(arguments,1);this.events[t][e].apply(this,i)}}if(t){var l=t.baron,c=t.jQuery,u={v:{x:"Y",pos:"top",crossPos:"left",size:"height",crossSize:"width",client:"clientHeight",crossClient:"clientWidth",offset:"offsetHeight",crossOffset:"offsetWidth",offsetPos:"offsetTop",scroll:"scrollTop",scrollSize:"scrollHeight"},h:{x:"X",pos:"left",crossPos:"top",size:"width",crossSize:"height",client:"clientWidth",crossClient:"clientHeight",offset:"offsetWidth",crossOffset:"offsetHeight",offsetPos:"offsetLeft",scroll:"scrollLeft",scrollSize:"scrollWidth"}},h=function(i,n){var o=0;for((i.length===e||i===t)&&(i=[i]);i[o];)n.call(this,i[o],o),o++},d=function(e){var i,n,o=!1;return e=e||{},n=e.$||t.jQuery,o?e.root=i=this:i=n(e.root||e.scroller),new d.fn.constructor(i,e,n)};d.fn={constructor:function(t,e,i){var n=s(e);n.$=i,h.call(this,t,function(t,e){var i=r(n);n.root&&n.scroller?(i.scroller=n.$(n.scroller,t),i.scroller.length||(i.scroller=t)):i.scroller=t,i.root=t,this[e]=o(i),this.length=e+1}),this.params=n},dispose:function(){var t=this.params;h(this,function(e){e.dispose(t)}),this.params=null},update:function(){for(var t=0;this[t];)this[t].update.apply(this[t],arguments),t++},baron:function(t){return t.root=[],t.scroller=this.params.scroller,h.call(this,this,function(e){t.root.push(e.root)}),t.direction="v"==this.params.direction?"h":"v",t._chain=!0,d(t)}};var p={};p.prototype={constructor:function(t){function i(t,e){return h(t,e)[0]}function n(t){var e=this.barMinSize||20;t>0&&e>t&&(t=e),this.bar&&h(this.bar).css(this.origin.size,parseInt(t,10)+"px")}function o(t){this.bar&&h(this.bar).css(this.origin.pos,+t+"px")}function r(){return f[this.origin.client]-this.barTopLimit-this.bar[this.origin.offset]}function s(t){return t*r.call(this)+this.barTopLimit}function l(t){return(t-this.barTopLimit)/r.call(this)}function c(){return!1}var h,d,p,f,m,_,g,y,v;return v=y=(new Date).getTime(),h=this.$=t.$,this.event=t.event,this.events={},this.root=t.root,this.scroller=i(t.scroller),this.bar=i(t.bar,this.root),f=this.track=i(t.track,this.root),!this.track&&this.bar&&(f=this.bar.parentNode),this.clipper=this.scroller.parentNode,this.direction=t.direction,this.origin=u[this.direction],this.barOnCls=t.barOnCls,this.barTopLimit=0,g=1e3*t.pause||0,this.cursor=function(t){return t["client"+this.origin.x]||(((t.originalEvent||t).touches||{})[0]||{})["page"+this.origin.x]},this.pos=function(t){var i="page"+this.origin.x+"Offset",n=this.scroller[i]?i:this.origin.scroll;return t!==e&&(this.scroller[n]=t),this.scroller[n]},this.rpos=function(t){var e,i=this.scroller[this.origin.scrollSize]-this.scroller[this.origin.client];return e=t?this.pos(t*i):this.pos(),e/(i||1)},this.barOn=function(t){this.barOnCls&&(t||this.scroller[this.origin.client]>=this.scroller[this.origin.scrollSize]?h(this.root).removeClass(this.barOnCls):h(this.root).addClass(this.barOnCls))},this._pos0=function(t){p=this.cursor(t)-d},this.drag=function(t){this.scroller[this.origin.scroll]=l.call(this,this.cursor(t)-p)*(this.scroller[this.origin.scrollSize]-this.scroller[this.origin.client])},this.selection=function(t){this.event(document,"selectpos selectstart",c,t?"off":"on")},this.resize=function(){function e(){var e=i.scroller[i.origin.crossOffset]-i.scroller[i.origin.crossClient];t.freeze&&!i.clipper.style[i.origin.crossSize]&&h(i.clipper).css(i.origin.crossSize,i.clipper[i.origin.crossClient]-e+"px"),h(i.scroller).css(i.origin.crossSize,i.clipper[i.origin.crossClient]+e+"px"),Array.prototype.unshift.call(arguments,"resize"),a.apply(i,arguments),v=(new Date).getTime()}var i=this,n=0;(new Date).getTime()-v<g&&(clearTimeout(m),n=g),n?m=setTimeout(e,n):e()},this.scroll=function(){function t(){l.bar&&(i=(f[l.origin.client]-l.barTopLimit)*l.scroller[l.origin.client]/l.scroller[l.origin.scrollSize],e!=i&&(n.call(l,i),e=i),d=s.call(l,l.rpos()),o.call(l,d)),Array.prototype.unshift.call(arguments,"scroll"),a.apply(l,arguments),y=(new Date).getTime()}var e,i,r=0,l=this;(new Date).getTime()-y<g&&(clearTimeout(_),r=g),r?_=setTimeout(t,r):t()},this},update:function(t){return a.call(this,"upd",t),this.resize(1),this.barOn(),this.scroll(),this},dispose:function(t){i(this,this.event,"off"),n(this.root,t.direction,"off"),c(this.scroller).css(this.origin.crossSize,""),this.barOn(!0),a.call(this,"dispose")
},on:function(t,e,i){for(var n=t.split(" "),o=0;o<n.length;o++)"init"==n[o]?e.call(this,i):(this.events[n[o]]=this.events[n[o]]||[],this.events[n[o]].push(function(t){e.call(this,t||i)}))}},d.fn.constructor.prototype=d.fn,p.prototype.constructor.prototype=p.prototype,d.noConflict=function(){return t.baron=l,d},d.version="0.6.6",c&&c.fn&&(c.fn.baron=d),t.baron=d,t.module&&module.exports&&(module.exports=d.noConflict())}}(window),function(t,e){var n=function(t){function n(t,i){a<(l.minView||0)&&(i=e),i!==e?(i+="px",this.$(s[t]).css(this.origin.pos,i).addClass(l.outside)):this.$(s[t]).css(this.origin.pos,"").removeClass(l.outside)}function o(t){try{i=document.createEvent("WheelEvent"),i.initWebKitWheelEvent(t.originalEvent.wheelDeltaX,t.originalEvent.wheelDeltaY),d.dispatchEvent(i),t.preventDefault()}catch(t){}}function r(t){var e;for(var i in t)l[i]=t[i];if(s=this.$(l.elements,this.scroller)){a=this.scroller[this.origin.client];for(var n=0;n<s.length;n++)e={},e[this.origin.size]=s[n][this.origin.offset],s[n].parentNode!==this.scroller&&this.$(s[n].parentNode).css(e),e={},e[this.origin.crossSize]=s[n].parentNode[this.origin.crossClient],this.$(s[n]).css(e),a-=s[n][this.origin.offset],h[n]=s[n].parentNode[this.origin.offsetPos],c[n]=c[n-1]||0,u[n]=u[n-1]||Math.min(h[n],0),s[n-1]&&(c[n]+=s[n-1][this.origin.offset],u[n]+=s[n-1][this.origin.offset]),(0!=n||0!=h[n])&&(this.event(s[n],"mousewheel",o,"off"),this.event(s[n],"mousewheel",o));l.limiter&&s[0]&&(this.track&&this.track!=this.scroller?(e={},e[this.origin.pos]=s[0].parentNode[this.origin.offset],this.$(this.track).css(e)):this.barTopLimit=s[0].parentNode[this.origin.offset],this.scroll()),l.limiter===!1&&(this.barTopLimit=0)}var r={element:s,handler:function(){for(var t,e=f(this)[0].parentNode,i=e.offsetTop,n=0;n<s.length;n++)s[n]===this&&(t=n);var o=i-c[t];l.scroll?l.scroll({x1:m.scroller.scrollTop,x2:o}):m.scroller.scrollTop=o},type:"click"};l.clickable&&(this._eventHandlers.push(r),p(r.element,r.type,r.handler,"off"),p(r.element,r.type,r.handler,"on"))}var s,a,l={outside:"",before:"",after:"",past:"",future:"",radius:0,minView:0},c=[],u=[],h=[],d=this.scroller,p=this.event,f=this.$,m=this;this.on("init",r,t),this.on("init scroll",function(){var t,i,o=[];if(s){for(var r,d=0;d<s.length;d++)t=0,h[d]-this.pos()<u[d]+l.radius?(t=1,i=c[d]):h[d]-this.pos()>u[d]+a-l.radius?(t=2,i=c[d]+a):(t=3,i=e),t!=o[d]&&(n.call(this,d,i),o[d]=t,r=!0);if(r)for(d=0;d<s.length;d++)1==o[d]&&l.past&&this.$(s[d]).addClass(l.past).removeClass(l.future),2==o[d]&&l.future&&this.$(s[d]).addClass(l.future).removeClass(l.past),3==o[d]&&(l.future||l.past)&&this.$(s[d]).removeClass(l.past).removeClass(l.future),o[d]!=o[d+1]&&1==o[d]&&l.before?this.$(s[d]).addClass(l.before).removeClass(l.after):o[d]!=o[d-1]&&2==o[d]&&l.after?this.$(s[d]).addClass(l.after).removeClass(l.before):this.$(s[d]).removeClass(l.before).removeClass(l.after)}}),this.on("resize upd",function(t){r.call(this,t&&t.fix)})};baron.fn.fix=function(t){for(var e=0;this[e];)n.call(this[e],t),e++;return this}}(window),function(){var t=function(t){var e,i,n,o,r=this;o=t.screen||.9,t.forward&&(e=this.$(t.forward,this.clipper),this.event(e,"click",function(){var e=r.pos()-t.delta||30;r.pos(e)})),t.backward&&(i=this.$(t.backward,this.clipper),this.event(i,"click",function(){var e=r.pos()+t.delta||30;r.pos(e)})),t.track&&(n=t.track===!0?this.track:this.$(t.track,this.clipper)[0],n&&this.event(n,"mousedown",function(t){var e=t["offset"+r.origin.x],i=r.bar[r.origin.offsetPos],n=0;i>e?n=-1:e>i+r.bar[r.origin.offset]&&(n=1);var s=r.pos()+n*o*r.scroller[r.origin.client];r.pos(s)}))};baron.fn.controls=function(e){for(var i=0;this[i];)t.call(this[i],e),i++;return this}}(window),function(){var t=function(t){function e(){return g.scroller[g.origin.scroll]+g.scroller[g.origin.offset]}function i(){return g.scroller[g.origin.scrollSize]}function n(){return g.scroller[g.origin.client]}function o(t,e){var i=5e-4*t;return Math.floor(e-i*(t+550))}function r(t){u=t,t?(s(),a=setInterval(s,200)):clearInterval(a)}function s(){var s,a,u={},w=e(),x=i(),D=1==y;if(a=0,y>0&&(a=40),s=o(L,a),w>=x-L&&y>-1?D&&(L+=s):L=0,0>L&&(L=0),u[d]=L+"px",n()<=i()){g.$(h).css(u);for(var k=0;k<m.length;k++)g.$(m[k].self).css(m[k].property,Math.min(L/p*100,100)+"%")}_&&L&&g.$(g.root).addClass(_),0==L&&t.onCollapse&&t.onCollapse(),y=0,l=setTimeout(function(){y=-1},b),f&&L>p&&!c&&(f(),c=!0),0==L?v++:v=0,v>1&&(r(!1),c=!1,_&&g.$(g.root).removeClass(_))}var a,l,c,u,h=this.$(t.block),d=t.size||this.origin.size,p=t.limit||80,f=t.onExpand,m=t.elements||[],_=t.inProgress||"",g=this,y=0,v=0,L=0,b=t.waiting||500;this.on("init",function(){r(!0)}),this.on("dispose",function(){r(!1)}),this.event(this.scroller,"mousewheel DOMMouseScroll",function(t){var n=t.wheelDelta<0||t.originalEvent&&t.originalEvent.wheelDelta<0||t.detail>0;n&&(y=1,clearTimeout(l),!u&&e()>=i()&&r(!0))})};baron.fn.pull=function(e){for(var i=0;this[i];)t.call(this[i],e),i++;return this}}(window);var controlAddTo=DG.Control.prototype.addTo,panBy=DG.Map.prototype.panBy,getBoundsZoom=DG.Map.prototype.getBoundsZoom;DG.Control.include({addTo:function(t){return t.on("langchange",this._renderTranslation,this),controlAddTo.call(this,t)},_renderTranslation:function(){}}),DG.Marker.prototype.options.icon=DG.divIcon(DG.configTheme.markersData),DG.Map.include({_mapMaxZoomCache:undefined,initialize:function(t,e){e=L.setOptions(this,e),this._initContainer(t),this._initLayout(),this._onResize=L.bind(this._onResize,this),this._initEvents(),e.maxBounds&&this.setMaxBounds(e.maxBounds),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._tileLayersNum=0,this.callInitHooks(),this._addLayers(e.layers),e.center&&e.zoom!==undefined&&this.setView(L.latLng(e.center),e.zoom,{reset:!0})},setView:function(t,e,i){if(this._resctrictZoom(t),e=this._limitZoom(e===undefined?this._zoom:e),t=this._limitCenter(DG.latLng(t),e,this.options.maxBounds),i=i||{},i.animate&&(i.animate=this._testAnimation(t)),this._panAnim&&this._panAnim.stop(),this._loaded&&!i.reset&&i!==!0){i.animate!==undefined&&(i.zoom=DG.extend({animate:i.animate},i.zoom),i.pan=DG.extend({animate:i.animate},i.pan));var n=this._zoom!==e?this._tryAnimatedZoom&&this._tryAnimatedZoom(t,e,i.zoom):this._tryAnimatedPan(t,i.pan);if(n)return clearTimeout(this._sizeTimer),this}return this._resetView(t,e),this},panBy:function(t,e){var i=panBy.call(this,t,e),n=this._resctrictZoom(this.getCenter());return this.getZoom()>n&&this.setZoom(n),i},getBoundsZoom:function(t,e,i){return this._resctrictZoom(t),getBoundsZoom.call(this,t,e,i)},_testAnimation:function(t){return this.projectDetector.enabled()?this.projectDetector.getProject().code===this.projectDetector.isProjectHere(t).code:!0},_updateTln:function(t){"string"==typeof this._tln&&(this._tln=0),t.layer instanceof DG.TileLayer&&!t.layer._isDg&&("layeradd"===t.type?this._tln++:this._tln--)},_resctrictZoom:function(t){if(this._layers&&this.projectDetector.enabled()&&(0===this._tln||"dgTiles"===this._tln)){var e=this.options,i=!!e.maxZoom,n=this.baseLayer,o=this.projectDetector.isProjectHere(t);return i?(this._mapMaxZoomCache||(this._mapMaxZoomCache=e.maxZoom),e.maxZoom=this._mapMaxZoomCache&&o?this._mapMaxZoomCache:"13",o&&(this._mapMaxZoomCache=e.maxZoom),e.maxZoom):(n.options.maxZoom=o?o.maxZoom:"13",this._updateZoomLevels(),n.options.maxZoom)}}}),DG.Map.addInitHook(function(){this.on("layeradd layerremove",this._updateTln)}),DG.Browser.safari51=/5\.1[\.\d]* Safari/.test(navigator.userAgent),function(){var t=DG.configTheme.balloonOptions.offset.x,e=DG.configTheme.balloonOptions.offset.y,i=DG.Popup.prototype.initialize,n=DG.Popup.prototype._initLayout,o=DG.Popup.prototype._onCloseButtonClick,r=DG.Popup.prototype.onAdd,s=DG.Popup.prototype.onRemove,a=DG.Popup.prototype._adjustPan,l=baron.noConflict(),c=function(t){this[0]=t,this.length=1};c.prototype={setAttribute:function(t,e){return this[0].setAttribute(t,e),this},getAttribute:function(t){return this[0].getAttribute(t)},removeAttribute:function(t){return this[0].removeAttribute(t),this},css:function(t,e){return e?(this[0].style[t]=e,this):DG.DomUtil.getStyle(this[0],t)}},DG.Popup.prototype.options.offset=DG.point(t,e),DG.Popup.mergeOptions({border:16}),DG.Popup.include({_headerContent:null,_footerContent:null,_scroller:null,_scrollerBar:null,_barWrapper:null,_baron:null,_isBaronExist:!1,_popupShowClass:"leaflet-popup_show_true",_popupHideClass:"leaflet-popup_show_false",_popupTipClass:"leaflet-popup-tip-container",_tipSVGPath:"M0 0c12.643 0 28 7.115 28 44h2c0-36.885 15.358-44 28-44h-58z",initialize:function(t,e){this._popupStructure={},i.call(this,t,e)},onAdd:function(t){t.on("entranceshow",this._closePopup,this),r.call(this,t),this._animateOpening()},onRemove:function(t){this._animateClosing(),t.off("entranceshow",this._closePopup,this),s.call(this,t)},setContent:function(t){return this._isNode(t)||"object"!=typeof t||null===typeof t?this._bodyContent=t:Object.keys(t).forEach(function(e){this["_"+e+"Content"]=t[e]},this),this.update(),this},setHeaderContent:function(t){return this._headerContent=t,this.update(),this},setFooterContent:function(t){return this._footerContent=t,this.update(),this},clear:function(){return Object.keys(this._popupStructure).forEach(this._clearElement,this),this._isBaronExist=!1,this},clearHeader:function(){return this._clearElement("header")},clearFooter:function(){return this._clearElement("footer")},findElement:function(t){return this._contentNode.querySelector(t)},_animateOpening:function(){DG.DomUtil.addClass(this._innerContainer,this._popupShowClass),DG.DomUtil.removeClass(this._innerContainer,this._popupHideClass)},_animateClosing:function(){DG.DomUtil.addClass(this._innerContainer,this._popupHideClass),DG.DomUtil.removeClass(this._innerContainer,this._popupShowClass)},_closePopup:function(){this._map.closePopup(this)},_isNode:function(t){return t.nodeName?!0:!1},_initLayout:function(){n.call(this),this._innerContainer=DG.DomUtil.create("div","leaflet-popup-inner "+this._popupHideClass,this._container),this.options.closeButton&&this._innerContainer.appendChild(this._detachEl(this._closeButton)),this._innerContainer.appendChild(this._detachEl(this._wrapper));var t=this._detachEl(this._tipContainer);if(DG.Browser.svg){var e=DG.SVG.create("path"),i=this._popupTipClass+" "+this._popupTipClass+"_svg";e.setAttribute("d",this._tipSVGPath),t=DG.SVG.create("svg"),t.setAttribute("class",i),t.appendChild(e),DG.DomEvent.disableClickPropagation(e)}else DG.DomUtil.addClass(t,this._popupTipClass+"_image"),DG.DomEvent.disableClickPropagation(t);this._innerContainer.appendChild(t)},_clearElement:function(t){return this["_"+t+"Content"]=null,this._detachEl(this._popupStructure[t]),delete this._popupStructure[t],this},_updateScrollPosition:function(){this._baron&&this._baron.update()},resize:function(){var t=this._isBaronExist?this._scroller.scrollTop:!1;this._updateLayout(),this._updatePosition(),this._isContentHeightFit()?this._isBaronExist?(DG.DomUtil.removeClass(this._scroller,"dg-scroller_hidden_true"),DG.DomUtil.addClass(this._scroller,"dg-scroller_has-header_true"),DG.DomUtil.addClass(this._scroller,"dg-scroller"),t&&(this._scroller.scrollTop=t),this._updateScrollPosition()):(this._initBaronScroller(),this._initBaron()):this._isBaronExist&&(DG.DomUtil.addClass(this._scroller,"dg-scroller_hidden_true"),DG.DomUtil.removeClass(this._scroller,"dg-scroller_has-header_true"),DG.DomUtil.removeClass(this._scroller,"dg-scroller"),DG.DomEvent.off(this._scroller,"scroll",this._onScroll)),a.call(this),this._bindAdjustPanOnTransitionEnd()},_adjustPan:function(t){this._map&&(t?"max-height"===t.propertyName&&(setTimeout(a.bind(this),1),DG.DomEvent.off(this._wrapper,DG.DomUtil.TRANSITION_END,this._adjustPan)):a.call(this))},_bindAdjustPanOnTransitionEnd:function(){DG.DomUtil.TRANSITION?DG.DomEvent.on(this._wrapper,DG.DomUtil.TRANSITION_END,this._adjustPan,this):this._adjustPan()},_isContentHeightFit:function(){var t,e=this.options.maxHeight;return t=this._popupStructure.body?this._popupStructure.body.offsetHeight+this._getDelta():this._contentNode.offsetHeight,t+=2*this.options.border,e&&t>e},_initBaronScroller:function(){var t=this._popupStructure.body.parentNode,e=this._scrollerWrapper=DG.DomUtil.create("div","dg-scroller__wrapper",t),i=this._scroller=DG.DomUtil.create("div","dg-scroller",e),n=this._barWrapper=DG.DomUtil.create("div","dg-scroller__bar-wrapper",i),o=this.options.maxHeight-2*this.options.border;this._scrollerBar=DG.DomUtil.create("div","dg-scroller__bar",n),i.appendChild(this._detachEl(this._popupStructure.body)),o-=this._getDelta(),e.style.height=Math.max(18,o)+"px",e.style.width=t.offsetWidth+5+"px",this._isBaronExist=!0,this._switchEvents()},_onScroll:function(t){this.fire("scroll",{originalEvent:t})},_onClick:function(t){t.target=t.target||t.srcElement;var e=t.target.getAttribute("href");"scroller__bar"===t.target.className||e&&(-1!==e.indexOf("http")||-1!==e.indexOf("mailto"))||(this._moving||this.fire("click",{originalEvent:t}),DG.DomEvent.stop(t))},_onStart:function(t){if(this._moved=!1,!this._moving){var e=t.touches?t.touches[0]:t;this._startPoint=new DG.Point(e.clientX,e.clientY),this._toggleTouchEvents()}},_onEnd:function(t){this._toggleTouchEvents(!0),this._onClick(t),this._moving=!1},_onMove:function(t){if(t.touches&&t.touches.length>1)return void(this._moved=!0);var e=t.touches&&1===t.touches.length?t.touches[0]:t,i=DG.point(e.clientX,e.clientY),n=Math.abs(i.subtract(this._startPoint).y);!n||10>n||(this._moving=this._moved=!0)},_initBaron:function(){var t=this._scrollerWrapper;this._baron=l({scroller:".dg-scroller",bar:".dg-scroller__bar",track:".dg-scroller__bar-wrapper",$:function(e){var i="[object String]"==={}.toString.call(e)?t.querySelector(e):e;return new c(i)},event:function(t,e,i,n){e.split(" ").forEach(function(e){DG.DomEvent[n||"on"](t,e,i)})}})},_initHeader:function(){this._popupStructure.header=DG.DomUtil.create("header","dg-popup__header",this._contentNode)},_initFooter:function(){this._popupStructure.footer=DG.DomUtil.create("footer","dg-popup__footer",this._contentNode)},_initBodyContainer:function(){this._popupStructure.wrapper=DG.DomUtil.create("div","dg-popup__container-wrapper",this._contentNode),this._popupStructure.body=DG.DomUtil.create("div","dg-popup__container",this._popupStructure.wrapper)},update:function(){if(this._map){if(this._container.style.visibility="hidden",this._switchEvents(!0),this._clearNode(this._contentNode),this._headerContent&&this._initHeader(),this._bodyContent&&this._initBodyContainer(),this._footerContent&&this._initFooter(),this._updatePopupStructure(),this.resize(),DG.DomEvent.on(this._wrapper,"click",DG.DomEvent.stopPropagation),this._switchEvents(),DG.Browser.ielt9){var t=this._popupStructure.footer;t&&(t.className+=" ie8")}this._container.style.visibility=""}},_getDelta:function(){var t=0,e=this._popupStructure;return e.header&&(t+=e.header.offsetHeight),e.footer&&(t+=e.footer.offsetHeight),t},_updateLayout:function(){var t,e=this._contentNode,i=this._wrapper,n=e.style,o=i.style,r="leaflet-popup-scrolled";n.margin=this.options.border+"px",this._isContentHeightFit()?(o.maxHeight=this.options.maxHeight+"px",DG.DomUtil.addClass(e,r)):(o.maxHeight=e.offsetHeight+2*this.options.border+"px",DG.DomUtil.removeClass(e,r)),n.whiteSpace="nowrap",t=i.offsetWidth,n.whiteSpace="",t=Math.min(t,this.options.maxWidth),t=Math.max(t,this.options.minWidth),o.width=t+"px",this._containerWidth=this._container.offsetWidth},_updatePopupStructure:function(){Object.keys(this._popupStructure).forEach(function(t){this._insertContent(this["_"+t+"Content"],this._popupStructure[t])},this),this.fire("contentupdate")},_insertContent:function(t,e){t&&e&&("string"==typeof t?e.innerHTML=t:(this._clearNode(e),e.appendChild(t)))},_clearNode:function(t){for(;t.hasChildNodes();)t.removeChild(t.firstChild)},_detachEl:function(t){return t.parentNode&&t.parentNode.removeChild(t),t},_onCloseButtonClick:function(t){this._animateClosing(),DG.DomUtil.TRANSITION?DG.DomEvent.on(this._innerContainer,DG.DomUtil.TRANSITION_END,this._firePopupClose,this):this._firePopupClose(t),DG.DomEvent.stop(t)},_firePopupClose:function(t){DG.DomUtil.TRANSITION&&DG.DomEvent.off(this._innerContainer,DG.DomUtil.TRANSITION_END,this._firePopupClose,this),o.call(this,t)},_switchEvents:function(t){var e=t?"off":"on";DG.Browser.touch?DG.DomEvent[e](this._contentNode,"touchstart mousedown mousemove",this._onStart,this):DG.DomEvent[e](this._contentNode,"click",this._onClick,this),this._isBaronExist&&DG.DomEvent[e](this._scroller,"scroll",this._onScroll,this)},_toggleTouchEvents:function(t){var e=t?"off":"on";DG.DomEvent[e](this._contentNode,"touchmove",this._onMove,this)[e](this._contentNode,"touchend",this._onEnd,this)}})}(),DG.Map.include({_markerClass:"dg-customization__marker_type_mushroom",_markerShowClass:"dg-customization__marker_appear",_markerHideClass:"dg-customization__marker_disappear",_dgHideClass:"dg-popup_hidden_true",openPopup:function(t,e,i){if(!(t instanceof L.Popup)){var n=t;t=new L.Popup(i).setContent(n)}return e&&t.setLatLng(e),this.hasLayer(t)?this:(this.closePopup(),this._popup=t,t._source&&t._source._icon&&(-1!==t._source._icon.className.indexOf(this._markerClass)?(DG.DomUtil.removeClass(t._source._icon,this._markerShowClass),DG.DomUtil.addClass(t._source._icon,this._markerHideClass)):(DG.DomUtil.addClass(t._source._icon,this._dgHideClass),t._source._shadow&&DG.DomUtil.addClass(t._source._shadow,this._dgHideClass))),this.addLayer(t))},closePopup:function(t){return t&&t!==this._popup||(t=this._popup,this._popup=null),t&&(t._source&&t._source._icon&&(-1!==t._source._icon.className.indexOf(this._markerClass)?(DG.DomUtil.removeClass(t._source._icon,this._markerHideClass),DG.DomUtil.addClass(t._source._icon,this._markerShowClass)):(DG.DomUtil.removeClass(t._source._icon,this._dgHideClass),t._source._shadow&&DG.DomUtil.removeClass(t._source._shadow,this._dgHideClass))),this.removeLayer(t)),this}}),DG.Control.Zoom.include(DG.Locale),DG.Control.Zoom.Dictionary={},DG.Control.Zoom.include({options:{position:DG.Browser.touch?"bottomright":"topleft"},onAdd:function(t){var e="dg-zoom",i='<div class="dg-control-round__icon '+e+"__control "+e+"__button "+e+'__button_type_{type}"></div>',n=DG.DomUtil.create("div",e);return this._map=t,this._zoomInButton=this._createButton(DG.Util.template(i,{type:"in"}),this.t("zoom_in"),"dg-control-round "+e+"__in",n,this._zoomIn,this),this._zoomOutButton=this._createButton(DG.Util.template(i,{type:"out"}),this.t("zoom_out"),"dg-control-round "+e+"__out",n,this._zoomOut,this),this._eventListeners={},this._eventListeners.zoomend=this._eventListeners.zoomlevelschange=this._updateDisabled,this._updateDisabled(),t.on(this._eventListeners,this),n},onRemove:function(t){t.off(this._eventListeners,this)},_renderTranslation:function(){this._zoomInButton.title=this.t("zoom_in"),this._zoomOutButton.title=this.t("zoom_out")}}),DG.Control.Zoom.Dictionary.ru={zoom_in:"",zoom_out:""},DG.Control.Zoom.Dictionary.it={zoom_in:"Zoom avanti",zoom_out:"Zoom indietro"},DG.Control.Zoom.Dictionary.cs={zoom_in:"Piblit",zoom_out:"Oddlit"},DG.Control.Zoom.Dictionary.en={zoom_in:"Zoom in",zoom_out:"Zoom out"},DG.Control.Zoom.Dictionary.sp={zoom_in:"Acercar",zoom_out:"Alejar"},function(root){function Context(t,e,i,n){this.stack=t,this.global=e,this.blocks=i,this.templateName=n}function Stack(t,e,i,n){this.tail=e,this.isObject=t&&"object"==typeof t,this.head=t,this.index=i,this.of=n}function Stub(t){this.head=new Chunk(this),this.callback=t,this.out=""}function Stream(){this.head=new Chunk(this)}function Chunk(t,e,i){this.root=t,this.next=e,this.data=[],this.flushable=!1,this.taps=i}function Tap(t,e){this.head=t,this.tail=e}var dust={},NONE="NONE",ERROR="ERROR",WARN="WARN",INFO="INFO",DEBUG="DEBUG",loggingLevels=[DEBUG,INFO,WARN,ERROR,NONE],EMPTY_FUNC=function(){},logger=EMPTY_FUNC,loggerContext=this;dust.debugLevel=NONE,dust.silenceErrors=!1,root&&root.console&&root.console.log&&(logger=root.console.log,loggerContext=root.console),dust.log=function(t,e){if(dust.isDebug&&dust.debugLevel===NONE&&(logger.call(loggerContext,'[!!!DEPRECATION WARNING!!!]: dust.isDebug is deprecated.  Set dust.debugLevel instead to the level of logging you want ["debug","info","warn","error","none"]'),dust.debugLevel=INFO),e=e||INFO,loggingLevels.indexOf(e)>=loggingLevels.indexOf(dust.debugLevel)&&(dust.logQueue||(dust.logQueue=[]),dust.logQueue.push({message:t,type:e}),logger.call(loggerContext,"[DUST "+e+"]: "+t)),!dust.silenceErrors&&e===ERROR)throw"string"==typeof t?new Error(t):t},dust.onError=function(t,e){if(logger.call(loggerContext,"[!!!DEPRECATION WARNING!!!]: dust.onError will no longer return a chunk object."),dust.log(t.message||t,ERROR),dust.silenceErrors)return e;throw t},dust.helpers={},dust.cache={},dust.register=function(t,e){t&&(dust.cache[t]=e)},dust.render=function(t,e,i){var n=new Stub(i).head;try{dust.load(t,n,Context.wrap(e,t)).end()}catch(o){dust.log(o,ERROR)}},dust.stream=function(t,e){var i=new Stream;return dust.nextTick(function(){try{dust.load(t,i.head,Context.wrap(e,t)).end()}catch(n){dust.log(n,ERROR)}}),i},dust.renderSource=function(t,e,i){return dust.compileFn(t)(e,i)},dust.compileFn=function(t,e){e=e||null;var i=dust.loadSource(dust.compile(t,e));return function(t,n){var o=n?new Stub(n):new Stream;return dust.nextTick(function(){"function"==typeof i?i(o.head,Context.wrap(t,e)).end():dust.log(new Error("Template ["+e+"] cannot be resolved to a Dust function"),ERROR)}),o}},dust.load=function(t,e,i){var n=dust.cache[t];return n?n(e,i):dust.onLoad?e.map(function(e){dust.onLoad(t,function(n,o){return n?e.setError(n):(dust.cache[t]||dust.loadSource(dust.compile(o,t)),void dust.cache[t](e,i).end())})}):e.setError(new Error("Template Not Found: "+t))},dust.loadSource=function(source,path){return eval(source)},dust.isArray=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},dust.nextTick=function(){return function(t){setTimeout(t,0)}}(),dust.isEmpty=function(t){return dust.isArray(t)&&!t.length?!0:0===t?!1:!t},dust.filter=function(t,e,i){if(i)for(var n=0,o=i.length;o>n;n++){var r=i[n];"s"===r?(e=null,dust.log("Using unescape filter on ["+t+"]",DEBUG)):"function"==typeof dust.filters[r]?t=dust.filters[r](t):dust.log(new Error("Invalid filter ["+r+"]"),ERROR)}return e&&(t=dust.filters[e](t)),t},dust.filters={h:function(t){return dust.escapeHtml(t)},j:function(t){return dust.escapeJs(t)},u:encodeURI,uc:encodeURIComponent,js:function(t){return JSON?JSON.stringify(t):(dust.log("JSON is undefined.  JSON stringify has not been used on ["+t+"]",WARN),t)},jp:function(t){return JSON?JSON.parse(t):(dust.log("JSON is undefined.  JSON parse has not been used on ["+t+"]",WARN),t)}},dust.makeBase=function(t){return new Context(new Stack,t)},Context.wrap=function(t,e){return t instanceof Context?t:new Context(new Stack(t),{},null,e)},Context.prototype.get=function(t,e){return"string"==typeof t&&("."===t[0]&&(e=!0,t=t.substr(1)),t=t.split(".")),this._get(e,t)},Context.prototype._get=function(t,e){var i,n,o,r,s=this.stack,a=1;if(dust.log("Searching for reference [{"+e.join(".")+"}] in template ["+this.getTemplateName()+"]",DEBUG),n=e[0],o=e.length,t&&0===o)r=s,s=s.head;else{if(t)s=s.head[n];else{for(;s&&(!s.isObject||(r=s.head,i=s.head[n],i===undefined));)s=s.tail;s=i!==undefined?i:this.global?this.global[n]:undefined}for(;s&&o>a;)r=s,s=s[e[a]],a++}if("function"==typeof s){var l=function(){try{return s.apply(r,arguments)}catch(t){return dust.log(t,ERROR)}};return l.isFunction=!0,l}return s===undefined&&dust.log("Cannot find the value for reference [{"+e.join(".")+"}] in template ["+this.getTemplateName()+"]"),s},Context.prototype.getPath=function(t,e){return this._get(t,e)},Context.prototype.push=function(t,e,i){return new Context(new Stack(t,this.stack,e,i),this.global,this.blocks,this.getTemplateName())},Context.prototype.rebase=function(t){return new Context(new Stack(t),this.global,this.blocks,this.getTemplateName())},Context.prototype.current=function(){return this.stack.head},Context.prototype.getBlock=function(t){if("function"==typeof t){var e=new Chunk;t=t(e,this).data.join("")}var i=this.blocks;if(!i)return void dust.log("No blocks for context[{"+t+"}] in template ["+this.getTemplateName()+"]",DEBUG);for(var n,o=i.length;o--;)if(n=i[o][t])return n},Context.prototype.shiftBlocks=function(t){var e,i=this.blocks;return t?(e=i?i.concat([t]):[t],new Context(this.stack,this.global,e,this.getTemplateName())):this},Context.prototype.getTemplateName=function(){return this.templateName},Stub.prototype.flush=function(){for(var t=this.head;t;){if(!t.flushable)return t.error?(this.callback(t.error),dust.log(new Error("Chunk error ["+t.error+"] thrown. Ceasing to render this template."),ERROR),void(this.flush=EMPTY_FUNC)):void 0;this.out+=t.data.join(""),t=t.next,this.head=t}this.callback(null,this.out)},Stream.prototype.flush=function(){for(var t=this.head;t;){if(!t.flushable)return t.error?(this.emit("error",t.error),dust.log(new Error("Chunk error ["+t.error+"] thrown. Ceasing to render this template."),ERROR),void(this.flush=EMPTY_FUNC)):void 0;this.emit("data",t.data.join("")),t=t.next,this.head=t}this.emit("end")},Stream.prototype.emit=function(t,e){if(!this.events)return dust.log("No events to emit",INFO),!1;var i=this.events[t];if(!i)return dust.log("Event type ["+t+"] does not exist",WARN),!1;if("function"==typeof i)i(e);else if(dust.isArray(i))for(var n=i.slice(0),o=0,r=n.length;r>o;o++)n[o](e);else dust.log(new Error("Event Handler ["+i+"] is not of a type that is handled by emit"),ERROR)},Stream.prototype.on=function(t,e){return this.events||(this.events={}),this.events[t]?"function"==typeof this.events[t]?this.events[t]=[this.events[t],e]:this.events[t].push(e):(dust.log("Event type ["+t+"] does not exist. Using just the specified callback.",WARN),e?this.events[t]=e:dust.log("Callback for type ["+t+"] does not exist. Listener not registered.",WARN)),this},Stream.prototype.pipe=function(t){return this.on("data",function(e){try{t.write(e,"utf8")}catch(i){dust.log(i,ERROR)}}).on("end",function(){try{return t.end()}catch(e){dust.log(e,ERROR)}}).on("error",function(e){t.error(e)}),this},Chunk.prototype.write=function(t){var e=this.taps;return e&&(t=e.go(t)),this.data.push(t),this},Chunk.prototype.end=function(t){return t&&this.write(t),this.flushable=!0,this.root.flush(),this},Chunk.prototype.map=function(t){var e=new Chunk(this.root,this.next,this.taps),i=new Chunk(this.root,e,this.taps);return this.next=i,this.flushable=!0,t(i),e},Chunk.prototype.tap=function(t){var e=this.taps;return this.taps=e?e.push(t):new Tap(t),this},Chunk.prototype.untap=function(){return this.taps=this.taps.tail,this},Chunk.prototype.render=function(t,e){return t(this,e)},Chunk.prototype.reference=function(t,e,i,n){return"function"==typeof t&&(t.isFunction=!0,t=t.apply(e.current(),[this,e,null,{auto:i,filters:n}]),t instanceof Chunk)?t:dust.isEmpty(t)?this:this.write(dust.filter(t,i,n))},Chunk.prototype.section=function(t,e,i,n){if("function"==typeof t&&(t=t.apply(e.current(),[this,e,i,n]),t instanceof Chunk))return t;var o=i.block,r=i["else"];if(n&&(e=e.push(n)),dust.isArray(t)){if(o){var s=t.length,a=this;if(s>0){e.stack.head&&(e.stack.head.$len=s);for(var l=0;s>l;l++)e.stack.head&&(e.stack.head.$idx=l),a=o(a,e.push(t[l],l,s));return e.stack.head&&(e.stack.head.$idx=undefined,e.stack.head.$len=undefined),a}if(r)return r(this,e)}}else if(t===!0){if(o)return o(this,e)}else if(t||0===t){if(o)return o(this,e.push(t))}else if(r)return r(this,e);return dust.log("Not rendering section (#) block in template ["+e.getTemplateName()+"], because above key was not found",DEBUG),this},Chunk.prototype.exists=function(t,e,i){var n=i.block,o=i["else"];if(dust.isEmpty(t)){if(o)return o(this,e)}else if(n)return n(this,e);return dust.log("Not rendering exists (?) block in template ["+e.getTemplateName()+"], because above key was not found",DEBUG),this},Chunk.prototype.notexists=function(t,e,i){var n=i.block,o=i["else"];if(dust.isEmpty(t)){if(n)return n(this,e)}else if(o)return o(this,e);return dust.log("Not rendering not exists (^) block check in template ["+e.getTemplateName()+"], because above key was found",DEBUG),this},Chunk.prototype.block=function(t,e,i){var n=i.block;return t&&(n=t),n?n(this,e):this},Chunk.prototype.partial=function(t,e,i){var n;n=dust.makeBase(e.global),n.blocks=e.blocks,e.stack&&e.stack.tail&&(n.stack=e.stack.tail),i&&(n=n.push(i)),"string"==typeof t&&(n.templateName=t),n=n.push(e.stack.head);var o;return o="function"==typeof t?this.capture(t,n,function(t,e){n.templateName=n.templateName||t,dust.load(t,e,n).end()}):dust.load(t,this,n)},Chunk.prototype.helper=function(t,e,i,n){var o=this;try{return dust.helpers[t]?dust.helpers[t](o,e,i,n):(dust.log(new Error("Invalid helper ["+t+"]"),ERROR),o)}catch(r){return dust.log(r,ERROR),o}},Chunk.prototype.capture=function(t,e,i){return this.map(function(n){var o=new Stub(function(t,e){t?n.setError(t):i(e,n)});t(o.head,e).end()})},Chunk.prototype.setError=function(t){return this.error=t,this.root.flush(),this},Tap.prototype.push=function(t){return new Tap(t,this)},Tap.prototype.go=function(t){for(var e=this;e;)t=e.head(t),e=e.tail;return t};var HCHARS=new RegExp(/[&<>\"\']/),AMP=/&/g,LT=/</g,GT=/>/g,QUOT=/\"/g,SQUOT=/\'/g;dust.escapeHtml=function(t){return"string"==typeof t&&HCHARS.test(t)?t.replace(AMP,"&amp;").replace(LT,"&lt;").replace(GT,"&gt;").replace(QUOT,"&quot;").replace(SQUOT,"&#39;"):t};var BS=/\\/g,FS=/\//g,CR=/\r/g,LS=/\u2028/g,PS=/\u2029/g,NL=/\n/g,LF=/\f/g,SQ=/'/g,DQ=/"/g,TB=/\t/g;dust.escapeJs=function(t){return"string"==typeof t?t.replace(BS,"\\\\").replace(FS,"\\/").replace(DQ,'\\"').replace(SQ,"\\'").replace(CR,"\\r").replace(LS,"\\u2028").replace(PS,"\\u2029").replace(NL,"\\n").replace(LF,"\\f").replace(TB,"\\t"):t},"object"==typeof exports?module.exports=dust:root.dust=dust}(this),function(dust){function isSelect(t){var e=t.current();return"object"==typeof e&&e.isSelect===!0}function jsonFilter(t,e){return"function"==typeof e?e.toString().replace(/(^\s+|\s+$)/gm,"").replace(/\n/gm,"").replace(/,\s*/gm,", ").replace(/\)\{/gm,") {"):e}function filter(t,e,i,n,o){n=n||{};var r,s,a=i.block,l=n.filterOpType||"";if("undefined"!=typeof n.key)r=dust.helpers.tap(n.key,t,e);else{if(!isSelect(e))return _console.log("No key specified for filter in:"+l+" helper "),t;r=e.current().selectKey,e.current().isResolved&&(o=function(){return!1})}return s=dust.helpers.tap(n.value,t,e),o(coerce(s,n.type,e),coerce(r,n.type,e))?(isSelect(e)&&(e.current().isResolved=!0),a?t.render(a,e):(_console.log("Missing body block in the "+l+" helper "),t)):i["else"]?t.render(i["else"],e):t}function coerce(t,e,i){if(t)switch(e||typeof t){case"number":return+t;case"string":return String(t);case"boolean":return t="false"===t?!1:t,Boolean(t);case"date":return new Date(t);case"context":return i.get(t)}return t}var _console="undefined"!=typeof console?console:{log:function(){}},helpers={tap:function(t,e,i){var n=t;return"function"==typeof t&&(t.isFunction===!0?n=t():(n="",e.tap(function(t){return n+=t,""}).render(t,i).untap(),""===n&&(n=!1))),n},sep:function(t,e,i){var n=i.block;return e.stack.index===e.stack.of-1?t:n?i.block(t,e):t},idx:function(t,e,i){var n=i.block;return n?i.block(t,e.push(e.stack.index)):t},contextDump:function(t,e,i,n){var o,r=n||{},s=r.to||"output",a=r.key||"current";return s=dust.helpers.tap(s,t,e),a=dust.helpers.tap(a,t,e),o="full"===a?JSON.stringify(e.stack,jsonFilter,2):JSON.stringify(e.stack.head,jsonFilter,2),"console"===s?(_console.log(o),t):t.write(o)},"if":function(chunk,context,bodies,params){var body=bodies.block,skip=bodies["else"];if(params&&params.cond){var cond=params.cond;if(cond=dust.helpers.tap(cond,chunk,context),eval(cond))return body?chunk.render(bodies.block,context):(_console.log("Missing body block in the if helper!"),chunk);if(skip)return chunk.render(bodies["else"],context)
}else _console.log("No condition given in the if helper!");return chunk},math:function(t,e,i,n){if(n&&"undefined"!=typeof n.key&&n.method){var o=n.key,r=n.method,s=n.operand,a=n.round,l=null;switch(o=dust.helpers.tap(o,t,e),s=dust.helpers.tap(s,t,e),r){case"mod":(0===s||s===-0)&&_console.log("operand for divide operation is 0/-0: expect Nan!"),l=parseFloat(o)%parseFloat(s);break;case"add":l=parseFloat(o)+parseFloat(s);break;case"subtract":l=parseFloat(o)-parseFloat(s);break;case"multiply":l=parseFloat(o)*parseFloat(s);break;case"divide":(0===s||s===-0)&&_console.log("operand for divide operation is 0/-0: expect Nan/Infinity!"),l=parseFloat(o)/parseFloat(s);break;case"ceil":l=Math.ceil(parseFloat(o));break;case"floor":l=Math.floor(parseFloat(o));break;case"round":l=Math.round(parseFloat(o));break;case"abs":l=Math.abs(parseFloat(o));break;default:_console.log("method passed is not supported")}return null!==l?(a&&(l=Math.round(l)),i&&i.block?t.render(i.block,e.push({isSelect:!0,isResolved:!1,selectKey:l})):t.write(l)):t}return _console.log("Key is a required parameter for math helper along with method/operand!"),t},select:function(t,e,i,n){var o=i.block;if(n&&"undefined"!=typeof n.key){var r=dust.helpers.tap(n.key,t,e);return o?t.render(i.block,e.push({isSelect:!0,isResolved:!1,selectKey:r})):(_console.log("Missing body block in the select helper "),t)}return _console.log("No key given in the select helper!"),t},eq:function(t,e,i,n){return n&&(n.filterOpType="eq"),filter(t,e,i,n,function(t,e){return e===t})},ne:function(t,e,i,n){return n?(n.filterOpType="ne",filter(t,e,i,n,function(t,e){return e!==t})):t},lt:function(t,e,i,n){return n?(n.filterOpType="lt",filter(t,e,i,n,function(t,e){return t>e})):void 0},lte:function(t,e,i,n){return n?(n.filterOpType="lte",filter(t,e,i,n,function(t,e){return t>=e})):t},gt:function(t,e,i,n){return n?(n.filterOpType="gt",filter(t,e,i,n,function(t,e){return e>t})):t},gte:function(t,e,i,n){return n?(n.filterOpType="gte",filter(t,e,i,n,function(t,e){return e>=t})):t},"default":function(t,e,i,n){return n&&(n.filterOpType="default"),filter(t,e,i,n,function(){return!0})},size:function(t,e,i,n){var o,r,s,a=0;if(n=n||{},o=n.key,o&&o!==!0)if(dust.isArray(o))a=o.length;else if(!isNaN(parseFloat(o))&&isFinite(o))a=o;else if("object"==typeof o){r=0;for(s in o)Object.hasOwnProperty.call(o,s)&&r++;a=r}else a=(o+"").length;else a=0;return t.write(a)}};dust.helpers=helpers}("undefined"!=typeof exports?module.exports=require("dustjs-linkedin"):dust),DG.dust=function(t){return function(e,i){dust.cache[e]||dust.loadSource(t[e]);var n;return dust.render(e,i,function(t,e){n=e}),n}},DG.debug&&(dust.debugLevel="ERROR"),DG.Control.Attribution.include(DG.Locale),DG.Control.Attribution.Dictionary={},DG.Control.Attribution.include({options:{position:"bottomright"},onAdd:function(t){return t._copyright||(t._copyright=!0,this._first=!0),this._onAdd.call(this,t)},_update:function(t,e){if(this._map){"undefined"!=typeof e&&(this._osm=e);var i=[];for(var n in this._attributions)this._attributions[n]&&i.push(n);var o=[],r="";this._first&&(r=this._getAttributionHTML(t)),this.options.prefix&&o.push(this.options.prefix),i.length&&o.push(i.join(", ")),this._container.innerHTML=r+o.join(" | ")}},_tmpl:DG.dust({copyright:'(function(){dust.register("copyright",body_0);function body_0(chk,ctx){return chk.write("<div class=\\"dg-attribution__copyright\\"><ul class=\\"dg-attribution__links\\"><li>").exists(ctx.get(["osm"], false),ctx,{"block":body_1},null).write("<a href=\\"").reference(ctx.get(["copyright_apilink"], false),ctx,"h").write("\\" target=\\"_blank\\" class=\\"dg-attribution__link\\">").notexists(ctx.get(["osm"], false),ctx,{"block":body_2},null).reference(ctx.get(["API_2GIS"], false),ctx,"h").write("</a></li><li><a href=\\"").reference(ctx.get(["copyright_license"], false),ctx,"h").write("\\" target=\\"_blank\\" class=\\"dg-attribution__link\\">").reference(ctx.get(["license_agreement"], false),ctx,"h").write("</a></li></ul><a href=\\"").reference(ctx.get(["copyright_logo"], false),ctx,"h").write("\\" target=\\"_blank\\" class=\\"dg-attribution__logo_url\\"></a></div>");}function body_1(chk,ctx){return chk.write(" <a href=\\"http://www.openstreetmap.org/copyright\\" target=\\"_blank\\" class=\\"dg-attribution__link\\">OpenStreetMap contributors</a>, ");}function body_2(chk,ctx){return chk.reference(ctx.get(["work_on"], false),ctx,"h").write(" ");}return body_0;})();'}),_onAdd:DG.Control.Attribution.prototype.onAdd,_getData:function(t){return{osm:this._osm,work_on:this.t("work_on"),lang:t||this._map.getLang(),copyright_apilink:this.t("copyright_apilink"),copyright_license:this.t("copyright_license"),license_agreement:this.t("license_agreement"),copyright_logo:this.t("copyright_logo"),API_2GIS:this.t("API_2GIS")}},_getAttributionHTML:function(t){return this._tmpl("copyright",this._getData(t))},_renderTranslation:function(t){this._update(t.lang)}}),DG.Map.addInitHook(function(){this._copyright||DG.control.attribution().addTo(this)}),DG.Control.Attribution.Dictionary.ru={copyright_logo:"http://info.2gis.ru/?utm_source=copyright&utm_medium=map&utm_campaign=partners",copyright_apilink:"http://api.2gis.ru/?utm_source=copyright&utm_medium=map&utm_campaign=partners",copyright_license:"http://help.2gis.ru/licensing-agreement/",license_agreement:" ",work_on:" ",API_2GIS:"API 2"},DG.Control.Attribution.Dictionary.it={copyright_logo:"http://2gis.it/?utm_source=copyright&utm_medium=map&utm_campaign=partners",copyright_apilink:"http://2gis.it/?utm_source=copyright&utm_medium=map&utm_campaign=partners",copyright_license:"http://2gis.it/",license_agreement:"Accordo di licenza",work_on:" ",API_2GIS:"2GIS API"},DG.Control.Attribution.Dictionary.cs={copyright_logo:"http://praha.2gis.cz/?utm_source=copyright&utm_medium=map&utm_campaign=partners",copyright_apilink:"http://praha.2gis.cz/?utm_source=copyright&utm_medium=map&utm_campaign=partners",copyright_license:"http://law.2gis.cz/licensing-agreement/",license_agreement:"Licenn smlouva",work_on:"Pracuje na",API_2GIS:"API 2GIS"},DG.Control.Attribution.Dictionary.en={copyright_logo:"http://limassol.2gis.com.cy/?utm_source=copyright&utm_medium=map&utm_campaign=partners",copyright_apilink:"http://limassol.2gis.com.cy/?utm_source=copyright&utm_medium=map&utm_campaign=partners",copyright_license:"http://limassol.2gis.com.cy/",license_agreement:"License agreement",work_on:"Uses",API_2GIS:"2GIS API"},DG.Control.Attribution.Dictionary.sp={copyright_logo:"http://santiago.2gis.cl/?utm_source=copyright&utm_medium=map&utm_campaign=partners",copyright_apilink:"http://santiago.2gis.cl/?utm_source=copyright&utm_medium=map&utm_campaign=partners",copyright_license:"http://law.2gis.cl/licensing-agreement/",license_agreement:"Acuerdo de licencia",work_on:" ",API_2GIS:"2GIS API"},DG.Control.Location=DG.RoundControl.extend({statics:{Dictionary:{}},options:{iconClass:"locate",position:DG.Browser.touch?"bottomright":"topleft",drawCircle:!0,follow:!0,stopFollowingOnDrag:!1,metric:!0,onLocationError:function(){},onLocationOutsideMapBounds:function(){},locateOptions:{}},initialize:function(t){return DG.Util.setOptions(this,t),navigator.geolocation?(this._event=undefined,this._locateOptions={watch:!0,setView:!1,maximumAge:1/0},DG.extend(this._locateOptions,this.options.locateOptions),this._resetVariables(),void this.on({click:this._handleLocate,add:this._initLocate})):void(this._disable=!0)},_initLocate:function(){this._layer=new DG.LayerGroup,this._layer.addTo(this._map),this._map.on({locationfound:this._onLocationFound,locationerror:this._onLocationError},this)},_handleLocate:function(){this._active&&this._event&&(this._map.getBounds().contains(this._event.latlng)||this._isOutsideMapBounds())?this._stopLocate():(this._locateOnNextLocationFound=!0,this._active||this._map.locate(this._locateOptions),this._active=!0,this.options.follow&&this._startFollowing(),this._clearError(),this._event?this._visualizeLocation():this.setState("requesting"))},_onLocationFound:function(t){this._event&&this._event.latlng.lat===t.latlng.lat&&this._event.latlng.lng===t.latlng.lng&&this._event.accuracy===t.accuracy||this._active&&(this._event=t,this.options.follow&&this._following&&(this._locateOnNextLocationFound=!0),this._visualizeLocation())},_startFollowing:function(){this._following=!0,this.options.stopFollowingOnDrag&&this._map.on("dragstart",this._stopFollowing)},_stopFollowing:function(){this._following=!1,this.options.stopFollowingOnDrag&&this._map.off("dragstart",this._stopFollowing),this._visualizeLocation()},_isOutsideMapBounds:function(){return this._event===undefined?!1:this._map.options.maxBounds&&!this._map.options.maxBounds.contains(this._event.latlng)},_visualizeLocation:function(){this._event.accuracy===undefined&&(this._event.accuracy=0);var t=this._event.accuracy;if(this._locateOnNextLocationFound){if(this._isOutsideMapBounds())this.options.onLocationOutsideMapBounds(this);else{this._map.setView(this._event.latlng,13);var e=this._map.projectDetector.getProject().maxZoom||13;this._map.setZoom(e)}this._locateOnNextLocationFound=!1}var i={color:"#FFF",fillColor:"#FFF",fillOpacity:.4,weight:0,opacity:.3};this.options.drawCircle&&(this._circle?this._circle.setLatLng(this._event.latlng).setRadius(t):this._circle=DG.circle(this._event.latlng,t,i).addTo(this._layer));var n,o;this.options.metric?(n=t.toFixed(0),o="meters"):(n=(3.2808399*t).toFixed(0),o="feet");var r="dg-location__pin";r+=this._following?" "+r+"state_following":"";var s={icon:DG.divIcon({className:r,iconSize:[20,20]})};this._marker?this._marker.setLatLng(this._event.latlng):this._marker=DG.marker(this._event.latlng,s).bindLabel(this.t("you_are_here")).addTo(this._layer),DG.DomEvent.on(this._marker,"click",function(){this._map.fireEvent("dgLocateClick")}),this._container&&this.setState("active")},_resetVariables:function(){this._active=!1,this._following=!1},_stopLocate:function(){this._map.stopLocate(),this._map.off("dragstart",this._stopFollowing),this.setState(),this._resetVariables(),this._layer.clearLayers(),this._marker=undefined,this._circle=undefined,this._event=undefined},_onLocationError:function(t){if(3!==t.code||!this._locateOptions.watch){this._stopLocate(),this._error=DG.DomUtil.create("div","dg-label dg-label_name_location-error",this._container),this._errorText=DG.DomUtil.create("div","dg-label__content",this._error),this._errorText.innerHTML=this.t("cant_find");var e=this;setTimeout(function(){e._clearError()},3e3),this.options.onLocationError(t)}},_clearError:function(){this._error&&(this._container.removeChild(this._error),this._error=undefined,this._errorText=undefined)},_renderTranslation:function(){this._link&&(this._link.title=this.t("button_title")),this._marker&&this._marker.bindLabel(this.t("you_are_here"))}}),DG.control.location=function(t){return new DG.Control.Location(t)},DG.Map.addInitHook(function(){this.options.locationControl&&(this.locationControl=DG.control.location(this.options.locationControl),this.addControl(this.locationControl))}),DG.Control.Location.Dictionary.ru={cant_find:"    ",you_are_here:" ",button_title:"   "},DG.Control.Location.Dictionary.it={cant_find:"Non siamo riusciti a localizzarti",you_are_here:"Voi siete qui",button_title:"Trova la tua posizione sulla mappa"},DG.Control.Location.Dictionary.cs={cant_find:"Nepodailo se nm urit Vai polohu",you_are_here:"Jste tady",button_title:"Urit Vai polohu na map"},DG.Control.Location.Dictionary.en={cant_find:"We can't find you",you_are_here:"You are here",button_title:"Show your location"},DG.Control.Location.Dictionary.sp={cant_find:"No pudimos encontrarte",you_are_here:"T ests aqu",button_title:"Encontrarte en el mapa"},DG.Screenfull=DG.Class.extend({_apiMap:[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],initialize:function(){this.api=this._api()},request:function(t){var e=this.api.requestFullscreen;t=t||document.documentElement,t[e](Element.ALLOW_KEYBOARD_INPUT)},exit:function(){document[this.api.exitFullscreen]()},isFullscreen:function(){return!!document[this.api.fullscreenElement]},_api:function(){var t={},e=this._apiMap;return e.forEach(function(i){i&&i[1]in document&&i.forEach(function(i,n){t[e[0][n]]=i})}),t.requestFullscreen?t:!1}}),DG.screenfull=new DG.Screenfull,(!DG.screenfull.api||DG.Browser.android&&DG.Browser.gecko||DG.Browser.safari51)&&(DG.Screenfull.include({_fullscreenClass:"DGFullScreen_legacy-mode",_fullscreenBodyClass:this._fullscreenClass+"-body",_api:function(){return{fullscreenchange:"keyup"}},_mapParams:["zIndex","position","left","top","border","marginTop","marginRight","marginBottom","marginLeft","paddingTop","paddingRight","paddingBottom","paddingLeft","previousSibling","width","height"],_documentParams:["marginTop","marginRight","marginBottom","marginLeft","paddingTop","paddingRight","paddingBottom","paddingLeft","overflow","scrollTop"],_initialDocumentParams:{},_initialMapParams:{},_initialDocumentElementParams:{},exit:function(t){DG.DomUtil.removeClass(t,this._fullscreenClass),DG.DomUtil.removeClass(document.body,this._fullscreenBodyClass),this._mapParams.forEach(function(e){t.style[e]=this._initialMapParams[e]},this),this._documentParams.forEach(function(t){document.body.style[t]=this._initialDocumentParams[t]},this),document.documentElement.scrollTop=this._initialDocumentElementParams.scrollTop},request:function(t){this._storePosition(t),DG.DomUtil.addClass(t,this._fullscreenClass),DG.DomUtil.addClass(document.body,this._fullscreenBodyClass),document.documentElement.scrollTop="0px"},_storePosition:function(t){this._mapParams.forEach(function(e){this._initialMapParams[e]=t.style[e]},this),this._documentParams.forEach(function(t){this._initialDocumentParams[t]=document.body.style[t]},this),this._initialDocumentElementParams.scrollTop=document.documentElement.scrollTop},_onFullScreenStateChange:function(t){t||(t=window.event),27===t.keyCode&&this._exitFullScreen()}}),DG.screenfull=new DG.Screenfull),DG.Control.Fullscreen=DG.RoundControl.extend({statics:{Dictionary:{}},options:{position:DG.Browser.touch?"bottomright":"topright",iconClass:"fullscreen"},initialize:function(t){DG.Util.setOptions(this,t),this._isFullscreen=!1,this.on("click",this._toggleFullscreen)},_toggleFullscreen:function(){this._isFullscreen?this._toggle(!1,"exit","on","cancelfullscreen"):this._toggle(!0,"request","on","requestfullscreen"),this._renderTranslation(),this._map.invalidateSize()},_renderTranslation:function(){this._link.title=this.t(this._isFullscreen?"title_min":"title_max")},_toggle:function(t,e,i,n){var o=this._map._container;this._isFullscreen=t,this.setState(t?"active":""),DG.screenfull[e](o),DG.DomEvent[i](document,DG.screenfull.api.fullscreenchange,this._onFullScreenStateChange,this),this._map.fire(n)},_onFullScreenStateChange:function(){!DG.screenfull.isFullscreen()&&this._toggle(!1,"exit","on","cancelfullscreen")}}),DG.control.fullscreen=function(t){return new DG.Control.Fullscreen(t)},DG.Map.mergeOptions({fullscreenControl:!0}),DG.Map.addInitHook(function(){this.options.fullscreenControl&&(this.fullscreenControl=DG.control.fullscreen(this.options.fullscreenControl),this.addControl(this.fullscreenControl))}),DG.Control.Fullscreen.Dictionary.ru={title_max:"",title_min:""},DG.Control.Fullscreen.Dictionary.it={title_max:"Espandi",title_min:"Ripristina"},DG.Control.Fullscreen.Dictionary.cs={title_max:"Rozbalit",title_min:"Obnovit"},DG.Control.Fullscreen.Dictionary.en={title_max:"Expand",title_min:"Restore"},DG.Control.Fullscreen.Dictionary.sp={title_max:"Maximizar",title_min:"Restaurar"},DG.Map.addInitHook(function(){this._tln="dgTiles",this.baseLayer=new(DG.TileLayer.extend({initialize:function(t,e){this._isDg=!0,DG.TileLayer.prototype.initialize.call(this,t,e)},onRemove:function(t){t.projectDetector.disable(),DG.TileLayer.prototype.onRemove.call(this,t)}}))("https://tile{s}.maps.2gis.com/tiles?x={x}&y={y}&z={z}&v=1",{subdomains:"0123",errorTileUrl:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEAAQMAAABmvDolAAAAA1BMVEX28t5R0k5UAAAAH0lEQVR4Xu3AAQkAAADCMPunNsdhWxwAAAAAAAAAwAEhAAABg2UP5AAAAABJRU5ErkJggg==",detectRetina:!0,maxNativeZoom:18}).addTo(this)}),DG.Meta={},DG.Meta.Layer=L.Layer.extend({options:{tileSize:256,minZoom:0,maxZoom:18,zoomOffset:0},initialize:function(t,e){DG.TileLayer.prototype.initialize.call(this,null,e),delete this._url,this._currentTile=!1,this._currentTileData=!1,this._hoveredObject=null,this._origin=DG.Meta.origin(t,{dataFilter:this.options.dataFilter})},getOrigin:function(){return this._origin},onAdd:function(t){this._reset(),DG.DomEvent.on(t.getPane("tilePane"),this._domEvents,this)},onRemove:function(t){DG.DomEvent.off(t.getPane("tilePane"),this._domEvents,this)},getEvents:function(){var t={viewreset:this._reset};return"click dblclick mousedown contextmenu".split(" ").forEach(function(e){t[e]=this._pipeMapEvent},this),t},_getZoomForUrl:DG.TileLayer.prototype._getZoomForUrl,_getTileSize:DG.TileLayer.prototype._getTileSize,_getTileNumBounds:DG.GridLayer.prototype._getTileNumBounds,_isValidTile:DG.GridLayer.prototype._isValidTile,_wrapCoords:DG.GridLayer.prototype._wrapCoords,_resetWrap:DG.GridLayer.prototype._resetWrap,_domEvents:{mousemove:function(t){var e,i,n,o=this._getTileSize(),r=this._map.mouseEventToLayerPoint(t),s=this._map.getPixelOrigin().add(r),a=s.divideBy(o).floor(),l=this._map.getZoom();l>this.options.maxZoom+this.options.zoomOffset||l<this.options.minZoom-this.options.zoomOffset||!this._isValidTile(a)||(this._wrapCoords(a),a.z=this._getZoomForUrl(),a.key=o,i=this._origin.getTileKey(a),i!==this._currentTile&&(this._currentTile=i,this._currentTileData=!1),this._currentTileData===!1?this._currentTileData=this._origin.getTileData(a):(e=DG.point(s.x%o,s.y%o),n=this._getHoveredObject(a,e),this._hoveredEntity!==n&&(this._hoveredEntity&&this._fireMouseEvent("mouseout",t),this._hoveredEntity=n,n&&this._fireMouseEvent("mouseover",t)),this._hoveredEntity&&this._fireMouseEvent("mousemove",t)))},mouseout:function(t){this._hoveredEntity&&(this._fireMouseEvent("mouseout",t),this._hoveredEntity=null),this._currentTile=!1}},_pipeMapEvent:function(t){this._hoveredEntity&&this.fire(t.type,DG.extend({},t,{meta:this._hoveredEntity}))},_fireMouseEvent:function(t,e){this.fire(t,{meta:this._hoveredEntity,latlng:this._map.mouseEventToLatLng(e)})},_getHoveredObject:function(t,e){for(var i=this._currentTileData.length-1;i>=0;i--)if(DG.PolyUtil.contains(e,this._currentTileData[i].geometry.coordinates[0]))return this._currentTileData[i];return null},_reset:function(){this._tileNumBounds=this._getTileNumBounds(),this._resetWrap(this._tileNumBounds)}}),DG.Meta.layer=function(t,e){return new DG.Meta.Layer(t,e)},DG.Meta.Origin=DG.Class.extend({options:{subdomains:"012345679",dataFilter:null},_url:!1,initialize:function(t,e){this._url=t,this._requests={},this._tileStorage={},this._dataStorage={},e=DG.setOptions(this,e),"string"==typeof e.subdomains&&(e.subdomains=e.subdomains.split(""))},getTileData:function(t){var e=this.getTileKey(t),i=this;return"undefined"==typeof this._tileStorage[e]&&"undefined"==typeof this._requests[e]&&(this._tileStorage[e]=!1,this._requests[e]=this._requestData(t).then(function(n){i.setTileData(e,i.options.dataFilter?i.options.dataFilter(n,t):n),delete i._requests[e]})),this._tileStorage[e].constructor===Object?Object.keys(this._tileStorage[e]).map(function(t){return DG.extend({geometry:this._tileStorage[e][t]},this._dataStorage[t])},this):this._tileStorage[e]},setTileData:function(t,e){return"string"!=typeof t&&(t=this.getTileKey(t)),e.forEach(function(e){e.geometry.constructor!==Object&&(e.geometry=DG.Wkt.toGeoJSON(e.geometry)),this._tileStorage[t]||(this._tileStorage[t]={}),this._tileStorage[t][e.id]=e.geometry,delete e.geometry,this._dataStorage[e.id]=e},this),this},flush:function(){return this._tileStorage={},this._dataStorage={},Object.keys(this._requests).forEach(function(t){this[t].abort&&this[t].abort()},this._requests),this},setURL:function(t,e){return this._url=t,e&&this.flush(),this},getTileKey:function(t){return[t.x,t.y,t.z,t.key].join(":")},_requestData:function(t){return this._url?this._performRequest(t):Promise.resolve([])},_performRequest:function(t){return DG.ajax(this._prepareURL(t),{type:"get",dataType:"json"})},_prepareURL:function(t){return DG.Util.template(this._url,{x:t.x,y:t.y,z:t.z,s:this._getSubdomain(t)})},_getSubdomain:DG.TileLayer.prototype._getSubdomain}),DG.Meta.origin=function(t,e){return new DG.Meta.Origin(t,e)},DG.PolyUtil.contains=function(t,e){for(var i,n=0,o=[],r=0,s=e.length;s>r;r++)o.push(DG.point(e[r]));i=this._getEdges(o);for(var r=0,s=i.length;s>r;r++)switch(this._getEdgeType(i[r],t)){case"TOUCHING":return!0;case"CROSSING":n=1-n}return n?!0:!1},DG.PolyUtil._getEdges=function(t){for(var e,i,n,o=[],r=0,s=t.length;s>r;r++)i=t[r],n=r!==s-1?t[r+1]:t[0],e={startPoint:i,endPoint:n},o.push(e);return o},DG.PolyUtil._getEdgeType=function(t,e){var i=this._classify(t,e);switch(i){case"LEFT":return t.startPoint.y<e.y&&e.y<=t.endPoint.y?"CROSSING":"INESSENTIAL";case"RIGHT":return t.endPoint.y<e.y&&e.y<=t.startPoint.y?"CROSSING":"INESSENTIAL";case"BETWEEN":case"ORIGIN":case"DESTINATION":return"TOUCHING";default:return"INESSENTIAL"}},DG.PolyUtil._classify=function(t,e){var i,n,o;return i={x:t.endPoint.x-t.startPoint.x,y:t.endPoint.y-t.startPoint.y},n={x:e.x-t.startPoint.x,y:e.y-t.startPoint.y},o=i.x*n.y-n.x*i.y,o>0?"LEFT":0>o?"RIGHT":i.x*n.x<0||i.y*n.y<0?"BEHIND":this._getLengthSquared(i)<this._getLengthSquared(n)?"BEYOND":DG.PolyUtil._areEquals(t.startPoint,e)?"ORIGIN":DG.PolyUtil._areEquals(t.endPoint,e)?"DESTINATION":"BETWEEN"},DG.PolyUtil._getLengthSquared=function(t){return Math.pow(t.x,2)+Math.pow(t.y,2)},DG.PolyUtil._areEquals=function(t,e){return t.x===e.x&&t.y===e.y},DG.Map.mergeOptions({poi:!DG.Browser.touch}),DG.Poi=DG.Handler.extend({options:{disableLabel:!1},statics:{metaURL:"http://tile{s}.maps.2gis.ru/?x={x}&y={y}&z={z}&v=1&type=poi"},initialize:function(t,e){this._map=t,DG.Util.setOptions(this,e),this._metaLayer=DG.Meta.layer(DG.Poi.metaURL,{minZoom:15,maxNativeZoom:18,detectRetina:!0,dataFilter:DG.bind(this._processData,this)})},addHooks:function(){this._map.addLayer(this._metaLayer),this.options.disableLabel||(this._labelHelper=DG.label(),this._metaLayer.on(this._layerEventsListeners,this))},removeHooks:function(){this._map.removeLayer(this._metaLayer),this.options.disableLabel||(this._metaLayer.off(this._layerEventsListeners,this),this._map.removeLayer(this._labelHelper),this._labelHelper=null)},getMetaLayer:function(){return this._metaLayer},_processData:function(t,e){var i=this._map,n=e.multiplyBy(this._metaLayer._getTileSize());return""===t.responseText?[]:t.result.poi.map(function(t){var e=DG.Wkt.toGeoJSON(t.hover);return e.coordinates[0]=e.coordinates[0].map(function(t){return i.project([t[1],t[0]]).round().subtract(n)}),{id:t.id,hint:t.links[0].name,linked:t.links[0],geometry:e}})},_layerEventsListeners:{mouseover:function(t){this._setCursor("pointer"),this._labelHelper.setPosition(t.latlng).setContent(t.meta.hint),this._map.addLayer(this._labelHelper)},mouseout:function(){this._setCursor("auto"),this._map.removeLayer(this._labelHelper)},mousemove:function(t){this._labelHelper.setPosition(t.latlng)}},_setCursor:function(t){this._map.getContainer().style.cursor=t}}),DG.Map.addInitHook("addHandler","poi",DG.Poi),DG.Entrance=DG.Layer.extend({options:{vectors:[]},statics:{SHOW_FROM_ZOOM:DG.Browser.svg?16:17},initialize:function(t){DG.setOptions(this,t)},onAdd:function(t){this._map=t,this._initArrows().addTo(t),this._eventHandler=new DG.Entrance.EventHandler(t,this),this._eventHandler.enable(),this._arrows.eachLayer(function(t){t.setStyle({visibility:"hidden"})}),this._isShown=!1},addTo:function(t){return t.addLayer(this),this},onRemove:function(){this._isShown=!1,this._removeArrows(),this._map=null,this._eventHandler.disable(),this._eventHandler=null,this._arrows=null},removeFrom:function(t){return t.removeLayer(this),this},show:function(t){return this._arrows?(t!==!1&&this._fitBounds(),this._isAllowedZoom()&&(this._arrows.eachLayer(function(t){t.setStyle({visibility:"visible"}),DG.Path.ANIMATION_AVAILABLE&&t.runAnimation("animateArrowPathGeom")}),this._isShown||(this._map.fire("entranceshow"),this._isShown=!0)),this):this},hide:function(){return this.isShown()&&this._arrows&&(this._arrows.eachLayer(function(t){t.setStyle({visibility:"hidden"})}),this._isShown=!1,this._map.fire("entrancehide")),this},isShown:function(){return this._isShown},getBounds:function(){return this._arrows.getBounds()},_initArrows:function(){return this._arrows=DG.featureGroup(),this.options.vectors.map(function(t){return DG.Wkt.toLatLngs(t)}).forEach(function(t){this._arrows.addLayer(DG.Entrance.arrow(t,this._getArrowStrokeOptions())),this._arrows.addLayer(DG.Entrance.arrow(t,this._getArrowOptions()))},this),this._arrows},_removeArrows:function(){this._map.removeLayer(this._arrows.clearLayers())},_getFitZoom:function(){return this._map.projectDetector.getProject().maxZoom||DG.Entrance.SHOW_FROM_ZOOM},_fitBounds:function(){var t,e=this._map,i=this.getBounds();e.getBounds().contains(i)&&this._isAllowedZoom()||(t=this._getFitZoom(),e.projectDetector.getProject()||e.once("moveend",function(){e.setZoom(this._getFitZoom())},this),e.setView(i.getCenter(),t,{animate:!0}))},_isAllowedZoom:function(){return!(this._map.getZoom()<DG.Entrance.SHOW_FROM_ZOOM)},_getArrowStrokeOptions:function(){return{clickable:!1,color:"#fff",weight:6,byZoom:{16:{marker:{viewBox:"0 0 24 24",refX:12,refY:12,markerHeight:24,markerWidth:24,path:{d:"M9.313,18.984c2.246-1.468,7.101-5.562,7.101-5.562c0.781-0.781,0.781-2.047,0-2.828c0,0-5.242-4.023-7.101-5.102C9.74,5.354,8.583,5.93,8.125,6.5C7.902,6.777,9,11.614,9,11.614v0.789c0,0-0.879,4.237-0.905,5.285C8.09,17.891,9.108,19.118,9.313,18.984z"}},lastPointOffset:2,vmlEndArrow:"none",weight:6},17:{marker:{viewBox:"0 0 24 24",refX:12,refY:12,markerHeight:24,markerWidth:24,path:{d:"M7.912,21.498c3.106-2.029,9.859-7.873,9.859-7.873c2.059-1.807,2.142-1.542,0.146-3.208c0,0-7.434-6.084-10.005-7.576C7.583,2.649,6.903,3.446,6.271,4.233c-0.308,0.384,2.209,6.051,2.209,6.051v3.388c0,0-2.215,4.583-2.25,6.03C6.222,19.986,7.629,21.684,7.912,21.498z"}},lastPointOffset:0,vmlEndArrow:"none",weight:7},18:{marker:{viewBox:"0 0 24 24",refX:12,refY:12,markerHeight:24,markerWidth:24,path:{d:"M7.61,22.688c4.045-2.642,11.312-8.906,11.312-8.906c1.92-1.781,1.938-2-0.124-3.781c0,0-8.151-6.334-11.5-8.276C6.87,1.475,5.516,2.62,5.732,3.093c2.146,4.694,2.063,4.741,2.612,7.469l0.016,2.75c0,0-1.573,5.458-2.619,7.958C5.599,21.611,7.241,22.93,7.61,22.688z"}},lastPointOffset:DG.Browser.vml?-2:-5,vmlEndArrow:"none",weight:8}}}},_getArrowOptions:function(){return{clickable:!1,color:"#0085a0",weight:3,byZoom:{16:{marker:{refX:12,refY:12,markerHeight:24,markerWidth:24,path:{d:"M11.068,13.011L9.5,17.285l6.379-5.169L9.313,7.19l1.717,3.824"}},lastPointOffset:2,weight:2},17:{marker:{refX:12,refY:12,markerHeight:24,markerWidth:24,path:{d:"M10.354,13.969l-2.184,5.18L16.993,12L7.912,5.188l2.38,4.781"}},lastPointOffset:0,weight:3},18:{marker:{refX:12,refY:12,markerHeight:24,markerWidth:24,path:{d:"M10.281,13.781L7.42,21.271l11.488-9.308L7.083,3.093L10.219,10"}},lastPointOffset:DG.Browser.vml?0:-5,weight:4}}}}}),DG.Path.ANIMATION_AVAILABLE=DG.Browser.svg&&!DG.Browser.mobileWebkit&&-1===navigator.userAgent.toLowerCase().indexOf("presto")&&"[object Function]"===Object.prototype.toString.call(DG.SVG.create("animate").beginElement),DG.Path.include(DG.Path.ANIMATION_AVAILABLE?{runAnimation:function(){var t=this._animationEl=this._addAnimation();return t&&(t.beginElement(),this._removeAnimation(t)),this},stopAnimation:function(t){return this.animations[t]&&this.animations[t].endElement(),this},_addAnimation:function(){var t=this.options.animation,e=this._rings[0],i=null;return t&&e.length>0&&(i=DG.SVG.create("animate"),t.getValues&&(t.values=t.getValues(e)),Object.keys(t).filter(function(e){return"[object Function]"!=={}.toString.call(t[e])}).forEach(function(e){i.setAttribute(e,t[e])}),this._path.appendChild(i)),i},_removeAnimation:function(t){this._map.once("zoomstart",function(){t&&this._path.removeChild(t),this._animationEl=null},this)}}:{}),DG.Entrance.Arrow=DG.Polyline.extend({initialize:function(t,e){this._setLatLngs(t);var e=e||{};DG.Path.ANIMATION_AVAILABLE&&(e.animation=this.getArrowAnimation(this._convertLatLngs(t))),this._markers=[],L.setOptions(this,e)},onAdd:function(t){var e=this._renderer=t.getArrowRenderer();e._initPath(this),this._project(),this._update(),this._updateStyleByZoom(),e._addPath(this),e._initMarkers(this)},onRemove:function(t){DG.Polyline.prototype.onRemove.call(this,t),this._renderer._removeMarkers(this)},getEvents:function(){return{viewreset:this._project,move:this._update,zoomend:this._updateStyleByZoom}},_projectLatlngs:function(t,e){DG.Polyline.prototype._projectLatlngs.call(this,t,e),this._offsetLastPathPoint()},_update:function(){DG.Polyline.prototype._update.call(this),this._renderer._updateMarker(this)},_updateStyleByZoom:function(){var t=this.options.byZoom,e=this._map.getZoom();this.setStyle(t[e])},_offsetLastPathPoint:function(){var t,e,i={},n=this._rings[0],o=n.length,r=this.options.byZoom[this._map.getZoom()],s=n[o-1],a=n[o-2],l=s.distanceTo(a);r&&(t=Math.abs(100*r.lastPointOffset/l),e={x:n[o-1].x-n[o-2].x,y:n[o-1].y-n[o-2].y},i.x=Math.round(e.x*t/100),i.y=Math.round(e.y*t/100),r.lastPointOffset>0?(n[o-1].x+=i.x,n[o-1].y+=i.y):(n[o-1].x-=i.x,n[o-1].y-=i.y))}}),DG.Entrance.arrow=function(t,e){return new DG.Entrance.Arrow(t,e)},DG.Entrance.Arrow.SVG=DG.SVG.extend({getEvents:function(){var t={move:this._update};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),DG.Browser.ie&&(t.moveend=t.mousemove=t.zoomend=this._refresh),t},_initMarkers:function(t){var e,i,n=t.options.byZoom,o=t._markerId="arrow-marker-"+DG.Util.stamp(t);Object.keys(n).map(function(r){e=DG.SVG.create("marker"),i=n[r].marker,Object.keys(i).filter(function(t){return"polygon"!==t&&"path"!==t}).forEach(function(t){e.setAttribute(t,i[t])}),e.id=o+"-"+r,e.setAttribute("orient","auto"),e.setAttribute("markerUnits","userSpaceOnUse"),e.setAttribute("stroke-width","0"),i.path&&e.appendChild(this._getMarkerChild("path",i.path,t)),i.polygon&&e.appendChild(this._getMarkerChild("polygon",i.polygon,t)),t._markers.push(e),this._getDefs().appendChild(e)},this),this._updateMarker(t)},_getMarkerChild:function(t,e,i){var n=DG.SVG.create("path"),o="path"===t?"d":"points";return n.setAttribute(o,e[o]),n.setAttribute("fill",e.color?e.color:i.options.color),n},_getDefs:function(){return this._defs=this._defs||DG.SVG.create("defs"),this._defs.parentNode||this._container.appendChild(this._defs),this._defs},_updateMarker:function(t){var e=t._map.getZoom(),i=t._map.getBounds(),n=t._latlngs[t._latlngs.length-1],o=e>=DG.Entrance.SHOW_FROM_ZOOM&&i.contains(n)?t._markerId+"-"+e:"";t._path.setAttribute("marker-end","url(#"+o+")")},_removeMarkers:function(t){var e=this._getDefs(),i=t._markers;(e||i)&&(i.forEach(function(t){e.removeChild(t)}),i.length=0)},_refresh:function(){this._container.parentNode.insertBefore(this._container,this._container)},_updateStyle:function(t){var e=t._path,i=t.options;DG.SVG.prototype._updateStyle.call(this,t),e.setAttribute("visibility",i.visibility),t._markers.forEach(function(t){t.setAttribute("fill-opacity",i.opacity)}),this._updateMarker(t)}}),L.Map.include({getArrowRenderer:function(){var t=this._arrowRenderer;
return t||(t=this._arrowRenderer=new DG.Entrance.Arrow.SVG),!this.hasLayer(t)&&this.addLayer(t),t}}),DG.Entrance.Arrow.SVG.include(L.Browser.vml?{_initMarkers:function(t){t._markers=L.SVG.create("stroke"),this._updateMarker(t),t._container.appendChild(t._markers)},_updateMarker:function(t){var e=t.options.byZoom[t._map.getZoom()];t._markers.endarrow=e&&e.vmlEndArrow?e.vmlEndArrow:"classic"},_removeMarkers:function(t){t._container.removeChild(t._markers)},_updateStyle:function(t){var e=t.options,i=t._container;DG.SVG.prototype._updateStyle.call(this,t),e.visibility&&(i.style.visibility=e.visibility)}}:{}),DG.Browser.svg&&DG.Entrance.Arrow.include({getArrowAnimation:function(t){var e={id:"animateArrowPathGeom",attributeName:"d",fill:"freeze",begin:"indefinite"};return e.getValues=this._getAnimationValues(t.length),e.keyTimes=this._getAnimateTiming(t),e.dur=this._getAnimationTime(t.length),e},_getAnimationValues:function(t){return 2===t?this._getShakeAnimationValues:this._getSlideAnimationValues},_getSlideAnimationValues:function(t){var e="",i="",n="",o="M "+t[0].x+" "+t[0].y,r="l -1 0";e=o+" "+r+"; ";for(var s=1;s<t.length;s++){if(n+=t[s].x-t[s-1].x+" "+(t[s].y-t[s-1].y),s===t.length-1){n=t[s].x-t[s-1].x+" "+(t[s].y-t[s-1].y),e+=o+" l "+i+n+";";break}e+=o+" l "+n+"; ",e+=o+" l "+n+" "+r+"; ",n+=" l ",i+=t[s].x-t[s-1].x+" "+(t[s].y-t[s-1].y)+" l "}return e},_getShakeAnimationValues:function(t){var e,i,n=[1,.4,1,.84,1,.94,1],o=t[1].x-t[0].x,r=t[1].y-t[0].y,s=" l "+o+" "+r;return e=t[0].x-o,i=t[0].y-r,n.reduce(function(t,n){return t+" M "+(e+o*n)+" "+(i+r*n)+s+";"},"M "+e+" "+i+s+"; ")},_getPolylineLength:function(t){for(var e=0,i=1;i<t.length;i++)e+=t[i-1].distanceTo(t[i]);return e},_getAnimateTiming:function(t){var e,i,n,o=[0],r=this._getPolylineLength(t);if(2===t.length)e="0; 0.33; 0.495; 0.66; 0.77; 0.88; 0.935; 1";else if(3===t.length)e="0; 0.33; 0.34; 1";else if(4===t.length)e="0; 0.25; 0.26; 0.5; 0.51; 1";else{for(var s=1;s<t.length;s++)n=t[s-1].distanceTo(t[s]),i=n/r,o.push(o[o.length-1]+i),s<t.length-1?o.push(o[o.length-1]):o[o.length-1]=1;e=o.join("; ")}return e},_getAnimationTime:function(t){return 2===t?"0.7s":3===t||4===t?"0.5s":"0.7s"}}),DG.Entrance.EventHandler=DG.Handler.extend({initialize:function(t,e){this._map=t,this._entrance=e},addHooks:function(){this._map.on(this._events(),this)},removeHooks:function(){this._map.off(this._events(),this)},_events:function(){return{layeradd:this._removeEntrance,zoomend:this._showOrHideEntrance,projectleave:this._showOrHideEntrance}},_showOrHideEntrance:function(){this._map.getZoom()>=DG.Entrance.SHOW_FROM_ZOOM?this._entrance.show(!1):this._entrance.hide()},_removeEntrance:function(t){(t.layer instanceof DG.Popup||t.layer instanceof DG.Entrance&&t.layer!==this._entrance)&&this._entrance.removeFrom(this._map)}}),DG.Map.mergeOptions({geoclicker:!1}),DG.Geoclicker=DG.Handler.extend({clickCount:0,pendingClick:0,timeout:250,initialize:function(t,e){this._map=t,this._controller=new DG.Geoclicker.Controller(t,e)},addHooks:function(){this._map.on(this._mapEventsListeners,this)},removeHooks:function(){this._map.off(this._mapEventsListeners,this)},getController:function(){return this._controller},_mapEventsListeners:{langchange:function(){this._controller.reinvokeHandler()},dblclick:function(){clearTimeout(this.pendingClick),this.clickCount=0},popupclose:function(t){this._controller.handlePopupClose(t.popup)},click:function(t){0===this.clickCount&&(this.clickCount=1,this._singleClick(t))}},_singleClick:function(t){var e=this;clearTimeout(this.pendingClick),this.pendingClick=setTimeout(function(){var i=t.target._zoom,n=t.latlng;e._controller.handleClick(n,i),e.clickCount=0},this.timeout)}}),DG.Map.addInitHook("addHandler","geoclicker",DG.Geoclicker),DG.Geoclicker.clampHelper=function(t,e){var i,n,o,r,s,a,l,c,u,h=document.createElement.bind(document),d=document.createTextNode.bind(document);if(i=h("span"),function(t){t.position="absolute",t.whiteSpace="pre",t.visibility="hidden",t.margin="0 18px 8px 0"}(i.style),t.ownerDocument&&t.ownerDocument===document){for(r=a=0,s=1,u=!1,o=t.clientWidth,n=(t.textContent||t.innerText).replace(/\n/g," ");null!==t.firstChild;)t.removeChild(t.firstChild);t.appendChild(i),n.replace(/ |-/g,function(p,f){s!==e&&(i.appendChild(d(n.substr(r,f-r))),o<i.clientWidth?(u?(c=n.substr(r,f+1-r),r=f+1):(c=n.substr(r,a-r),r=a),l=h("span"),l.appendChild(d(c)),t.appendChild(l),l.className="dg-map-geoclicker__clamped-line",u=!0,s++):u=!1,a=f+1,i.removeChild(i.firstChild))}),t.removeChild(i),l=h("span"),l.className="dg-map-geoclicker__clamped-line dg-map-geoclicker__clamped-line_last",l.appendChild(d(n.substr(r))),t.appendChild(l)}},DG.Geoclicker.Provider={},DG.Geoclicker.Provider.CatalogApi=DG.Class.extend({options:{urlGeo:"http://catalog.api.2gis.ru/2.0/search",urlDetails:"http://catalog.api.2gis.ru/2.0/details",data:{key:"ruxlih0718"},geoFields:"data.geometry.selection,data.attributes.filials,data.attributes.sight",firmInfoFields:"data.reviews,data.geo.id,data.photos",timeoutMs:5e3},initialize:function(t){this._map=t},getLocations:function(t){var e=t.zoom,i=t.latlng,n=t.callback,o=t.beforeRequest||function(){},r=this.getTypesByZoom(e),s=i.lng+","+i.lat;return r?(o(),void this.geoSearch(s,r,e).then(DG.bind(function(t){n(this._filterResponse(t,r))},this))):void n({error:"no type"})},firmsInHouse:function(t,e){e=e||{};var i=DG.extend(this.options.data,{type:"filial",house:t,page:e.page||1});return this._performRequest(i,this.options.urlGeo)},getFirmInfo:function(t){return this._performRequest({type:"filial",id:t,fields:this.options.firmInfoFields},this.options.urlDetails)},geoSearch:function(t,e,i){var n={point:t,geo_type:e,zoom_level:i,type:"geo",fields:this.options.geoFields};return this._performRequest(n,this.options.urlGeo)},cancelLastRequest:function(){this._lastRequest&&this._lastRequest.abort()},getTypesByZoom:function(t){var e={settlement:8,city:8,division:11,district:12,station:12,metro:12,station_platform:12,street:14,house:14,place:15,poi:15,sight:17},i=[];return Object.keys(e).forEach(function(n){t>=e[n]&&i.push(n)}),i.length?i.join(","):null},_performRequest:function(t,e){var i=this.options.data,n=DG.extend({key:i.key},t),o="get";return this.cancelLastRequest(),DG.ajax.corsSupport||(o=n.output="jsonp"),this._lastRequest=DG.ajax(e,{type:o,data:n,timeout:this.options.timeoutMs}),this._lastRequest.then(undefined,function(){return!1})},_filterResponse:function(t,e){var i,n,o,r,s={};if(this._isNotFound(t))return!1;for(r=t.result.data,i=r.length-1;i>=0;i--)n=r[i],e&&-1===e.indexOf(n.geo_type)||(s[n.geo_type]=n,o=!0);return o?s:!1},_isNotFound:function(t){return!(t&&!t.error_code&&t.result&&t.result.data.length)}}),DG.Geoclicker.Handler={},DG.Geoclicker.Handler.Default=DG.Class.extend({includes:DG.Locale,statics:{Dictionary:{}},_eventHandlers:{},initialize:function(t,e,i){this._controller=t,this._view=e,this._map=i,this._view._popup.on("click",this._runEventHandlers,this)},handle:function(){return Promise.resolve({tmpl:"popupHeader",data:{title:this.t("we_have_not")}})},_addEventHandler:function(t,e){this._eventHandlers[t]=e},_runEventHandlers:function(t){var e=t.originalEvent.target;for(var i in this._eventHandlers)if(this._eventHandlers.hasOwnProperty(i)&&e.className.indexOf(i)>-1)return void this._eventHandlers[i].call(this,e)},_clearEventHandlers:function(){this._eventHandlers={}},_getDirectionsUrl:function(t){return DG.Util.template("http://2gis.ru/{projectCode}/center/{center}/zoom/{zoom}/routeTab/rsType/{rsType}/to/{point}{name}",{projectCode:this._map.projectDetector.getProject().code,center:this._map.getCenter().lng+","+this._map.getCenter().lat,zoom:this._map.getZoom(),name:encodeURIComponent(t),rsType:this._map.projectDetector.getProject().transport?"bus":"car",point:this._popup._latlng.lng+","+this._popup._latlng.lat})}}),DG.Geoclicker.Handler.HandlerExample=DG.Geoclicker.Handler.Default.extend({handle:function(t,e){return Promise.resolve({tmpl:e+":<br/>"+t[e].id})}}),DG.Geoclicker.Handler.CityArea=DG.Geoclicker.Handler.Default.extend({_polylineStyleDefault:{fillColor:"#ff9387",color:"#ff9387",clickable:!1,noClip:!0,opacity:1},_polylineStyles:{11:{fillOpacity:.18,weight:1},12:{fillOpacity:.12,weight:1},13:{fillOpacity:.08,weight:2},18:{fillOpacity:0,weight:3}},handle:function(t,e){return t[e]?(!this._stylesInited&&this._initStyles(),this._popup=this._view.getPopup(),this._geometryZoomStyle=this._getPolyStyleNum(),this._geometry=DG.Wkt.geoJsonLayer(t[e].geometry.selection,{style:this._polylineStyles[this._geometryZoomStyle]}).addTo(this._map),this._map.on("zoomend",this._updateGeometry,this).once("popupclose",this._clearPopup,this),Promise.resolve(this._fillCityAreaObject(t,e))):!1},_fillCityAreaObject:function(t,e){var i,n={name:this.t("noname"),address:"",purpose:this.t(e),type:e};return i=t[Object.keys(t).filter(function(t){return t!==e&&"extra"!==t})[0]],i&&(n.address=(i.attributes&&i.attributes.abbreviation?i.attributes.abbreviation+" ":"")+i.name),t[e].short_name&&(n.name=t[e].short_name),{tmpl:"cityarea",data:n,header:this._view.render({tmpl:"popupHeader",data:{title:n.name}})}},_initStyles:function(){this._stylesInited=!0,Object.keys(this._polylineStyles).forEach(function(t){DG.extend(this._polylineStyles[t],this._polylineStyleDefault)},this)},_getPolyStyleNum:function(){var t=this._map.getZoom();return Object.keys(this._polylineStyles).filter(function(e){return e>=t})[0]||!1},_updateGeometry:function(){var t=this._getPolyStyleNum();t&&t!==this._geometryZoomStyle&&(this._geometryZoomStyle=t,this._geometry.setStyle(this._polylineStyles[t]))},_clearPopup:function(){this._popup.clear("header"),this._map.removeLayer(this._geometry).off("zoomend",this._updateGeometry,this)}}),DG.Geoclicker.Handler.House=DG.Geoclicker.Handler.Default.extend({_firmsOnPage:20,_scrollThrottleInterval:400,_scrollHeightReserve:60,_allowedCountries:["ru","kz","ua"],options:{showBooklet:!0,showPhotos:!0,showRouteSearch:!0},handle:function(t){return t.house?(this.firmCard=null,this._page=1,this._houseObject=null,this._firmList=null,this._firmListObject=null,this._firmCardObject=null,this._onScroll=!1,this._isFirmlistOpen=!1,this._id=t.house.id,this._totalPages=1,this._api=this._controller.getCatalogApi(),this._popup=this._view.getPopup(),this._initedPopupClose=!1,this._directionsUrl=this._getDirectionsUrl(t.house.name),this._firmListLoader=this._view.initLoader(!0),this._houseObject=this._fillHouseObject(t.house),Promise.resolve(this._houseObject)):!1},_isRouteSearchAllowed:function(){var t=this._map.projectDetector.getProject().country_code;return t&&-1!==this._allowedCountries.indexOf(t)},_firmCardSetup:function(){return{render:this._view._templates,lang:this._map.getLang(),ajax:DG.bind(this._api.getFirmInfo,this._api),timezoneOffset:this._controller.getMap().projectDetector.getProject().timeOffset,map:this._map,popup:this._popup,isMobile:DG.Browser.mobile,showEntrance:DG.Entrance,gotoUrl:this._directionsUrl,onFirmReady:DG.bind(this._onFirmReady,this),onToggle:DG.bind(this._popup.resize,this._popup),showBooklet:this.options.showBooklet,showPhotos:this.options.showPhotos,showRouteSearch:this.options.showRouteSearch&&this._isRouteSearchAllowed()}},_fillFirmCardObject:function(t){var e=this._firmCardSetup();return this.firmCard=new FirmCard(t,e),this._initPopupClose(),this.firmCard.getContainer()},_firmListSetup:function(){var t=this._firmCardSetup();return DG.extend(t,{backBtn:DG.bind(this._showHousePopup,this),onFirmClick:DG.bind(this._onFirmListClick,this),onShowLess:DG.bind(this._showHousePopup,this),pasteLoader:DG.bind(this._pasteLoader,this)}),{firmCard:t,firmlistItemTmpl:"firmlistItem",onListReady:DG.bind(this._renderFirmList,this)}},_initShortFirmList:function(t){var e=this._firmListSetup();return this._shortFirmList=new FirmCard.List(t,e),this._shortFirmList.renderList()},_initFirmList:function(t){if(!t)return!1;var e=t.result.data,i=this._firmListSetup();i.firmCard.backBtn=DG.bind(function(){this._popup.on("scroll",this._onScroll),this._showListPopup()},this),this._firmList=new FirmCard.List(e,i),this._firmListObject=this._fillFirmListObject(this._firmList.renderList()),this._clearAndRenderPopup(this._firmListObject)},_fillFirmListObject:function(t){var e=this;return{tmpl:t,header:this._header,footer:this._view.render({tmpl:"popupFooterBtns",data:{btns:[{name:"back",label:this.t("back_button"),icon:!0}]}}),afterRender:function(){e._initPopupClose(),e._firmListLoader&&this.tmpl.parentNode.appendChild(e._firmListLoader)}}},_onFirmReady:function(t){var e=this;t.afterRender=function(){var t=e._popup._popupStructure.header.firstChild;DG.Browser.ielt9||t.offsetHeight>72&&(DG.DomUtil.addClass(t,"dg-popup__header-teaser"),DG.Browser.webkit||DG.Geoclicker.clampHelper(t,3))},this._clearAndRenderPopup(t)},_showHousePopup:function(){this._clearAndRenderPopup(this._houseObject),this._shortFirmList._toggleEventHandlers()},_onFirmListClick:function(){this._popup.off("scroll",this._onScroll)},_pasteLoader:function(){var t=DG.DomUtil.create("div","dg-map-geoclicker__preloader-wrapper"),e=this._view.initLoader();t.appendChild(e),t.style.height=this._popup._contentNode.offsetHeight-1+"px",t.style.width=this._popup._contentNode.offsetWidth+"px",this._clearAndRenderPopup({tmpl:t})},_initPopupClose:function(){this._initedPopupClose||(this._controller.getMap().once("popupclose",DG.bind(this._onPopupClose,this)),this._initedPopupClose=!0)},_showListPopup:function(){var t=this._firmListObject;this._pasteLoader(),t?(this._clearAndRenderPopup(t),this._firmList._toggleEventHandlers()):t=this._api.firmsInHouse(this._id).then(DG.bind(this._initFirmList,this))},_renderFirmList:function(){this._isFirmlistOpen||(this._popup.resize(),this._isFirmlistOpen=!0,this._onScroll||(this._onScroll=DG.Util.throttle(this._handlePopupScroll,this._scrollThrottleInterval,this)),this._popup.on("scroll",this._onScroll)),1===this._totalPages&&this._firmListLoader&&this._view.hideLoader(this._firmListLoader)},_onPopupClose:function(){this._initedPopupClose=!1,this._firmList&&(this._firmList.clearList(),this._firmList=null,this._popup.off("scroll",this._onScroll)),this._firmId=null,this.firmCard&&(this.firmCard._toggleEventHandlers(!0),this.firmCard=null),this._firmListLoader=null,this._page=1,this._popup.clear(),this._clearEventHandlers()},_initShowMore:function(){var t=this._popup.findElement(".dg-popup__button_name_all");t&&this._addEventHandler("dg-popup__button_name_all",DG.bind(this._showListPopup,this))},_clearAndRenderPopup:function(t){this._clearEventHandlers(),this._popup.clear("header","footer"),this._view.renderPopup(t)},_appendFirmList:function(t){this._firmList.addFirms(t.result.data),this._popup._updateScrollPosition()},_handlePopupScroll:function(t){var e=t.originalEvent.target||t.target._scroller;DG.DomEvent.stop(t),this._totalPages<=1||e&&e.scrollHeight<=e.scrollTop+e.offsetHeight+this._scrollHeightReserve&&this._handlePaging()},_handlePaging:function(){this._page++,this._totalPages&&this._page<=this._totalPages&&this._api.firmsInHouse(this._id,{page:this._page}).then(DG.bind(this._appendFirmList,this)),this._page===this._totalPages&&(this._firmListLoader&&this._view.hideLoader(this._firmListLoader),this._popup.off("scroll",this._onScroll))}}),DG.Geoclicker.Handler.House.include({_fillBody:function(t){var e=t.attributes,i={},n=DG.DomUtil.create("div","dg-building-callout__body"),o=t.attributes.filials;return e.city&&(i.address=(e.district?this.t("district")+" "+e.district+", ":"")+e.city+(e.postal_code?", "+e.postal_code:"")),t.name&&e.building_name&&(i.headAddress=t.name.split(", ").slice(1).join(", ")),e.building_description&&(i.purpose=e.building_description+(e.floors_count?", "+this.t("n_floors",e.floors_count):"")),e.filials_count>0&&(this._totalPages=Math.ceil(e.filials_count/this._firmsOnPage)),n.innerHTML=this._view.render({tmpl:"house",data:i}),o&&n.appendChild(this._initShortFirmList(o.popular)),n},_fillHeader:function(t){var e=t.attributes,i={};return i.title=e.building_name?e.building_name:t.name?t.name.split(", ").slice(1).join(", "):e.building_description,this._header=this._view.render({tmpl:"popupHeader",data:i}),this._header},_fillFooter:function(t){var e=t.attributes,i=[],n=!1;return e.filials_count>0&&(e.filials&&e.filials.popular?e.filials_count>e.filials.popular.length&&(n=!0):n=!0),n&&i.push(this._getShowAllData(e.filials_count)),this._isRouteSearchAllowed()&&i.push({name:"goto",label:this.t("go_to"),icon:!0,href:this._directionsUrl}),this._view.render({tmpl:"popupFooterBtns",data:{btns:i}})},_getShowAllData:function(t){return{name:"all",label:this.t("show_organization_in_building",t)}},_fillHouseObject:function(t){var e=this;return{header:this._fillHeader(t),tmpl:this._fillBody(t),footer:this._fillFooter(t),afterRender:function(){e._initShowMore(),e._initPopupClose()}}}}),DG.Geoclicker.Handler.Poi=DG.Geoclicker.Handler.House.extend({handle:function(t){return t.house&&t.poi?(DG.Geoclicker.Handler.House.prototype.handle.call(this,t),this._firmCardObject=this._fillFirmCardObject(t.poi.attributes.links.poi[0].id),Promise.resolve(this._firmCardObject)):!1}}),DG.Geoclicker.Handler.Sight=DG.Geoclicker.Handler.Default.extend({handle:function(t){return t.sight?(this._popup=this._view.getPopup(),this._initedPopupClose=!1,Promise.resolve(this._fillSightObject(t))):!1},_fillSightObject:function(t){var e,i=t.sight.attributes,n={description:i.info.description},o=this,r={btns:[{name:"goto",label:this.t("go_to"),icon:!0}]};return n.buildingName=i.building_name?i.building_name:t.sight.short_name,i.sight_description&&(n.purpose=i.sight_description),null===n.buildingName&&(n.buildingName=n.purpose,n.purpose=this.t("place")),n.drillDown=Object.keys(t).filter(function(t){return-1===["sight","place","extra"].indexOf(t)}).map(function(e){return t[e]}).reduce(function(t,i){return i.attributes&&i.attributes.abbreviation&&(e=i.attributes.abbreviation+" "),i.name?e+i.name:void 0},""),this._checkDescFieldHeight(n.description)&&(n.showMoreText=this.t("show_more_about_sight")),r.btns[0].href=this._getDirectionsUrl(n.buildingName),{tmpl:"sight",data:n,header:this._view.render({tmpl:"popupHeader",data:{title:n.buildingName}}),afterRender:function(){o._needShowMore&&o._initShowMore(),o._initPopupClose()}}},_initPopupClose:function(){this._initedPopupClose||(this._controller.getMap().once("popupclose",DG.bind(this._clearPopup,this)),this._initedPopupClose=!0)},_clearPopup:function(){this._initedPopupClose=!1,this._popup.clear(),this._clearEventHandlers()},_showMoreText:function(){this._desc.style.maxHeight="100%",this._link.parentNode.removeChild(this._link),this._popup.resize()},_initShowMore:function(){this._link=this._popup.findElement(".dg-map-geoclicker__show-more-sights-link"),this._desc=this._popup.findElement(".dg-map-geoclicker__sight-description"),this._link&&this._desc&&this._addEventHandler("dg-map-geoclicker__show-more-sights-link",DG.bind(this._showMoreText,this))},_checkDescFieldHeight:function(t){var e,i=DG.DomUtil.create("div","");return i.style.visibility="hidden",i.innerHTML=t,this._popup._contentNode.appendChild(i),e=i.offsetHeight,this._popup._contentNode.removeChild(i),this._needShowMore=e>40,this._needShowMore}}),DG.Geoclicker.View=DG.Class.extend({initialize:function(t,e){this._map=t,this._popup=DG.popup({maxHeight:300,minHeight:50,maxWidth:385,minWidth:385}),this._templates=DG.dust({cityarea:'(function(){dust.register("cityarea",body_0);function body_0(chk,ctx){return chk.write("<div class=\\"dg-map-geoclicker__purpose dg-map-geoclicker__purpose_type_").reference(ctx.get(["type"], false),ctx,"h").write("\\">").reference(ctx.get(["purpose"], false),ctx,"h").write("</div><div class=\\"dg-map-geoclicker__drilldown\\">").reference(ctx.get(["address"], false),ctx,"h").write("</div>");}return body_0;})();',firmCardAddr:'(function(){dust.register("firmCardAddr",body_0);function body_0(chk,ctx){return chk.write("<address class=\\"dg-firm-card__address dg-firm-card__icon\\">").section(ctx.get(["data"], false),ctx,{"block":body_1},null).write("</address>");}function body_1(chk,ctx){return chk.reference(ctx.get(["address"], false),ctx,"h").section(ctx.get(["comment"], false),ctx,{"block":body_2},null);}function body_2(chk,ctx){return chk.write("<span class=\\"dg-firm-card__comment\\">").reference(ctx.getPath(true, []),ctx,"h").write("</span>");}return body_0;})();',firmCardContacts:'(function(){dust.register("firmCardContacts",body_0);function body_0(chk,ctx){return chk.section(ctx.get(["groups"], false),ctx,{"block":body_1},null);}function body_1(chk,ctx){return chk.section(ctx.get(["contacts"], false),ctx,{"block":body_2},null);}function body_2(chk,ctx){return chk.helper("select",ctx,{"block":body_3},{"key":ctx.get(["type"], false),"type":"string"});}function body_3(chk,ctx){return chk.helper("eq",ctx,{"block":body_4},{"value":"phone","type":"string"}).helper("eq",ctx,{"block":body_6},{"value":"fax","type":"string"}).helper("eq",ctx,{"block":body_8},{"value":"website","type":"string"}).helper("eq",ctx,{"block":body_9},{"value":"email","type":"string"});}function body_4(chk,ctx){return chk.write("<div class=\\"dg-firm-card__phone dg-firm-card__icon\\"><span class=\\"dg-firm-card__phone-num\\">").reference(ctx.get(["value"], false),ctx,"h").section(ctx.get(["comment"], false),ctx,{"block":body_5},null).write("</span></div>");}function body_5(chk,ctx){return chk.write("<span class=\\"dg-firm-card__comment\\" title=\\"").reference(ctx.getPath(true, []),ctx,"h").write("\\">&ndash;&nbsp;&nbsp;").reference(ctx.getPath(true, []),ctx,"h").write("</span>");}function body_6(chk,ctx){return chk.write("<div class=\\"dg-firm-card__phone dg-firm-card__icon\\"><span class=\\"dg-firm-card__phone-num\\">").reference(ctx.get(["value"], false),ctx,"h").section(ctx.get(["comment"], false),ctx,{"block":body_7},null).write("</span></div>");}function body_7(chk,ctx){return chk.write("<span class=\\"dg-firm-card__comment\\" title=\\"").reference(ctx.getPath(true, []),ctx,"h").write("\\">&ndash;&nbsp;&nbsp;").reference(ctx.getPath(true, []),ctx,"h").write("</span>");}function body_8(chk,ctx){return chk.write("<div class=\\"dg-firm-card__link dg-firm-card__site dg-firm-card__icon\\"><a href=\\"").reference(ctx.get(["value"], false),ctx,"h").write("\\" target=\\"_blank\\" class=\\"dg-link_scheme_dark dg-firm-card__sitelink\\">").reference(ctx.get(["alias"], false),ctx,"h").write("</a></div>");}function body_9(chk,ctx){return chk.write("<div class=\\"dg-firm-card__link dg-firm-card__email dg-firm-card__icon\\"><a href=\\"mailto: ").reference(ctx.get(["value"], false),ctx,"h").write("\\">").reference(ctx.get(["value"], false),ctx,"h").write("</a></div>");}return body_0;})();',firmCardHeader:'(function(){dust.register("firmCardHeader",body_0);function body_0(chk,ctx){return chk.write("<div class=\\"dg-popup__header-title dg-popup__header-title_for_firmcard\\" title=\\"").reference(ctx.get(["firmName"], false),ctx,"h").write("\\">").reference(ctx.get(["firmName"], false),ctx,"h").write("</div>").exists(ctx.get(["links"], false),ctx,{"block":body_1},null);}function body_1(chk,ctx){return chk.write("<div class=\\"dg-popup__header-links\\">").section(ctx.get(["links"], false),ctx,{"block":body_2},null).write("</div>");}function body_2(chk,ctx){return chk.helper("eq",ctx,{"else":body_3,"block":body_6},{"key":body_7,"value":"flamp_stars","type":"string"});}function body_3(chk,ctx){return chk.write("<a class=\\"dg-popup__header-link dg-popup__link dg-popup__link_type_").reference(ctx.get(["name"], false),ctx,"h").write("\\"").exists(ctx.get(["href"], false),ctx,{"else":body_4,"block":body_5},null).write(">").reference(ctx.get(["label"], false),ctx,"h").write("</a>");}function body_4(chk,ctx){return chk.write("href=\\"javascript:void(0)\\"");}function body_5(chk,ctx){return chk.write("href=").reference(ctx.get(["href"], false),ctx,"h").write(" target=\\"_blank\\"");}function body_6(chk,ctx){return chk.write("<div class=\\"dg-popup__rating\\"><div class=\\"dg-popup__rating-stars\\" style=\\"width: ").reference(ctx.get(["width"], false),ctx,"h").write("%\\"></div></div>");}function body_7(chk,ctx){return chk.reference(ctx.get(["name"], false),ctx,"h");}return body_0;})();',firmCardRubric:'(function(){dust.register("firmCardRubric",body_0);function body_0(chk,ctx){return chk.section(ctx.get(["rubrics"], false),ctx,{"block":body_1},null);}function body_1(chk,ctx){return chk.write("<section class=\\"dg-firm-card__rubrics\\">").exists(ctx.get(["primary"], false),ctx,{"block":body_2},null).exists(ctx.get(["additional"], false),ctx,{"block":body_4},null).write("</section>");}function body_2(chk,ctx){return chk.write("<ul class=\\"dg-firm-card__rubrics-list dg-firm-card__rubrics-list_type_primary\\">").section(ctx.get(["primary"], false),ctx,{"block":body_3},null).write("</ul>");}function body_3(chk,ctx){return chk.write("<li class=\\"dg-firm-card__rubrics-list-item\\">").reference(ctx.get(["name"], false),ctx,"h").write("</li>");}function body_4(chk,ctx){return chk.write("<ul class=\\"dg-firm-card__rubrics-list dg-firm-card__rubrics-list_type_additional\\">").section(ctx.get(["additional"], false),ctx,{"block":body_5},null).write("</ul>");}function body_5(chk,ctx){return chk.write("<li class=\\"dg-firm-card__rubrics-list-item\\">").reference(ctx.get(["name"], false),ctx,"h").write("</li>");}return body_0;})();',firmCardSchedule:'(function(){dust.register("firmCardSchedule",body_0);function body_0(chk,ctx){return chk.write("<div class=\\"dg-firm-card__schedule dg-schedule dg-schedule_open_").exists(ctx.getPath(false, ["forecast","open"]),ctx,{"else":body_1,"block":body_2},null).write(" dg-schedule_works-everyday_").exists(ctx.getPath(false, ["schedule","everyday"]),ctx,{"else":body_3,"block":body_4},null).write("\\">").exists(ctx.get(["schedule"], false),ctx,{"block":body_5},null).write("</div>");}function body_1(chk,ctx){return chk.write("false");}function body_2(chk,ctx){return chk.write("true");}function body_3(chk,ctx){return chk.write("false");}function body_4(chk,ctx){return chk.write("true");}function body_5(chk,ctx){return chk.exists(ctx.getPath(false, ["forecast","today"]),ctx,{"block":body_6},null).section(ctx.getPath(false, ["forecast","now"]),ctx,{"block":body_10},null).notexists(ctx.getPath(false, ["schedule","everyday"]),ctx,{"block":body_12},null);}function body_6(chk,ctx){return chk.write("<div class=\\"dg-schedule__today\\">").reference(ctx.getPath(false, ["forecast","today","text"]),ctx,"h").write("&nbsp;").exists(ctx.getPath(false, ["forecast","today","from"]),ctx,{"block":body_7},null).exists(ctx.getPath(false, ["schedule","lunch"]),ctx,{"block":body_8},null).write("</div>");}function body_7(chk,ctx){return chk.reference(ctx.getPath(false, ["forecast","today","from"]),ctx,"h").write("&ndash;").reference(ctx.getPath(false, ["forecast","today","to"]),ctx,"h");}function body_8(chk,ctx){return chk.write(",&nbsp;").reference(ctx.getPath(false, ["forecast","today","lunchStr"]),ctx,"h").write("&nbsp;").section(ctx.getPath(false, ["schedule","lunch"]),ctx,{"block":body_9},null);}function body_9(chk,ctx){return chk.reference(ctx.get(["from"], false),ctx,"h").write("&ndash;").reference(ctx.get(["to"], false),ctx,"h");}function body_10(chk,ctx){return chk.write("<div class=\\"dg-schedule__now\\"><span class=\\"dg-schedule__now-text\\">").reference(ctx.getPath(true, []),ctx,"h").section(ctx.getPath(false, ["schedule","comment"]),ctx,{"block":body_11},null).write("</span></div>");}function body_11(chk,ctx){return chk.write(", ").reference(ctx.getPath(true, []),ctx,"h");}function body_12(chk,ctx){return chk.exists(ctx.getPath(false, ["schedule","week"]),ctx,{"block":body_13},null);}function body_13(chk,ctx){return chk.exists(ctx.getPath(false, ["schedule","week","evently"]),ctx,{"block":body_14},null).exists(ctx.getPath(false, ["schedule","week","table"]),ctx,{"block":body_22},null);}function body_14(chk,ctx){return chk.write("<div class=\\"dg-schedule__table\\">").section(ctx.getPath(false, ["schedule","week","evently"]),ctx,{"block":body_15},null).write("</div>");}function body_15(chk,ctx){return chk.write("<div class=\\"dg-schedule__string\\">").exists(ctx.get(["alltime"], false),ctx,{"block":body_16},null).exists(ctx.get(["everyday"], false),ctx,{"else":body_17,"block":body_18},null).exists(ctx.get(["holiday"], false),ctx,{"else":body_19,"block":body_21},null).write("</div>");}function body_16(chk,ctx){return chk.reference(ctx.get(["alltimeStr"], false),ctx,"h");}function body_17(chk,ctx){return chk.reference(ctx.get(["dayList"], false),ctx,"h");}function body_18(chk,ctx){return chk.reference(ctx.getPath(false, ["forecast","today","text"]),ctx,"h");}function body_19(chk,ctx){return chk.write("<span class=\\"schedule__string-time\\">&nbsp;").reference(ctx.get(["from"], false),ctx,"h").write("&ndash;").reference(ctx.get(["to"], false),ctx,"h").write("</span>").section(ctx.get(["lunch"], false),ctx,{"block":body_20},null);}function body_20(chk,ctx){return chk.write("<p>").reference(ctx.get(["lunchStr"], false),ctx,"h").write("&mdash;<span class=\\"schedule__string-time\\">").reference(ctx.get(["from"], false),ctx,"h").write("&ndash;").reference(ctx.get(["to"], false),ctx,"h").write("</span></p>");}function body_21(chk,ctx){return chk.write("&nbsp;&mdash;<span class=\\"schedule__string-time\\">&nbsp;").reference(ctx.get(["holidayStr"], false),ctx,"h").write("</span>");}function body_22(chk,ctx){return chk.write("<div><div class=\\"dg-schedule__table\\"><div class=\\"dg-schedule__tc dg-schedule__tc_pre\\"><div class=\\"dg-schedule__day-name\\">&nbsp;</div><div class=\\"dg-schedule__table-clock dg-schedule__td\\"></div>").exists(ctx.getPath(false, ["schedule","week","hasLunch"]),ctx,{"block":body_23},null).write("</div>").section(ctx.getPath(false, ["schedule","week","table"]),ctx,{"block":body_24},null).write("</div>  </div>");}function body_23(chk,ctx){return chk.write("<div class=\\"dg-schedule__table-lunch dg-schedule__td\\"></div>");}function body_24(chk,ctx){return chk.write("<div class=\\"dg-schedule__tc").exists(ctx.get(["active"], false),ctx,{"block":body_25},null).write("\\"><div class=\\"dg-schedule__day-name\\">").reference(ctx.get(["key"], false),ctx,"h").write("</div><div class=\\"dg-schedule__td\\">").exists(ctx.get(["from"], false),ctx,{"else":body_26,"block":body_27},null).write("</div>").section(ctx.get(["lunch"], false),ctx,{"block":body_28},null).write("</div> ");}function body_25(chk,ctx){return chk.write(" dg-schedule__tc_active_true");}function body_26(chk,ctx){return chk.write("&ndash;");}function body_27(chk,ctx){return chk.reference(ctx.get(["from"], false),ctx,"h").write(" ").reference(ctx.get(["to"], false),ctx,"h");}function body_28(chk,ctx){return chk.write("<div class=\\"dg-schedule__td\\">").exists(ctx.get(["from"], false),ctx,{"else":body_29,"block":body_30},null).write("</div>");}function body_29(chk,ctx){return chk.write("&ndash;");}function body_30(chk,ctx){return chk.reference(ctx.get(["from"], false),ctx,"h").write(" ").reference(ctx.get(["to"], false),ctx,"h");}return body_0;})();',firmlistItem:'(function(){dust.register("firmlistItem",body_0);function body_0(chk,ctx){return chk.write("<a id=\\"").reference(ctx.getPath(false, ["firm","id"]),ctx,"h").write("\\" class=\\"dg-popup__link\\" href=\\"#\\">").reference(ctx.getPath(false, ["firm","name"]),ctx,"h").write("</a>");}return body_0;})();',frimCardPayments:'(function(){dust.register("frimCardPayments",body_0);function body_0(chk,ctx){return chk.exists(ctx.get(["payments"], false),ctx,{"block":body_1},null);}function body_1(chk,ctx){return chk.write("<section class=\\"dg-firm-card__aa\\"><ul class=\\"dg-firm-card__aa-list\\">").section(ctx.get(["payments"], false),ctx,{"block":body_2},null).write("</ul></section>");}function body_2(chk,ctx){return chk.helper("eq",ctx,{"block":body_3},{"key":body_5,"value":"payment_type","type":"string"});}function body_3(chk,ctx){return chk.section(ctx.get(["label"], false),ctx,{"block":body_4},null);}function body_4(chk,ctx){return chk.write("<li class=\\"dg-firm-card__aa-list-item\\">").reference(ctx.getPath(true, []),ctx,"h").write("</li>");}function body_5(chk,ctx){return chk.reference(ctx.get(["name"], false),ctx,"h");}return body_0;})();',house:'(function(){dust.register("house",body_0);function body_0(chk,ctx){return chk.section(ctx.get(["headAddress"], false),ctx,{"block":body_1},null).section(ctx.get(["address"], false),ctx,{"block":body_2},null).write("<div class=\\"dg-map-geoclicker__purpose\\">").reference(ctx.get(["purpose"], false),ctx,"h").write("</div><div class=\\"dg-map-geoclicker__elevation\\">").reference(ctx.get(["elevation"], false),ctx,"h").write("</div>");}function body_1(chk,ctx){return chk.write("<div class=\\"dg-map-geoclicker__address-header\\">").reference(ctx.getPath(true, []),ctx,"h").write("</div>");}function body_2(chk,ctx){return chk.write("<div class=\\"dg-map-geoclicker__drilldown\\">").reference(ctx.getPath(true, []),ctx,"h").write("</div>");}return body_0;})();',loader:'(function(){dust.register("loader",body_0);function body_0(chk,ctx){return chk.write("<div class=\\"dg-preloader dg-preloader_scheme_regular dg-preloader_animation_").exists(ctx.get(["anim"], false),ctx,{"else":body_1,"block":body_2},null).exists(ctx.get(["small"], false),ctx,{"block":body_3},null).write("\\"></div>");}function body_1(chk,ctx){return chk.write("false");}function body_2(chk,ctx){return chk.write("true");}function body_3(chk,ctx){return chk.write(" dg-preloader_size_small");}return body_0;})();',popupFooter:'(function(){dust.register("popupFooter",body_0);function body_0(chk,ctx){return chk.write("<div class=\\"dg-popup__footer-title\\"><a class=\\"dg-popup__show-less-house-link\\" href=\\"javascript:void(0)\\">").reference(ctx.get(["hideFirmsText"], false),ctx,"h").write("</a></div>");}return body_0;})();',popupFooterBtns:'(function(){dust.register("popupFooterBtns",body_0);function body_0(chk,ctx){return chk.exists(ctx.get(["btns"], false),ctx,{"block":body_1},null);}function body_1(chk,ctx){return chk.write("<footer class=\\"dg-popup__footer-buttons\\">").section(ctx.get(["btns"], false),ctx,{"block":body_2},null).write("</footer>");}function body_2(chk,ctx){return chk.write("<div class=\\"dg-popup__footer-button-wrapper\\"><a class=\\"dg-popup__button_name_").reference(ctx.get(["name"], false),ctx,"h").write(" dg-popup__footer-button").exists(ctx.get(["icon"], false),ctx,{"block":body_3},null).write("\\"").exists(ctx.get(["href"], false),ctx,{"else":body_4,"block":body_5},null).write(">").reference(ctx.get(["label"], false),ctx,"h").write("</a></div>");}function body_3(chk,ctx){return chk.write(" dg-popup__footer-icon-button");}function body_4(chk,ctx){return chk.write("href=\\"javascript:void(0)\\"");}function body_5(chk,ctx){return chk.write("href=").reference(ctx.get(["href"], false),ctx,"h").write(" target=\\"_blank\\"");}return body_0;})();',popupHeader:'(function(){dust.register("popupHeader",body_0);function body_0(chk,ctx){return chk.section(ctx.get(["title"], false),ctx,{"block":body_1},null);}function body_1(chk,ctx){return chk.write("<div class=\\"dg-popup__header-title\\">").reference(ctx.getPath(true, []),ctx,"h").write("</div>");}return body_0;})();',sight:'(function(){dust.register("sight",body_0);function body_0(chk,ctx){return chk.write("<div class=\\"dg-map-geoclicker__purpose dg-map-geoclicker__purpose_type_sight\\">").reference(ctx.get(["purpose"], false),ctx,"h").write("</div>").section(ctx.get(["address"], false),ctx,{"block":body_1},null).write("<div class=\\"dg-map-geoclicker__drilldown\\">").reference(ctx.get(["drillDown"], false),ctx,"h").write("</div>").section(ctx.get(["description"], false),ctx,{"block":body_2},null);}function body_1(chk,ctx){return chk.write("<div class=\\"dg-map-geoclicker__address\\">").reference(ctx.getPath(true, []),ctx,"h").write("</div>");}function body_2(chk,ctx){return chk.write("<div class=\\"dg-map-geoclicker__sight-description\\">").reference(ctx.getPath(true, []),ctx,"h").write("</div>").section(ctx.get(["showMoreText"], false),ctx,{"block":body_3},null);}function body_3(chk,ctx){return chk.write("<a class=\\"dg-map-geoclicker__show-more-sights-link\\" href=\\"javascript:void(0)\\">").reference(ctx.getPath(true, []),ctx,"h").write("</a>");}return body_0;})();'}),e&&DG.Util.setOptions(this,e)
},showLoader:function(t){t&&(t.style.display="block")},hideLoader:function(t){t&&(t.style.display="none")},initLoader:function(t){var e=document.createElement("div");return e.innerHTML=this._templates("loader",{small:t,anim:this._detectCssAnimation()}),e.firstChild},showPopup:function(t,e){this._popup.setContent(e).setLatLng(t).openOn(this._map)},render:function(t){var e,i={};return t=t||{},t.tmpl=t.tmpl||"",e=t.data?this._templates(t.tmpl,t.data):t.tmpl,t.beforeRender&&t.beforeRender(),t.popup&&(t.header&&(i.header=t.header),t.footer&&(i.footer=t.footer),i.body=e,this._popup.setContent(i)),t.afterRender&&t.afterRender(),e},renderPopup:function(t){return t.popup=!0,this.render(t)},getPopup:function(){return this._popup},_detectCssAnimation:function(){var t=!1,e="animation",i="",n="Webkit Moz O ms Khtml".split(" "),o=document.createElement("div"),r="";if(o.style.animationName&&(t=!0),t===!1)for(var s=0;s<n.length;s++)if(o.style[n[s]+"AnimationName"]!==undefined){r=n[s],e=r+"Animation",i="-"+r.toLowerCase()+"-",t=!0;break}return t}}),DG.Geoclicker.Controller=DG.Class.extend({options:{handlersSequence:{poi:DG.Geoclicker.Handler.Poi,house:DG.Geoclicker.Handler.House,sight:DG.Geoclicker.Handler.Sight,street:DG.Geoclicker.Handler.CityArea,place:DG.Geoclicker.Handler.CityArea,district:DG.Geoclicker.Handler.CityArea,division:DG.Geoclicker.Handler.CityArea,settlement:DG.Geoclicker.Handler.CityArea,city:DG.Geoclicker.Handler.CityArea,"default":DG.Geoclicker.Handler.Default}},initialize:function(t,e){this._options=e,this._handlers={},this._catalogApi=new DG.Geoclicker.Provider.CatalogApi(t),this._map=t,this._view=new DG.Geoclicker.View(t),this._renderHandlerResult=DG.bind(this._renderHandlerResult,this),this._lastHandleClickArguments=null},handlePopupClose:function(t){t===this._view.getPopup()&&(this._lastHandleClickArguments=null,this._catalogApi.cancelLastRequest())},handleClick:function(t,e){var i=this,n=Array.prototype.slice.call(arguments,0);this._catalogApi.getLocations({latlng:t,zoom:e,callback:function(t){i.handleResponse(t)},beforeRequest:function(){var e=i._view.initLoader();i._view._popup.clear(),i._view.showPopup(t,e),i._lastHandleClickArguments=n}})},handleResponse:function(t){var e;if(this._view.hideLoader(),!t)return void this._runHandler("default");if(!t.error||"no type"!==t.error){for(;e=this.findHandler(t);){if(this._runHandler(e,t))return;delete t[e]}this._runHandler("default")}},findHandler:function(t){for(var e in this.options.handlersSequence)if(t[e])return e;return null},getCatalogApi:function(){return this._catalogApi},getMap:function(){return this._map},reinvokeHandler:function(){this._lastHandleClickArguments&&this.handleClick.apply(this,this._lastHandleClickArguments)},_runHandler:function(t,e){e=e||{},this._initHandlerOnce(t);var i=this._handlers[t].handle(e,t);return i?i.then(this._renderHandlerResult):!1},_renderHandlerResult:function(t){this._view.renderPopup(t)},_initHandlerOnce:function(t){this._handlers[t]||(this._handlers[t]=new this.options.handlersSequence[t](this,this._view,this._map,this._options))}}),DG.Geoclicker.Handler.Default.Dictionary.it=DG.extend({we_have_not:"Non disponiamo ancora di informazioni su questo posto",noname:"Nome non indicato",place:"Luogo",division:"Zona",settlement:"Comune",street:"Via",district:"Municipalit",city:"itt",go_to:"Come arrivare",show_organization_in_building:["{n} azienda in tutto","{n} aziende in tutto"],show_more_about_sight:"Maggiori informazioni",back_button:"Indietro",n_floors:["{n} piano","{n} piani"]},DG.Dictionary.it),DG.Geoclicker.Handler.Default.Dictionary.ru=DG.extend({we_have_not:"      ",noname:" ",place:"",division:"",settlement:" ",street:"",district:"",city:"",go_to:" ",show_organization_in_building:[" {n} "," {n} "," {n} "],show_more_about_sight:"",back_button:"",n_floors:["{n} ","{n} ","{n} "]},DG.Dictionary.ru),DG.Geoclicker.Handler.Default.Dictionary.en=DG.extend({we_have_not:"We haven't collected info about this place yet",noname:"No name",place:"Place",division:"Area",settlement:"Village",street:"Street",district:"Disctict",city:"City",go_to:"Directions to here",show_organization_in_building:["{n} organization total","{n} organizations total"],back_button:"Back",show_more_about_sight:"More information",n_floors:["{n} floor","{n} floors"]},DG.Dictionary.en),DG.Geoclicker.Handler.Default.Dictionary.cs=DG.extend({we_have_not:"O tomto mst zatm nemme informace",noname:"Bez nzvu",place:"Msto",division:"Sprvn obvod",settlement:"Obec",street:"Ulice",district:"Mstsk st",city:"Msto",go_to:"cs - Directions to here",show_organization_in_building:["Celkem {n} organizace","Celkem {n} organizace","Celkem {n} organizac"],back_button:"Zpt",show_more_about_sight:"Vce",n_floors:["{n} patro","{n} patra","{n} pater"]},DG.Dictionary.cs),DG.Geoclicker.Handler.Default.Dictionary.sp=DG.extend({we_have_not:"Todava no hemos recopilado la informacin sobre este lugar",noname:"Sin nombre",place:"Lugar",division:"Comuna",settlement:"Poblacin",street:"Calle",district:"Comuna",city:"Ciudad",go_to:"Ir para all",show_organization_in_building:["Total {n} organizacin","Total {n} organizaciones","Total {n} organizaciones"],show_more_about_sight:"Read more",back_button:"Atrs",n_floors:["{n} piso","{n} pisos"]},DG.Dictionary.sp);var FirmCard=function(t,e){this._setOptions(e),this._firmContentObject={},this._schedule=new FirmCard.Schedule({localLang:this.options.lang,dict:this.dict}),this.render(t)};FirmCard.prototype={render:function(t){return t?(t!==this._firmId?(this._firmContentObject={},this._renderCardById(t)):this._toggleEventHandlers(),this._firmContentObject):void 0},getSchedule:function(){return this._schedule},getContainer:function(){return this._container},_renderCardById:function(t){var e=this;this.options.ajax(t).then(function(i){if(!i)return!1;var n=i.result.data;"undefined"!==n&&(e._firmData=n[0],e._firmId=t,e._renderFirmCard(),e._toggleEventHandlers())})},_createFirmContainer:function(){var t=document.createElement("div");return t.setAttribute("id","dg-map-firm-full-"+this._firmId),t.setAttribute("class","dg-map-firm-full"),t},_renderFirmCard:function(){var t,e,i,n,o,r,s=this._firmData,a=this._container=this._createFirmContainer();e=this._schedule.transform(s.schedule,{zoneOffset:this.options.timezoneOffset,apiLang:this.options.lang,localLang:this.options.lang}),i=this._schedule.forecast(e),s.attributes&&s.attributes.general&&s.attributes.general.items&&(r=s.attributes.general.items?s.attributes.general.items:[]),t=this._buildFirmCardBody(this._getConfigFirmCardBody(s,e,i,r)),n=this._fillHeaderLinks(),o=this._fillFooterButtons(),this._firmContentObject.header=this.options.render("firmCardHeader",{firmName:s.name,links:n}),a.innerHTML=t,this._firmContentObject.tmpl=a,o.length&&(this._footerContainer=document.createElement("div"),this._footerContainer.innerHTML=this.options.render("popupFooterBtns",{btns:o}),this._firmContentObject.footer=this._footerContainer),this.options.onFirmReady&&this.options.onFirmReady(this._firmContentObject)},_getConfigFirmCardBody:function(t,e,i,n){return[{tmpl:"firmCardAddr",data:{data:t.geo}},{tmpl:"firmCardContacts",data:{groups:t.contact_groups}},{tmpl:"firmCardSchedule",data:{schedule:e,forecast:i}},{tmpl:"frimCardPayments",data:{payments:n}},{tmpl:"firmCardRubric",data:{rubrics:t.rubrics}}]},_buildFirmCardBody:function(t){var e=this;return t.reduce(function(t,i){var n=e.options.render(i.tmpl,i.data);return t+n},"")},_fillFooterButtons:function(){var t=[];return this.options.backBtn&&t.push({name:"firm-card-back",label:this.dict.t(this.options.lang,"btnBack"),icon:!0}),this.options.showRouteSearch&&t.push({name:"goto",label:this.dict.t(this.options.lang,"btnFindWay"),icon:!0,href:this.options.gotoUrl}),this._firmData.geo.entrances&&this.options.showEntrance&&t.push({name:"show-entrance",label:this.dict.t(this.options.lang,"btnEntrance"),icon:!0}),t},_fillHeaderLinks:function(){var t,e=[],i=this._firmData.reviews,n=this._firmData.photos,o=this._firmData.booklet;return i&&i.is_allowed_to_show_reviews&&(e.push({name:"flamp_stars",width:20*i.rating}),e.push({name:"flamp_reviews",label:this.dict.t(this.options.lang,"linkReviews",i.review_count),href:FirmCard.DataHelper.getFlampUrl(this._firmId)})),!this.options.isMobile&&n&&n.length&&this.options.showPhotos&&(t=L.Util.template("http://2gis.ru/photos/{id}",{id:this._firmId}),e.push({name:"photos",href:t,label:this.dict.t(this.options.lang,"linkPhoto",n.length)})),!this.options.isMobile&&o&&o.url&&this.options.showBooklet&&e.push({name:"booklet",href:o.url,label:this.dict.t(this.options.lang,"linkBooklet")}),e},_events:{"dg-popup__button_name_firm-card-back":function(){this.options.backBtn(),this._toggleEventHandlers(!0)},"dg-popup__button_name_show-entrance":function(){var t=new this.options.showEntrance({vectors:this._firmData.geo.entrances[0].vectors});t.addTo(this.options.map).show()},"dg-schedule__today":function(t){this._onToggleSchedule(t)}},_toggleEventHandlers:function(t){this.options.popup[t?"off":"on"]("click",this._onClick,this)},_onClick:function(t){var e=t.originalEvent.target;for(var i in this._events)if(this._events.hasOwnProperty(i)&&e.className.indexOf(i)>-1)return void this._events[i].call(this,e)},_onToggleSchedule:function(t){var e=this._container.querySelector(".dg-schedule__table"),i=this._container.querySelector(".dg-schedule__now"),n=" dg-schedule__today_shown_true";e&&("block"===e.style.display?(e.style.display="none",i.style.display="block",t.className=t.className.replace(n,"")):(i.style.display="none",e.style.display="block",t.className+=n),this.options.onToggle&&this.options.onToggle())},_setOptions:function(t){var e,t=t||{};this.options=t,t.lang=t.lang||"ru";for(e in t)t.hasOwnProperty(e)&&(this.options[e]=t[e])},_hasTouch:function(){return"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0}},FirmCard.DataHelper={FLAMP_URL:"http://flamp.ru/r/",FLAMP_GOOGLE_ANALYTICS:"utm_source=api2gis&utm_medium=api&utm_campaign=geoclicker",payMethods:["americanexpress","cash","dinersclub","goldcrown","internet","mastercard","noncash","visa"],_msgs:{},getFlampUrl:function(t){return this.FLAMP_URL.concat(t,"?",this.FLAMP_GOOGLE_ANALYTICS)},msg:function(t){return this._msgs.hasOwnProperty(t)?this._msgs[t]:(console&&console.log("Cant't find translation for '"+t+"'."),t.toString().replace("_"," "))},getProjectTime:function(t,e){var i,n;return i=e?new Date(e):new Date,t?(n=i.getTime()+6e4*i.getTimezoneOffset(),new Date(n+6e4*t)):i}},function(){FirmCard.List=function(t,e){this._firms={},this._setOptions(e),this._container=e&&e.container||document.createElement("ul"),this._container.setAttribute("class","dg-building-callout__list"),this._eventHandlersInited=!1,this._firmCard=this._createFirm(),this.renderList(t)},FirmCard.List.prototype={renderList:function(t){return t&&(this._toggleEventHandlers(),this.addFirms(t)),this.options.onListReady&&this.options.onListReady(this._container),this._container},_processFirms:function(t,e){if(t){var i="_"+e+"Firm";if(this._isArray(t))for(var n=0,o=t.length;o>n;n++)this[i](t[n]);else this[i](t)}},addFirms:function(t){this._processFirms(t,"add")},removeFirms:function(t){this._processFirms(t,"remove")},setLang:function(t){this.options.firmCard.lang=t},getLang:function(){return this.options.firmCard.lang},getContainer:function(){return this._container},clearList:function(){this._firms={},this._toggleEventHandlers(!0),this._clearContainer()},_removeFirm:function(t){return this._firms[t]?(this._container.removeChild(this._firms[t]),void delete this._firms[t]):!1},_addFirm:function(t){var e,i,n,o=this.options.firmlistItemTmpl;i={name:t.name,id:t.id.split("_").slice(0,1)},i.id in this._firms||(e=this._createListItem(),n=o?this.options.firmCard.render(o,{firm:i}):i.name,e.insertAdjacentHTML("beforeend",n),this._firms[i.id]=e,this._container.appendChild(e))},_createListItem:function(){var t=document.createElement("li");return t.setAttribute("class","dg-building-callout__list-item"),t},_isArray:function(t){return"[object Array]"==={}.toString.call(t)},_createFirm:function(t){return new FirmCard(t,this.options.firmCard)},_isEmptyObj:function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0},_events:{"dg-popup__link":function(t){var e=this._firmCard.render(t.id);this.options.firmCard[this._isEmptyObj(e)?"pasteLoader":"onFirmReady"](e),this.options.firmCard.onFirmClick&&this.options.firmCard.onFirmClick(),this._toggleEventHandlers(!0)},"dg-building-callout__list-item":function(t){t=t.children[0],this._events["dg-popup__link"].call(this,t)},"dg-popup__button_name_back":function(){this.options.firmCard.onShowLess(),this._toggleEventHandlers(!0)}},_toggleEventHandlers:function(t){this.options.firmCard.popup[t?"off":"on"]("click",this._onClick,this)},_onClick:function(t){var e=t.originalEvent.target;for(var i in this._events)if(this._events.hasOwnProperty(i)&&e.className.indexOf(i)>-1)return void this._events[i].call(this,e)},_clearContainer:function(){for(var t=this._container;t.hasChildNodes();)t.removeChild(t.firstChild)},_setOptions:function(t){t||(t={}),this.options=t,this.options.firmCard||(this.options.firmCard={}),t.firmCard.lang||(this.options.firmCard.lang="ru");for(var e in t)t.hasOwnProperty(e)&&(this.options[e]=t[e])}}}(),FirmCard.Schedule=function(t){return t=t||{},this.localLang=t.localLang||"ru",this.dict=t.dict,this},FirmCard.Schedule.prototype={setLang:function(t){return this.localLang=t||"ru",this},transform:function(t,e){function i(t,e){var i=arguments.length>2?Array.prototype.slice.call(arguments,2):null;return function(){return t.apply(e,i||arguments)}}function n(t){return t.charAt(0).toUpperCase()+t.slice(1)}function o(t){return t.substr(0,2)}function r(t){return t.substr(3,2)}function s(t){var e=+o(t)%24+"";return 1===e.length&&(e="0"+e),e+":"+r(t)}function a(t){return t%7}function l(t,e){return null==t?void 0:null==e?t[t.length-1]:slice.call(t,Math.max(t.length-e,0))}function c(t,e){if(t===e)return!0;if(!(t instanceof Object&&e instanceof Object))return!1;if(t.constructor!==e.constructor)return!1;for(var i in t)if(t.hasOwnProperty(i)){if(!e.hasOwnProperty(i))return!1;if(t[i]!==e[i]){if("object"!=typeof t[i])return!1;if(!c(t[i],e[i]))return!1}}for(i in e)if(e.hasOwnProperty(i)&&!t.hasOwnProperty(i))return!1;return!0}function u(t,e,i){arguments.length<=1&&(e=t||0,t=0),i=arguments[2]||1;for(var n=Math.max(Math.ceil((e-t)/i),0),o=0,r=new Array(n);n>o;)r[o++]=t,t+=i;return r}function h(t){var e=Array.prototype.slice.call(arguments,1);return e.forEach(function(e){if(e)for(var i in e)void 0===t[i]&&(t[i]=e[i])}),t}function d(t,e){return p(t.map(function(t,i,n){return{value:t,index:i,criteria:e.call(this,t,i,n)}}).sort(function(t,e){var i=t.criteria,n=e.criteria;if(i!==n){if(i>n||void 0===i)return 1;if(n>i||void 0===n)return-1}return t.index-e.index}),"value")}function p(t,e){var i,n=[];for(i=0;i<t.length;++i)n[i]=t[i][e];return n}function f(t){var e,i,n,s,a=[];if(!t||!t.working_hours)return[];for(var l=0;l<t.working_hours.length;l++)e=t.working_hours[l].from,i=t.working_hours[l].to,n=o(i)-o(e),s=r(i)-r(e),(0>n||0===n&&0>=s)&&(i=+o(i)+24+":"+r(i)),a[2*l]={time:e,type:"open"},a[2*l+1]={time:i,type:t.working_hours.length-1===l?"close":"lunch"};return a}function m(t){for(var e,i,n=[],s=[],l=E.indexOf(w),c=0;7>c;c++)i=a(l+c),e=f(t[E[i]]),e.forEach(function(t){var e=new Date(T);e.setDate(e.getDate()+c),e.setHours(o(t.time)),e.setMinutes(r(t.time));var i=e.getTime();n.push({ts:i,type:t.type}),n[n.length-1]&&n[n.length-2]&&n[n.length-1].ts===n[n.length-2].ts&&(n.pop(),n.pop()),n[n.length-1]&&n[n.length-2]&&n[n.length-1].ts<=T&&n[n.length-2].ts<=T&&(n[n.length-1].ts+=6048e5,n[n.length-2].ts+=6048e5)});for(n=d(n,function(t){return t.ts}),c=0;c<n.length;)n[c+1]&&n[c].ts===n[c+1].ts?c++:s.push(n[c].ts),c++;return 2===s.length&&s[1]-s[0]===6048e5?[]:n}function _(t,e,i){if(1===e&&t>z)return R(A,"tommorow");if(e>1)switch(i){case 0:return R(A,"nextSun");case 1:return R(A,"nextMon");case 2:return R(A,"nextTue");case 3:return R(A,"nextWed");case 4:return R(A,"nextThu");case 5:return R(A,"nextFri");case 6:return R(A,"nextSat")}}function g(t,e){var i,n=864e5,o=new Date(t.ts);return i=Math.round((o-e)/n),"open"===t.type&&o.getHours()<1&&i++,i}function y(e){var i,n,o=[];P.now={},n=m(t),n.length||(P.always=!0,P.now.open=!0);for(var r=0;r<n.length;r++)if(T>=(n[r-1]&&n[r-1].ts||0)&&T<n[r].ts){var a=Math.floor((n[r].ts-T)/36e5),c=Math.floor((n[r].ts-T)/6e4-60*a),u=new Date(T),h="open"!==n[r].type,d=g(n[r],u);c=10*Math.floor(c/10)?10*Math.floor(c/10):5,P.now.open=h,P.now.lunch=!!(n[r-1]&&"lunch"===n[r-1].type||"lunch"===l(n).type),P.will={willType:n[r].type,d:d,h:a,m:c};var y=new Date(n[r].ts);P.will.when=_(a,d,y.getDay());var v=new Date(n[r].ts),L=v.getHours(),b=v.getMinutes();10>L&&(L="0"+L),10>b&&(b="0"+b),P.will.till=L+":"+b}if(e){for(i=p(f(e),"time"),r=2;r<i.length;r+=2)o.push({from:i[r-1],to:i[r]});D=s(i[0]),k=s(i[i.length-1]),P.today=D===k?{alltime:!0,alltimeStr:R(A,"worksAroundTheClock")}:{from:D,to:k},o.length>0&&(P.lunch=o,P.lunchStr=R(A,"lunch"))}}function v(){for(var e=[],i=!1,n=0;7>n;n++){var o=E[n],r=0;if(e[n]={},t[o]){for(var a=t[o],l=p(f(a),"time"),c=[],d=2;d<l.length;d+=2)i=!0,c.push({from:l[d-1],to:l[d]});r=Math.max(l.length/2,r),e[n]={from:s(l[0]),to:s(l[l.length-1]),lunch:c}}o===w&&(e[n].active=!0),e[n].key=O[n]}return e.forEach(function(t){t.lunch&&h(t.lunch,u(1,r))}),{table:e,hasLunch:i}}function L(t,e){var i,o={dayList:[],lunch:[]},r=[];if(t&&t.working_hours&&t.working_hours.length){i=p(f(t),"time"),i.forEach(function(t,e){0===e?o.from=s(t):e===i.length-1?o.to=s(t):r.push(s(t))});for(var l=0;l<r.length;l+=2)o.lunch.push({from:r[l],to:r[l+1],lunchStr:n(R(A,"lunch"))});t.round_the_clock&&(o.alltime=!0,o.alltimeStr=R(A,"worksAroundTheClock"))}else o.holiday=!0;var u=[0,0,0,0,0,0,0],h=0;return E.forEach(function(i,n){if(c(e[i],t)||!e[i]&&null===t)o.dayList.push(S[n]),u[a(n+Z)]=1,h++;else{if(h>2){for(var r=o.dayList.pop(),s=1;h-1>s;s++)o.dayList.pop();o.dayList[o.dayList.length-1]+="  "+r}h=0}}),o.budni=c(B,u),o.everyday=1===Math.min.apply(Math,u),o.holiday&&(o.holidayStr=R(A,"restDay",o.dayList.length).slice(2)),o.dayList=o.dayList.join(", "),o.dayList=o.dayList.charAt(0).toUpperCase()+o.dayList.slice(1),o}function b(t,e){for(var i=[],n=t.length-1;n>=0;n--)i.push(L(t[n],e));return i}if(t){e=e||{};for(var w,x,D,k,C=e.zoneOffset||0,P={},T=e.now||FirmCard.DataHelper.getProjectTime(C).getTime(),E=[],O=[],S=[],G=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],M=["monday","tuesday","wednesday","thursday","friday","saturday","sunday"],A=e.localLang||this.localLang,B=e.localWorkingDays||[0,1,1,1,1,1,0],Z=e.firstdayOffset||1,z=e.minHoursToDisplayClosure||4,R=i(this.dict.t,this.dict),N=0;7>N;N++)E[N]=G[N],O[N]=this.dict.t(A,G[N].toLowerCase()),S[N]=this.dict.t(A,M[N]);w=G[(new Date(T).getDay()-Z)%7],x=t[w],y(x);var I=[],U=0,j=0,H=[];if(Object.keys(t).forEach(function(e){t[e]&&t[e].working_hours&&(U++,c(t[e],l(I))||I.push(t[e]))}),j=I.length,7>U&&j++,j>2)P.week=v(t);else if(1===j)P.week={evently:[L(t[E[0]],t)]};else{for(N=0;j>N;N++)if(H[N]=0,I[N])for(var F=p(f(I[N]),"time"),W=0;W<F.length;W+=2){var q=o(F[W+1])+r(F[W+1])/60-(o(F[W])+r(F[W])/60);H[N]+=q}else I[N]=null;var V=d(I,function(t,e){return H[e]});P.week={evently:b(V,t)}}return P.comment=t.comment,P.week&&P.week.evently&&1===P.week.evently.length&&(P.everyday=P.week.evently[0].everyday),P}},forecast:function(t,e){var i,n,o="",r={},s=e&&e.maxHours||1;return t?t.always?{today:{text:this.dict.t(this.localLang,"aroundTheClock")},open:!0}:(t.will&&t.will.h<s&&(t.will.h&&(o+=this.dict.t(this.localLang,"nHours",t.will.h)+" "),t.will.m&&(o+=this.dict.t(this.localLang,"nMins",t.will.m))),t.today?(r.text=this.dict.t(this.localLang,"today"),t.everyday&&(r.text=this.dict.t(this.localLang,"everyday")),r.from=t.today.from,r.to=t.today.to,r.lunch=t.lunch,r.lunch&&(r.lunchStr=this.dict.t(this.localLang,"lunch"))):r.text=this.dict.t(this.localLang,"todayIsRestDay"),t.always||t.today&&t.today.alltime?(r.text=this.dict.t(this.localLang,"aroundTheClock"),i=!0):t.now&&(i=t.now.open,n=i?t.will&&"lunch"===t.will.willType?t.will&&t.will.h<s?this.dict.t(this.localLang,"in")+" "+this.dict.t(this.localLang,"nMins",o)+this.dict.t(this.localLang,"isClosingOnDinner"):this.dict.t(this.localLang,"isOpen"):t.will.h<s?this.dict.t(this.localLang,"closeIn")+this.dict.t(this.localLang,"nMins",o):this.dict.t(this.localLang,"isOpen"):t.will&&t.will.when?this.dict.t(this.localLang,"open")+t.will.when:t.now&&t.now.lunch?t.will.h<s?this.dict.t(this.localLang,"Lunch")+this.dict.t(this.localLang,"openIn")+this.dict.t(this.localLang,"nMins",o):this.dict.t(this.localLang,"Lunch")+this.dict.t(this.localLang,"openAt")+t.will.till:t.will&&t.will.h<s?this.dict.t(this.localLang,"openIn")+this.dict.t(this.localLang,"nMins",o):this.dict.t(this.localLang,"openAt")+t.will.till),{today:r,now:n,open:i,week:t.week,comment:t.comment,everyday:t.everyday}):{}}},FirmCard.prototype.dict={t:function(t,e,i){var n,o,r,s=!1;return"undefined"==typeof this[t]&&(t="ru"),o=this[t][e],(s="undefined"!=typeof o)?(n=s?o:e,i!==undefined&&(i=parseInt(i,10),i=isNaN(i)?0:i,r=this[t].pluralRules(i),n=i+" "+o[r]),n?n:e):e},ru:{pluralRules:function(t){return t%10===1&&t%100!==11?0:t%10>=2&&4>=t%10&&t%10%1===0&&(12>t%100||t%100>14)?1:t%10===0||t%10>=5&&9>=t%10&&t%10%1===0||t%100>=11&&14>=t%100&&t%100%1===0?2:void 0},btnBack:"",btnFindWay:" ",btnEntrance:" ",linkReviews:["","",""],linkPhoto:["","",""],linkBooklet:"",tommorow:"",afterTommorow:"",afterWeek:" ",nextSun:" ",nextMon:" ",nextTue:" ",nextWed:" ",nextThu:" ",nextFri:" ",nextSat:" ",willOpen:"",willClose:"",isOpen:"",openTill:"  ",closeIn:"  ",openAt:"  ",openIn:"  ",open:" ",nHours:["","",""],nMins:["","",""],lunch:"",Lunch:". ",workingDays:" ",weekdays:" ",restDay:["","",""],reviewsOnFlamp:"  ",writeReviewOnFlamp:"   ",payment:"",everyday:" c",worksAroundTheClock:" ",aroundTheClock:"",knowMore:" ",toClose:" ",monday:"",tuesday:"",wednesday:"",thursday:"",friday:"",saturday:"",sunday:"",mon:"",tue:"",wed:"",thu:"",fri:"",sat:"",sun:"",toLunch:" ",today:"",lessThenHour:" ",youCouldLate:"   ",workingTime:" ",showAllOrgInRubric:"   ",todayIsRestDay:" ",internet:"  ",noncash:" ",goldcrown:" ",dinersclub:"Diners Club",mastercard:"Mastercard",maestrocard:"MaestroCard",visa:"Visa",cash:" ",americanexpress:"American Express",hour:"",less:"",_in:"",isClosingOnDinner:"   "},it:{pluralRules:function(t){return 1===t?0:1},btnBack:"Indietro",btnFindWay:"Come arrivare ",btnEntrance:"Trova l'ingresso",linkReviews:["recensione","recensioni"],linkPhoto:["fotografia","fotografie"],linkBooklet:"Sull'azienda",tommorow:"domani",afterTommorow:"dopodomani",afterWeek:"tra una settimana",nextSun:"la domenica",nextMon:"il lunedi",nextTue:"il marted",nextWed:"il mercoled",nextThu:"il giovedi",nextFri:"il venerd",nextSat:"il sabato",willOpen:"apre",willClose:"ciuso",isOpen:"Aperto",openTill:"Aperto fino alle ",closeIn:"Chiude tra ",openAt:"Apre alle ",openIn:"Apre tra ",open:"Apre ",nHours:["ora","ore"],nMins:["minuto","minuti"],lunch:"pausa pranzo",Lunch:"Pausa pranzo. ",workingDays:"Giorni feriali",weekdays:"Giorni feriali",restDay:["chiusura","chiusura"],reviewsOnFlamp:"Recensioni su Flamp",writeReviewOnFlamp:"Scrivi una recensione su Flamp",payment:"pagamento",everyday:"Ogni giorno dalole",worksAroundTheClock:"Operativo 24 ore su 24",aroundTheClock:"24 ore su 24",knowMore:"ulteriori informazioni",toClose:"fino alla chiusura",monday:"lunedi",tuesday:"marted",wednesday:"mercoled",thursday:"giovedi",friday:"venerd",saturday:"sabato",sunday:"domenica",mon:"lun",tue:"mar",wed:"mer",thu:"gio",fri:"ven",sat:"sab",sun:"dom",toLunch:"fino alla pausa pranzo",today:"Oggi",lessThenHour:"meno di un'ora",youCouldLate:"affrettarsi, chiusura imminente",workingTime:"orario di lavoro",showAllOrgInRubric:"Visualizza tutte le aziende della categoria",todayIsRestDay:"oggi chiuso",internet:"Pagamento on-line",noncash:"Pagamento non in contanti",goldcrown:"Zolotaja Korona",dinersclub:"Diners Club",mastercard:"MasterCard",maestrocard:"MaestroCard",visa:"Visa",cash:"Pagamento in contanti",americanexpress:"American Express",hour:"un'ora",less:"meno di",_in:"Tra",isClosingOnDinner:"chiude per pausa pranzo"},en:{pluralRules:function(t){return 1===t?0:1},btnBack:"Back",btnFindWay:"Get here",btnEntrance:"Find entrance",linkReviews:["review","reviews"],linkPhoto:["photo","photos"],linkBooklet:"About company",tommorow:"tomorrow",afterTommorow:"the day after tomorrow",afterWeek:"in a week",nextSun:"on Sunday",nextMon:"on Monday",nextTue:"on Tuesday",nextWed:"on Wednesday",nextThu:"on Thursday",nextFri:"on Friday",nextSat:"on Saturday",willOpen:"opens ",willClose:"closes",isOpen:"Open",openTill:"Open till ",closeIn:"Closes in ",openAt:"Opens at ",openIn:"Opens in",open:"Opens ",nHours:["hour","hours"],nMins:["minute","minutes"],lunch:"lunch break",Lunch:"Lunch break. ",workingDays:"Working days",weekdays:"Weekdays",restDay:["day off","days off"],reviewsOnFlamp:"Reviews on Flamp",writeReviewOnFlamp:"Write a review on Flamp",payment:"payment",everyday:"Daily from",worksAroundTheClock:"Open 24 hours",aroundTheClock:"24h",knowMore:"see also",toClose:"until closing",monday:"Monday",tuesday:"Tuesday",wednesday:"Wednesday",thursday:"Thursday",friday:"Friday",saturday:"Saturday",sunday:"Sunday",mon:"Mon",tue:"Tue",wed:"Wed",thu:"Thu",fri:"Fri",sat:"Sat",sun:"Sun",toLunch:"until lunch",today:"Today",lessThenHour:"less then one hour",youCouldLate:"you might be late",workingTime:"working hours",showAllOrgInRubric:"Show all organizations in the category",todayIsRestDay:"closed today",internet:"Online",noncash:" No-cash",goldcrown:"Golden Crown",dinersclub:"Diners Club",mastercard:"Mastercard",maestrocard:"MaestroCard",visa:"Visa",cash:"Cash",americanexpress:"American Express",hour:"hour",less:"less",_in:"In",isClosingOnDinner:"will be closing for lunch"},cs:{pluralRules:function(t){return 1===t?0:t>=2&&4>=t?1:2},btnBack:"Zpt",btnFindWay:"Jet sem",btnEntrance:"Hledat vstup",linkReviews:["recenze","recenze","recenz"],linkPhoto:["fotografie","fotografie","fotografi"],linkBooklet:"Letk",tommorow:"ztra",afterTommorow:"pozt",afterWeek:"za tden",nextSun:"v nedli",nextMon:"v pondl",nextTue:"v ter",nextWed:"ve stedu",nextThu:"ve tvrtek",nextFri:"v ptek",nextSat:"v sobotu",willOpen:"oteve se",willClose:"zave se",isOpen:"Oteveno",openTill:"Oteveno do ",closeIn:"Zave se za ",openAt:"Oteve se v ",openIn:"Oteve se za ",open:"Oteve se ",nHours:["hodinu","hodiny","hodin"],nMins:["minutu","minuty","minut"],lunch:"poledn pestvka",Lunch:"Poledn pestvka. ",workingDays:"Vedn dny",weekdays:"Vedn dny",restDay:["zaveno","zaveno"],reviewsOnFlamp:"Recenze na Flampu",writeReviewOnFlamp:"Napsat recenzi na Flampu",payment:"platba",everyday:"Denn od ",worksAroundTheClock:"Pracuje nonstop",aroundTheClock:"Nonstop",knowMore:"dozvdt se vce",toClose:"do uzaven",monday:"pondl",tuesday:"ter",wednesday:"steda",thursday:"tvrtek",friday:"ptek",saturday:"sobota",sunday:"nedle",mon:"po",tue:"t",wed:"st",thu:"t",fri:"p",sat:"so",sun:"ne",toLunch:"do poledn pestvky",today:"Dnes",lessThenHour:"mn ne hodinu",youCouldLate:"nemuste to stihnout",workingTime:"pracovn doba",showAllOrgInRubric:"Zobrazit vechny organizace v rubrice",todayIsRestDay:"Dnes je zaveno",internet:"Platba prostednictvm Internetu",noncash:"Bezhotovostn platba",goldcrown:"Zolotaja Korona",dinersclub:"Diners Club",mastercard:"Mastercard",maestrocard:"MaestroCard",visa:"Visa",cash:"Platba hotov",americanexpress:"American Express",hour:"hodinu",less:"mn",_in:"Za",isClosingOnDinner:"zan poledn pestvka"},sp:{pluralRules:function(t){return 1===t?0:t>=2&&4>=t?1:2},btnBack:"Atrs",btnFindWay:"Ir para all",btnEntrance:"Buscar acceso",linkReviews:["comentario","comentarios","comentarios"],linkPhoto:["foto","fotos","fotos"],linkBooklet:"Folleto",tommorow:"maana",afterTommorow:"pasado maana",afterWeek:"en una semana ms",nextSun:"el domingo",nextMon:"el lunes",nextTue:"el martes",nextWed:"el mircoles",nextThu:"el jueves",nextFri:"el viernes",nextSat:"el sbado",willOpen:"se abrir",willClose:"se cerrar",isOpen:"Abierto",openTill:"Abierto hasta ",closeIn:"Se cerrar dentro de ",openAt:"Se abrir el ",openIn:"Se abrir dentro de ",open:"Se abrir ",nHours:["hora","horas","horas"],nMins:["minuto","minutos","minutos"],lunch:"hora de colacin",Lunch:"Hora de colacin. ",workingDays:"Das laborables",weekdays:"Das laborables",restDay:["cerrado","cerrado"],reviewsOnFlamp:"Comentarios en Flamp",writeReviewOnFlamp:"Escribir un comentario en Flamp",payment:"pago",everyday:"Cada da desde",worksAroundTheClock:"Abierto las 24 horas",aroundTheClock:"24 horas",knowMore:"para saber ms",toClose:"hasta el cierre",monday:"lunes",tuesday:"martes",wednesday:"mircoles",thursday:"jueves",friday:"viernes",saturday:"sbado",sunday:"domingo",mon:"lun",tue:"mar",wed:"mi",thu:"jue",fri:"vie",sat:"sb",sun:"dom",toLunch:"antes de la hora de colacin",today:"Hoy",lessThenHour:"menos de una hora",youCouldLate:"puede ser que no alcanzas a llegar",workingTime:"horario de trabajo",showAllOrgInRubric:"Mostrar todas las empresas de la categora",todayIsRestDay:"Hoy cerrado",internet:"Pago por Internet",noncash:"Pago sin efectivo",goldcrown:"Zolotaya Korona",dinersclub:"Diners Club",mastercard:"Mastercard",maestrocard:"MaestroCard",visa:"Visa",cash:"Pago en efectivo",americanexpress:"American Express",hour:"hora",less:"menos de",_in:"Dentro de",isClosingOnDinner:"se cierra por hora de colacin"}},DG.Traffic=DG.TileLayer.extend({options:{period:0,disableLabel:!1},statics:{tileUrl:"http://traffic{s}.2gis.ru/{projectCode}/traffic/{z}/{x}/{y}/speed/{period}/{timestampString}",metaUrl:"http://meta{s}.2gis.ru/{projectCode}/meta/{z}/{x}/{y}/graph_speed/{period}/{timestampString}",timeUrl:"http://traffic{s}.2gis.ru/{projectCode}/meta/speed/time/",updateInterval:3e5,layersOptions:{errorTileUrl:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",subdomains:"012345679",maxNativeZoom:18,detectRetina:!0,minZoom:10}},initialize:function(t){t=DG.setOptions(this,DG.extend(t||{},DG.Traffic.layersOptions)),t.timestampString=t.period?"":"?"+(new Date).getTime(),this._metaLayer=DG.Meta.layer(null,{detectRetina:t.detectRetina,maxNativeZoom:t.maxNativeZoom,dataFilter:DG.bind(this._processData,this),minZoom:t.minZoom}),this._isDg=!0,this._onTimer=DG.bind(this._onTimer,this),DG.TileLayer.prototype.initialize.call(this,DG.Traffic.tileUrl,t)},onAdd:function(t){this._updateLayerProject(),t.addLayer(this._metaLayer).on("projectchange projectleave",this._onMapProjectChange,this),this.options.disableLabel||(this._metaLayer.on(this._layerEventsListeners,this),this._labelHelper=DG.label()),DG.Traffic.updateInterval&&(this._updateTimer=setInterval(this._onTimer,DG.Traffic.updateInterval)),DG.TileLayer.prototype.onAdd.call(this,t)},onRemove:function(t){clearInterval(this._updateTimer),t.removeLayer(this._metaLayer).off("projectchange projectleave",this._onMapProjectChange,this),this.options.disableLabel||(this._metaLayer.off(this._layerEventsListeners,this),this._map.removeLayer(this._labelHelper),this._labelHelper=null),DG.TileLayer.prototype.onRemove.call(this,t)
},update:function(){this._getTimestampString().then(function(t){this.options.timestampString="?"+t},function(){this.options.timestampString="?"+(new Date).getTime()}).then(function(){this.fire("update",{timestamp:this.options.timestampString}),this._layerEventsListeners.mouseout.call(this),this._metaLayer.getOrigin().setURL(this._prepareMetaURL(),!0),this.redraw()})},_getTimestampString:function(){return DG.ajax(DG.Util.template(DG.Traffic.timeUrl,DG.extend({s:this._getSubdomain(),projectCode:this._map.projectDetector.getProject().code},this.options||{})),{type:"get"})},_getSubdomain:function(){return DG.Traffic.layersOptions.subdomains[Math.floor(Math.random()*DG.Traffic.layersOptions.subdomains.length)]},_onTimer:function(){0===this.options.period&&this.update()},_processData:function(t,e){var i=this._map,n=e.multiplyBy(this._getTileSize()),o={};return DG.Util.isArray(t)?(t[1].forEach(function(t){this[t.graph_id]=t.speed_text},o),t[0].map(function(t){var e=DG.Wkt.toGeoJSON(t.geometry[0].object[0]);return e.coordinates[0]=e.coordinates[0].map(function(t){return i.project([t[1],t[0]]).round().subtract(n)}),{id:t.graph_id,speed:o[t.graph_id],geometry:e}})):[]},_prepareMetaURL:function(){return DG.Util.template(DG.Traffic.metaUrl,DG.extend({x:"{x}",y:"{y}",z:"{z}",s:"{s}"},this.options))},_updateLayerProject:function(){var t=this._map.projectDetector.getProject();DG.setOptions(this,t&&t.traffic?{projectCode:t.code,bounds:t.latLngBounds,minZoom:Math.max(t.minZoom,DG.Traffic.layersOptions.minZoom),maxZoom:t.maxZoom}:{maxZoom:0,minZoom:0}),this._metaLayer.getOrigin().setURL(this._prepareMetaURL())},_onMapProjectChange:function(){this._updateLayerProject(),this.redraw()},_layerEventsListeners:{mouseover:function(t){this._setCursor("pointer"),this._labelHelper&&t.meta.speed&&this._labelHelper.setPosition(t.latlng).setContent(t.meta.speed+" /").addTo(this._map)},mouseout:function(){this._setCursor("auto"),this._labelHelper&&this._map.removeLayer(this._labelHelper)},mousemove:function(t){this._labelHelper&&this._labelHelper.setPosition(t.latlng)}},_setCursor:function(t){this._map.getContainer().style.cursor=t}}),DG.Ruler=DG.Layer.extend({options:{editable:!0},includes:[DG.Locale],statics:{Dictionary:{}},initialize:function(t,e){DG.Util.setOptions(this,e),this._layers={back:null,middle:null,front:null,mouse:null},this._points=[],this._layersContainer=DG.featureGroup(),Object.keys(this._layers).forEach(function(t){this._layersContainer.addLayer(this._layers[t]=DG.featureGroup())},this),this._reset(),DG.Browser.touch?(delete this._lineMouseEvents.mouseover,delete this._lineMouseEvents.mouseout,delete this._lineMouseEvents.mousemove):delete this._lineMouseEvents.click,t&&t.length&&this.setLatLngs(t)},onAdd:function(t){this._map=t.on("langchange",this._updateDistance,this),this._maxLat=t.unproject([0,0],0).lat,this._map.getPane("rulerLabelPane")||this._map.createPane("rulerLabelPane"),this._map.getPane("rulerEventPane")||this._map.createPane("rulerEventPane"),this._layersContainer.addTo(this._map),this._points.length&&(this._layers.mouse.fire("layeradd"),this._updateDistance()),this._layers.mouse.on(this._lineMouseEvents,this)},onRemove:function(t){t.off("langchange",this._updateDistance,this).removeLayer(this._layersContainer),this._layers.mouse.off(this._lineMouseEvents,this),this._reset()},getTotalDistance:function(){return this._calcDistance()},spliceLatLngs:function(t){var e=this._points.length,i=t>=0?Math.min(t,e):e-t,n=Array.prototype.splice.apply(this._points,arguments).map(function(t){return this._layers.mouse.removeLayer(t),t.off().getLatLng()},this),o=this._points.length;if(o){for(var r=i;o>r;r++)this._points[r]instanceof DG.Ruler.LayeredMarker||(this._points[r]=this._createPoint(this._points[r],this.options.iconStyles.large).on(this._pointEvents,this).once("add",this._addCloseHandler,this).addTo(this._layers.mouse,this._layers)),r&&!this._points[r-1]._legs&&this._addLegs(this._points[r-1]),this._points[r].setPointStyle(this.options.iconStyles[r&&o-1>r?"small":"large"]),this._points[r]._pos=r;this._removeLegs(this._points[o-1]),e>0&&o>e&&this._points[e-1].collapse(),this._points[i]&&this._updateLegs(this._points[i]),i>1&&this._points[i-1].setPointStyle(this.options.iconStyles.small),this._updateDistance()}return DG.Browser.touch&&this._lineMarkerHelper&&this._lineMarkerHelper.collapse(),this._fireChangeEvent(),n},addLatLng:function(t){var e=this._points[this._points.length-1]||null,t=DG.latLng(t);if(t.lat=Math.max(Math.min(this._maxLat,t.lat),-this._maxLat),e){var i=e.getLatLng(),n=t.wrap(),o=i.wrap(),r=n.lng-o.lng;Math.abs(t.lng-i.lng)>180&&(t.lng=i.lng+r,r=t.lng-i.lng,Math.abs(r-360)<Math.abs(r)&&(t.lng-=360))}return this.spliceLatLngs(this._points.length,0,t),this},getLatLngs:function(){return this._points.map(function(t){return t.getLatLng()})},setLatLngs:function(t){var e=t.slice();return e.unshift(0,this._points.length),this.spliceLatLngs.apply(this,e),this},_reset:function(){DG.extend(this,{_lineMarkerHelper:null,_morphingNow:!1})},_lineMouseEvents:{click:function(t){var e=t.layer;if(e instanceof DG.Marker&&e._pos!==this._points.length-1)this._lineMarkerHelper&&this._lineMarkerHelper.collapse(),e.setText(this._getFormatedDistance(e)),this._lineMarkerHelper=e;else if(e instanceof DG.Path&&this.options.editable){var i=t.latlng,n=e._point._pos+1;this.spliceLatLngs(n,0,i)}},mouseover:function(t){var e=t.layer;if(e._hovered=!0,!this._morphingNow)if(e instanceof DG.Marker&&e._pos!==this._points.length-1)e.setText(this._getFormatedDistance(e));else if(e instanceof DG.Path&&!this._lineMarkerHelper){var i=e._point;this._lineMarkerHelper=this._addRunningLabel(this._interpolate(i.getLatLng(),this._points[i._pos+1].getLatLng(),t.latlng),i)}},mouseout:function(t){var e=t.layer,i=t.originalEvent;e._hovered=!1,this._morphingNow||e._pos===this._points.length-1||(e instanceof DG.Marker?(!i.relatedTarget||i.relatedTarget!==e.querySelector("container")&&i.relatedTarget.parentNode!==e.querySelector("container"))&&e.collapse():this._removeRunningLabel())},mousemove:function(t){if(!this._morphingNow&&this._lineMarkerHelper){var e=t.layer._point,i=this._interpolate(e.getLatLng(),this._points[e._pos+1].getLatLng(),t.latlng);this._lineMarkerHelper.setLatLng(i).setText(this._getFormatedDistance(e,e.getLatLng().distanceTo(i)))}},layeradd:function(){Object.keys(this._layers).forEach(function(t){this._layers[t].bringToFront()},this)}},_fireChangeEvent:function(){this.fire("changed",{latlngs:this.getLatLngs()})},_addRunningLabel:function(t,e){var i=this._createPoint(t).addTo(this._layers.mouse,this._layers);return this._map.getPane("rulerLabelPane").appendChild(i._icon),i.setText(this._getFormatedDistance(e,e.getLatLng().distanceTo(t)))},_removeRunningLabel:function(){this._lineMarkerHelper&&(this._layers.mouse.removeLayer(this._lineMarkerHelper),this._lineMarkerHelper=null)},_insertPointInLine:function(t){var e,i=this._lineMarkerHelper.getLatLng(),n=t.target._point._pos+1;if(L.Browser.ie){var o=t.originalEvent.target||t.originalEvent.srcElement,r=o.parentNode;r.appendChild(o)}if(L.DomEvent.stopPropagation(t.originalEvent),this.spliceLatLngs(n,0,i),e=this._points[n],e.setText(this._getFormatedDistance(e)),document.createEvent){var s=document.createEvent("MouseEvents");s.initMouseEvent("mousedown",!1,!1,document.defaultView,1,0,0,0,0,!1,!1,!1,!1,1,e._icon),e._icon.dispatchEvent(s)}else e._icon.fireEvent("onMouseDown",DG.extend(document.createEventObject(),{button:1,bubbles:!1,cancelable:!1}));this._removeRunningLabel(),this._updateLegs(e)},_interpolate:function(t,e,i){var n=this._map.latLngToLayerPoint(t),o=this._map.latLngToLayerPoint(e),r=this._map.latLngToLayerPoint(i),s=(o.x-n.x)/(o.y-n.y),a=n.x-s*n.y;return isNaN(s)?i:(isFinite(s)?(r.y=(r.y+s*r.x-s*a)/(s*s+1),r.x=s*r.y+a):r.y=o.y,this._map.layerPointToLatLng(r))},_addCloseHandler:function(t){t.target.on("click",this._deletePoint,this).querySelector("remove-link").style.display="inline-block"},_createPoint:function(t,e){var i=e?e:this.options.iconStyles.large,n={};return Object.keys(i).forEach(function(e){n[e]=DG.circleMarker(t,i[e])}),DG.Ruler.layeredMarker(t,{layers:n,draggable:this.options.editable})},_pointEvents:{drag:function(t){var e=t.target,i=e.getLatLng(),n=this._points[e._pos-1]||null,o=i.wrap();if(n){var r=n.getLatLng(),s=r.wrap(),a=o.lng-s.lng;Math.abs(i.lng-r.lng)>180&&(o.lng=r.lng+a,a=o.lng-r.lng,Math.abs(a-360)<Math.abs(a)&&(o.lng-=360))}o.lat=Math.max(Math.min(this._maxLat,o.lat),-this._maxLat),i.equals(o)||e.setLatLng(o),DG.Browser.touch||e===this._points[this._points.length-1]||e.setText(this._getFormatedDistance(e)),this._updateLegs(e),this._updateDistance()},dragend:function(t){var e=t.target;this._morphingNow=!1,e._hovered||e===this._points[this._points.length-1]||e.collapse(),this._fireChangeEvent()},dragstart:function(){DG.Browser.touch&&this._lineMarkerHelper&&this._lineMarkerHelper.collapse(),this._morphingNow=!0}},_deletePoint:function(t){var e=t.originalEvent,i=e.target||e.srcElement;"dg-ruler__label-remove-link"===i.className&&(DG.DomEvent.stop(t.originalEvent),this.spliceLatLngs(t.target._pos,1))},_addLegs:function(t){var e=[t.getLatLng(),this._points[t._pos+1].getLatLng()],i=this.options.pathStyles;t._legs={},Object.keys(i).forEach(function(n){t._legs[n]=DG.polyline(e,i[n]).addTo(this._layers[n])},this),t._legs.mouse._point=t.once("remove",this._clearRemovingPointLegs,this),this.options.editable&&!DG.Browser.touch&&t._legs.mouse.on("mousedown",this._insertPointInLine,this),this._map&&this._layers.mouse.addLayer(t._legs.mouse)},_clearRemovingPointLegs:function(t){this._removeLegs(t.target)},_removeLegs:function(t){t._legs&&(Object.keys(t._legs).forEach(function(e){this._layers[e].removeLayer(t._legs[e])},this),t._legs=null)},_updateLegs:function(t){var e=t.getLatLng(),i=this._points[t._pos-1];i&&Object.keys(i._legs).forEach(function(t){i._legs[t].spliceLatLngs(1,1,e)}),t._legs&&Object.keys(t._legs).forEach(function(i){t._legs[i].spliceLatLngs(0,1,e)})},_calcDistance:function(t,e){for(var i=e?e:0,n=t?t._pos:this._points.length-1,o=0;n>o;o++)i+=this._points[o].getLatLng().distanceTo(this._points[o+1].getLatLng());return i},_getFormatedDistance:function(){var t=this._calcDistance.apply(this,arguments),e="m";return t>1e3?(t/=1e3,e="km",t>1e3?(t=t.toFixed(),t=t.slice(0,-3)+" "+t.slice(-3)):t=t.toFixed(2).split(".").join(this.t("delimiter"))):t=Math.round(t),[t||0," ",this.t(e)].join("")},_updateDistance:function(){this._map&&this._points.length&&this._points[this._points.length-1].setText(this._getFormatedDistance())}}),DG.ruler=function(t,e){return new DG.Ruler(t,e)},DG.Ruler.LayeredMarker=DG.Marker.extend({options:{draggable:!1,keyboard:!1,riseOnHover:!0,iconHTML:DG.dust({RulerLayeredMarker:'(function(){dust.register("RulerLayeredMarker",body_0);function body_0(chk,ctx){return chk.write("<img class=\\"dg-ruler__label-spacer\\" src=\\"").reference(ctx.get(["blankgif"], false),ctx,"h").write("\\" width=\\"26\\" height=\\"26\\" /><div class=\\"dg-ruler__label-container\\"><div class=\\"dg-ruler__point\\"></div><span class=\\"dg-ruler__label-distance\\">0 </span><span class=\\"dg-ruler__label-remove-link\\"></span></div>");}return body_0;})();'})("RulerLayeredMarker",{blankgif:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"})},statics:{domClass:"dg-ruler__label"},addTo:function(t,e){return Object.keys(this._layers).forEach(function(t){e[t].addLayer(this._layers[t])},this),this._viewport=e,DG.Marker.prototype.addTo.call(this.on("move",this._onMove),t)},onRemove:function(t){return Object.keys(this._layers).forEach(function(t){this._viewport[t].removeLayer(this._layers[t])},this),this.off("move",this._onMove),this._viewport=null,this._style=null,DG.Marker.prototype.onRemove.call(this,t)},setText:function(t){return this._iconCollapsed&&this.expand(),this._iconNodes.label.innerHTML=t,this},setPointStyle:function(t){return this._style!==t&&Object.keys(this._style=t).forEach(function(e){this._layers[e].setStyle(t[e])},this),this},expand:function(){return this._iconCollapsed=!1,this._iconNodes.container.style.display="block",this._iconNodes.spacer.style.display="none",this},collapse:function(){return this._iconCollapsed=!0,this._iconNodes.container.style.display="none",this._iconNodes.spacer.style.display="block",this},querySelector:function(t){return this._icon.querySelector("."+DG.Ruler.LayeredMarker.domClass+"-"+t)},_onMove:function(t){var e=t.latlng;Object.keys(this._layers).forEach(function(t){this._layers[t].setLatLng(e)},this)},_initIcon:function(){DG.Marker.prototype._initIcon.call(this),this._iconCollapsed=!0,this._icon.style.width="",this._iconNodes={label:this.querySelector("distance"),spacer:this.querySelector("spacer"),container:this.querySelector("container")}},_afterInit:function(){this._layers=this.options.layers||null,this.options.icon=DG.divIcon({className:DG.Ruler.LayeredMarker.domClass,iconSize:[26,26],iconAnchor:[13,13],html:this.options.iconHTML})}}),DG.Ruler.LayeredMarker.addInitHook("_afterInit"),DG.Ruler.layeredMarker=function(t,e){return new DG.Ruler.LayeredMarker(t,e)},DG.Ruler.mergeOptions({pathStyles:{back:{color:"#fff",opacity:1,weight:12,pointerEvents:"none",noClip:!0},middle:{color:"#0da5d5",opacity:1,weight:4,pointerEvents:"none",noClip:!0},mouse:{color:"#fff",opacity:DG.Browser.vml?.1:0,weight:DG.Browser.touch?30:20,pointerEvents:"painted",noClip:!0,renderer:DG.svg({pane:"rulerEventPane"})}},iconStyles:{large:{back:{color:"#fff",opacity:1,fillColor:"#fff",fillOpacity:1,weight:1,radius:13},middle:{color:"#0da5d5",opacity:1,fillColor:"#0da5d5",fillOpacity:1,weight:1,radius:9},front:{color:"#fff",opacity:1,fillColor:"#0da5d5",fillOpacity:1,weight:4,radius:5}},small:{back:{color:"#fff",opacity:1,fillColor:"#fff",fillOpacity:1,weight:1,radius:9},middle:{color:"#0da5d5",opacity:1,fillColor:"#0da5d5",fillOpacity:1,weight:1,radius:5},front:{color:"#fff",opacity:1,fillColor:"#0da5d5",fillOpacity:1,weight:4,radius:2}}}}),DG.Ruler.Dictionary.ru={km:"",m:"",delimiter:","},DG.Ruler.Dictionary.it={km:"km",m:"m",delimiter:","},DG.Ruler.Dictionary.cs={km:"km",m:"m",delimiter:","},DG.Ruler.Dictionary.en={km:"km",m:"m",delimiter:"."},DG.Control.Ruler=DG.RoundControl.extend({options:{position:DG.Browser.touch?"topright":"topright",iconClass:"ruler"},statics:{Dictionary:{}},initialize:function(t){DG.setOptions(this,t),DG.extend(this,{_active:!1,_drawingHelper:null,_geoclickerNeedRestore:!1}).on(this._controlEvents,this)},_controlEvents:{add:function(){this._drawingHelper=DG.ruler([])},click:function(){(this._active=!this._active)?(this.setState("active"),this._startDrawing()):(this.setState(""),this._finishDrawing())},remove:function(){this.off(this._controlEvents,this),this._active&&(this._map.removeLayer(this._drawingHelper),this._active=!1),this._drawingHelper=null}},_startDrawing:function(){this._map.addLayer(this._drawingHelper).on("click",this._handleMapClick,this),(this._geoclickerNeedRestore=this._map.geoclicker.enabled())&&this._map.geoclicker.disable()},_finishDrawing:function(){this._map.off("click",this._handleMapClick,this).removeLayer(this._drawingHelper),this._drawingHelper.setLatLngs([]),this._geoclickerNeedRestore&&this._map.geoclicker.enable()},_handleMapClick:function(t){this._drawingHelper.addLatLng(t.latlng)},_renderTranslation:function(){this._link.title=this.t("button_title")}}),DG.control.ruler=function(t){return new DG.Control.Ruler(t)},DG.Control.Ruler.Dictionary.ru={button_title:""},DG.Control.Ruler.Dictionary.it={button_title:"Righello"},DG.Control.Ruler.Dictionary.cs={button_title:"Pravtko"},DG.Control.Ruler.Dictionary.en={button_title:"Ruler"},DG.projectsList=JSON.parse('[{"code":"dubai","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[25.3594948791612,54.869562514047],[24.7632874786908,55.6805973057252]],"transport":true,"country_code":"ae"},{"code":"nicosia","minZoom":11,"maxZoom":19,"timeOffset":180,"traffic":null,"bound":[[35.1987707992976,33.2687509662567],[35.0319573115252,33.444017180855]],"transport":true,"country_code":"cy"},{"code":"limassol","minZoom":11,"maxZoom":19,"timeOffset":180,"traffic":null,"bound":[[34.7703607532978,32.8183135920874],[34.5438286066823,33.1907346326479]],"transport":true,"country_code":"cy"},{"code":"praha","minZoom":10,"maxZoom":18,"timeOffset":120,"traffic":null,"bound":[[50.1810860167697,14.2155277221934],[49.9348968592983,14.7152445225123]],"transport":true,"country_code":"cz"},{"code":"santiago","minZoom":9,"maxZoom":19,"timeOffset":-240,"traffic":null,"bound":[[-33.2933344386246,-70.8571559326759],[-33.6656911332218,-70.477275853484]],"transport":true,"country_code":"cl"},{"code":"padova","minZoom":9,"maxZoom":18,"timeOffset":120,"traffic":null,"bound":[[45.733676894531,11.3550232420912],[45.0713376120054,12.6119895276371]],"transport":true,"country_code":"it"},{"code":"abakan","minZoom":9,"maxZoom":18,"timeOffset":480,"traffic":null,"bound":[[53.9015991783199,91.1443354820045],[53.5690755348627,91.8266893298874]],"transport":true,"country_code":"ru"},{"code":"almaty","minZoom":9,"maxZoom":18,"timeOffset":360,"traffic":null,"bound":[[43.4691062728438,76.7159906079459],[43.1080512298167,77.1084003103972]],"transport":true,"country_code":"kz"},{"code":"armawir","minZoom":9,"maxZoom":17,"timeOffset":240,"traffic":null,"bound":[[45.2494434710022,40.8594002590691],[44.7217907137017,41.3225777015129]],"transport":false,"country_code":"ru"},{"code":"arkhangelsk","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[64.8299663594085,39.4581178646537],[64.2843046637163,41.3211748549048]],"transport":true,"country_code":"ru"},{"code":"astrakhan","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[46.5114180332153,47.8630461031191],[46.2412594424995,48.1858117765388]],"transport":true,"country_code":"ru"},{"code":"barnaul","minZoom":9,"maxZoom":18,"timeOffset":420,"traffic":null,"bound":[[53.4866943332863,83.4457915421126],[53.1585977185895,84.0879338133862]],"transport":true,"country_code":"ru"},{"code":"belgorod","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[50.7012708979842,36.4192775789588],[50.4896543997067,36.7297789382699]],"transport":true,"country_code":"ru"},{"code":"biysk","minZoom":9,"maxZoom":18,"timeOffset":420,"traffic":null,"bound":[[52.6467045850268,84.5688944220223],[51.8999054497981,85.4924852888349]],"transport":true,"country_code":"ru"},{"code":"blagoveshensk","minZoom":9,"maxZoom":18,"timeOffset":600,"traffic":null,"bound":[[50.6016337995515,127.345035031789],[50.2234615060572,127.764412544165]],"transport":true,"country_code":"ru"},{"code":"bratsk","minZoom":9,"maxZoom":18,"timeOffset":540,"traffic":null,"bound":[[56.5026192394777,101.059737892132],[55.9299233950519,102.059776879738]],"transport":true,"country_code":"ru"},{"code":"bryansk","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[53.4315561076653,34.1154331064172],[53.1385223432934,34.6044250273834]],"transport":true,"country_code":"ru"},{"code":"v_novgorod","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[58.6836311433635,31.1313939673071],[58.460419032672,31.5146936934116]],"transport":true,"country_code":"ru"},{"code":"vladivostok","minZoom":9,"maxZoom":18,"timeOffset":660,"traffic":null,"bound":[[43.6161503849791,131.558590917919],[42.8034461532445,132.343684662068]],"transport":true,"country_code":"ru"},{"code":"vladimir","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[56.4678197302654,40.1651931755232],[56.0282399334087,40.6951681216888]],"transport":true,"country_code":"ru"},{"code":"volgograd","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[48.926670316375,43.9705863650486],[48.3141239996045,44.9308652223579]],"transport":true,"country_code":"ru"},{"code":"vologda","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[59.3372883440336,39.6083029151405],[59.1505226260905,40.0779393502863]],"transport":true,"country_code":"ru"},{"code":"voronezh","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[51.9109946780922,38.991158599251],[51.4755906110023,39.6130839292656]],"transport":true,"country_code":"ru"},{"code":"gornoaltaysk","minZoom":9,"maxZoom":18,"timeOffset":420,"traffic":null,"bound":[[52.1564900132681,85.484610371617],[51.2492150337467,86.4583690517566]],"transport":true,"country_code":"ru"},{"code":"dnepropetrovsk","minZoom":9,"maxZoom":18,"timeOffset":180,"traffic":null,"bound":[[48.6134306493271,34.7377337368383],[48.3416398323942,35.2804085323086]],"transport":true,"country_code":"ua"},{"code":"donetsk","minZoom":9,"maxZoom":18,"timeOffset":180,"traffic":null,"bound":[[48.1899246968246,37.5105114766436],[47.7957685401294,38.2461880381853]],"transport":true,"country_code":"ua"},{"code":"ekaterinburg","minZoom":9,"maxZoom":18,"timeOffset":360,"traffic":null,"bound":[[57.0360972497062,60.2323966049092],[56.5987021059971,60.9432235390061]],"transport":true,"country_code":"ru"},{"code":"ivanovo","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[57.0895563231668,40.7975852131989],[56.8913132671641,41.1894046504891]],"transport":true,"country_code":"ru"},{"code":"izhevsk","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[57.0578889623075,52.9319474531077],[56.667542646897,53.4956246123276]],"transport":true,"country_code":"ru"},{"code":"irkutsk","minZoom":9,"maxZoom":18,"timeOffset":540,"traffic":null,"bound":[[52.6495505470413,103.61885265925],[51.7104431825847,104.970806765863]],"transport":true,"country_code":"ru"},{"code":"yoshkarola","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[56.7614824238658,47.5724319594027],[56.5075290418687,48.1532971643141]],"transport":true,"country_code":"ru"},{"code":"kazan","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":true,"bound":[[55.9985321999877,48.2911801344625],[55.5666240080291,49.5354766561195]],"transport":true,"country_code":"ru"},{"code":"kaliningrad","minZoom":9,"maxZoom":18,"timeOffset":180,"traffic":null,"bound":[[55.0555275190424,19.8390820730563],[54.5341370930145,20.6635158806876]],"transport":true,"country_code":"ru"},{"code":"kaluga","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[54.768523303849,35.8948119960599],[54.321023875665,36.4822327020629]],"transport":true,"country_code":"ru"},{"code":"karaganda","minZoom":9,"maxZoom":18,"timeOffset":360,"traffic":null,"bound":[[50.1326228965457,72.8600516728832],[49.6499299479317,73.4106297758395]],"transport":true,"country_code":"kz"},{"code":"kemerovo","minZoom":9,"maxZoom":18,"timeOffset":420,"traffic":null,"bound":[[55.5340608911615,85.9450122062621],[55.2625138080209,86.2636635398232]],"transport":true,"country_code":"ru"},{"code":"kirov","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[58.7970043097645,49.0367663786028],[58.4004858362436,49.9477913096825]],"transport":true,"country_code":"ru"},{"code":"komsomolsk","minZoom":9,"maxZoom":18,"timeOffset":660,"traffic":null,"bound":[[50.7214129619197,136.772703975404],[50.1898152981203,137.25849332936]],"transport":true,"country_code":"ru"},{"code":"kostroma","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[57.9243829139543,40.7214314515157],[57.67573203432,41.1518646193995]],"transport":true,"country_code":"ru"},{"code":"krasnodar","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[45.2653815276283,38.6500825330806],[44.9435556403579,39.3785683912585]],"transport":true,"country_code":"ru"},{"code":"krasnoyarsk","minZoom":9,"maxZoom":18,"timeOffset":480,"traffic":true,"bound":[[56.3082630018158,92.1268459382326],[55.8114064072845,93.5992902134282]],"transport":true,"country_code":"ru"},{"code":"kurgan","minZoom":9,"maxZoom":18,"timeOffset":360,"traffic":null,"bound":[[55.5302725837859,65.154661854512],[55.3686573232533,65.4828564327176]],"transport":true,"country_code":"ru"},{"code":"kursk","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[51.8427867070403,35.8893687666608],[51.5567989765477,36.4353464063142]],"transport":true,"country_code":"ru"},{"code":"lenkuz","minZoom":9,"maxZoom":18,"timeOffset":420,"traffic":null,"bound":[[54.7742516260722,85.750103030145],[54.1794040086072,86.502902682772]],"transport":true,"country_code":"ru"},{"code":"lipetsk","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[52.7198786376779,39.3744800918884],[52.4905468986541,39.8233601260659]],"transport":true,"country_code":"ru"},{"code":"magnitogorsk","minZoom":9,"maxZoom":18,"timeOffset":360,"traffic":null,"bound":[[53.9270251812668,58.5231189866109],[53.229864600768,59.5042256487398]],"transport":true,"country_code":"ru"},{"code":"miass","minZoom":9,"maxZoom":18,"timeOffset":360,"traffic":null,"bound":[[55.2802176970506,59.5219849332694],[54.8881930582153,60.2583981001619]],"transport":true,"country_code":"ru"},{"code":"moscow","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[56.1094645977258,36.7589630188729],[55.1040131369395,38.2250238758651]],"transport":true,"country_code":"ru"},{"code":"murmansk","minZoom":9,"maxZoom":17,"timeOffset":240,"traffic":null,"bound":[[69.0647309236923,32.7011582977228],[68.7610654352291,33.225324591575]],"transport":false,"country_code":"ru"},{"code":"nabchelny","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[55.8651827397231,51.7114250622956],[55.5366753807398,52.6281801079216]],"transport":true,"country_code":"ru"},{"code":"nahodka","minZoom":10,"maxZoom":18,"timeOffset":660,"traffic":null,"bound":[[42.9073312963002,132.750811365032],[42.7221230837219,133.039450970885]],"transport":true,"country_code":"ru"},{"code":"nizhnevartovsk","minZoom":9,"maxZoom":18,"timeOffset":360,"traffic":null,"bound":[[61.1909352794372,75.9222574752004],[60.8511814719134,77.0285826533205]],"transport":true,"country_code":"ru"},{"code":"n_novgorod","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[56.477411442321,43.2970731741298],[56.0722356112843,44.254810900154]],"transport":true,"country_code":"ru"},{"code":"ntagil","minZoom":9,"maxZoom":18,"timeOffset":360,"traffic":null,"bound":[[58.0917067294675,59.7631849308233],[57.7492987364741,60.3478866058688]],"transport":true,"country_code":"ru"},{"code":"novokuznetsk","minZoom":9,"maxZoom":18,"timeOffset":420,"traffic":null,"bound":[[54.1214727777433,86.5106241243864],[53.4975544807196,87.463656218798]],"transport":true,"country_code":"ru"},{"code":"novorossiysk","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[45.2228043807585,36.9363062359741],[44.3059631288764,38.6732772531146]],"transport":true,"country_code":"ru"},{"code":"novosibirsk","minZoom":9,"maxZoom":18,"timeOffset":420,"traffic":true,"bound":[[55.2490377237671,82.5066233224136],[54.5530320115648,83.3965344854664]],"transport":true,"country_code":"ru"},{"code":"norilsk","minZoom":9,"maxZoom":18,"timeOffset":480,"traffic":null,"bound":[[69.5621896177523,87.2622339743829],[69.2428195922557,88.5071759113989]],"transport":true,"country_code":"ru"},{"code":"noyabrsk","minZoom":9,"maxZoom":18,"timeOffset":360,"traffic":null,"bound":[[63.8791873127812,74.3047801716227],[63.0182507475118,76.2633721430807]],"transport":true,"country_code":"ru"},{"code":"odessa","minZoom":9,"maxZoom":18,"timeOffset":180,"traffic":null,"bound":[[46.6567177224677,30.5121680865866],[46.2534222532502,30.9112859230213]],"transport":true,"country_code":"ua"},{"code":"omsk","minZoom":9,"maxZoom":18,"timeOffset":420,"traffic":null,"bound":[[55.4176310259015,72.8835180581471],[54.7851241105205,73.7716648340022]],"transport":true,"country_code":"ru"},{"code":"orenburg","minZoom":9,"maxZoom":18,"timeOffset":360,"traffic":null,"bound":[[51.9359751569834,54.9204112369225],[51.6634793355125,55.4962313546675]],"transport":true,"country_code":"ru"},{"code":"orel","minZoom":9,"maxZoom":17,"timeOffset":240,"traffic":null,"bound":[[53.1037386186541,35.8541701954474],[52.8389951050595,36.3152979165854]],"transport":true,"country_code":"ru"},{"code":"penza","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[53.3490815216318,44.7954767846358],[53.0655658707405,45.3588094775773]],"transport":true,"country_code":"ru"},{"code":"perm","minZoom":9,"maxZoom":18,"timeOffset":360,"traffic":null,"bound":[[58.2439105904424,55.610474882024],[57.6859949037923,56.6620402090133]],"transport":true,"country_code":"ru"},{"code":"petrozavodsk","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[61.9594765659225,34.0933638416971],[61.6914724689462,34.708850211665]],"transport":true,"country_code":"ru"},{"code":"p_kamchatskiy","minZoom":9,"maxZoom":17,"timeOffset":720,"traffic":null,"bound":[[53.349661949953,158.195687134229],[52.855708398081,159.025519427086]],"transport":true,"country_code":"ru"},{"code":"pskov","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[57.8891060477973,28.1635000325078],[57.7271382707715,28.4915311006639]],"transport":true,"country_code":"ru"},{"code":"minvody","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[44.3052018858753,42.5968656508625],[43.8079983597538,43.5306793178291]],"transport":true,"country_code":"ru"},{"code":"rostov","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[47.3681524785198,39.3566267162468],[47.0533140450719,39.9248376695462]],"transport":true,"country_code":"ru"},{"code":"ryazan","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[54.882191015661,39.4020022067783],[54.4873429393359,39.992107259096]],"transport":true,"country_code":"ru"},{"code":"samara","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[53.7133859816235,49.7777262793471],[53.0390499541524,50.524471412358]],"transport":true,"country_code":"ru"},{"code":"spb","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":true,"bound":[[60.2925612478519,29.4108877598293],[59.5352624321976,31.0279705658238]],"transport":true,"country_code":"ru"},{"code":"saransk","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[54.3019028278782,44.8670169699494],[53.9846323149273,45.5117203772106]],"transport":true,"country_code":"ru"},{"code":"saratov","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[51.6998086891669,45.7306106842113],[51.353162626011,46.3147731596003]],"transport":true,"country_code":"ru"},{"code":"smolensk","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[54.8893106126968,31.7550015053805],[54.6878753760871,32.2686727097693]],"transport":true,"country_code":"ru"},{"code":"sochi","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[44.3548122819334,38.9364797786377],[43.3632495745264,40.488511351502]],"transport":true,"country_code":"ru"},{"code":"stavropol","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[45.2695581782036,41.6581173946841],[44.892929962064,42.3241147988394]],"transport":true,"country_code":"ru"},{"code":"staroskol","minZoom":10,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[51.3779381963195,37.7448617887827],[51.2468619996829,37.9821663678883]],"transport":true,"country_code":"ru"},{"code":"sterlitamak","minZoom":9,"maxZoom":18,"timeOffset":360,"traffic":null,"bound":[[53.7369873772458,55.8056723048395],[53.3028756985379,56.1328304018719]],"transport":true,"country_code":"ru"},{"code":"surgut","minZoom":9,"maxZoom":18,"timeOffset":360,"traffic":null,"bound":[[61.40828807144,72.3817595909749],[60.9771606899594,73.7971635380408]],"transport":true,"country_code":"ru"},{"code":"syktyvkar","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[61.9227103772726,50.4315252227783],[61.5703415422949,51.275080406535]],"transport":true,"country_code":"ru"},{"code":"tambov","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[52.8265633445323,41.2688277615465],[52.5613158585861,41.6015800087645]],"transport":true,"country_code":"ru"},{"code":"tver","minZoom":9,"maxZoom":17,"timeOffset":240,"traffic":null,"bound":[[57.0175457772806,35.5310822658554],[56.6655939617203,36.314300499486]],"transport":true,"country_code":"ru"},{"code":"tobolsk","minZoom":9,"maxZoom":17,"timeOffset":360,"traffic":null,"bound":[[58.3372049677334,68.0274608759476],[58.0611370960295,68.6305907886217]],"transport":true,"country_code":"ru"},{"code":"togliatti","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[53.7081249432729,48.9618270538152],[53.0282107408725,49.7967348046849]],"transport":true,"country_code":"ru"},{"code":"tomsk","minZoom":9,"maxZoom":18,"timeOffset":420,"traffic":null,"bound":[[56.5956943056455,84.7686556891859],[56.3480256494226,85.2465320183285]],"transport":true,"country_code":"ru"},{"code":"tula","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[54.3185426012515,37.4140448385478],[53.8995391159124,38.4215849170042]],"transport":true,"country_code":"ru"},{"code":"tyumen","minZoom":9,"maxZoom":18,"timeOffset":360,"traffic":null,"bound":[[57.269890105758,65.2132212676953],[56.3976776719812,66.6908512938406]],"transport":true,"country_code":"ru"},{"code":"ulanude","minZoom":9,"maxZoom":18,"timeOffset":540,"traffic":null,"bound":[[52.0564825771179,107.358424043204],[51.691351260689,107.990789310771]],"transport":true,"country_code":"ru"},{"code":"ulyanovsk","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[54.4707243909343,48.0311106679108],[54.1049832769207,48.7744246507962]],"transport":true,"country_code":"ru"},{"code":"ussuriysk","minZoom":9,"maxZoom":18,"timeOffset":660,"traffic":null,"bound":[[43.9718774327491,131.749240836303],[43.7080787530987,132.142052300421]],"transport":true,"country_code":"ru"},{"code":"ustkam","minZoom":9,"maxZoom":18,"timeOffset":360,"traffic":null,"bound":[[50.0591923546681,82.4448367555293],[49.8579588549296,82.8057177665881]],"transport":true,"country_code":"kz"},{"code":"ufa","minZoom":9,"maxZoom":18,"timeOffset":360,"traffic":true,"bound":[[54.9572844664839,55.7150899042712],[54.4785240461723,56.3124162045037]],"transport":true,"country_code":"ru"},{"code":"khabarovsk","minZoom":9,"maxZoom":18,"timeOffset":660,"traffic":null,"bound":[[48.6071036747544,134.873582147183],[48.2885778879321,135.259035742564]],"transport":true,"country_code":"ru"},{"code":"cheboksary","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[56.3420261123137,46.9895856513309],[55.9808449192766,47.6057602491808]],"transport":true,"country_code":"ru"},{"code":"chelyabinsk","minZoom":9,"maxZoom":18,"timeOffset":360,"traffic":null,"bound":[[55.3198262824454,61.1854857912442],[54.9904623855663,61.744580331559]],"transport":true,"country_code":"ru"},{"code":"chita","minZoom":9,"maxZoom":18,"timeOffset":600,"traffic":null,"bound":[[52.1861143043843,113.10211240076],[51.926502007168,113.639183599285]],"transport":true,"country_code":"ru"},{"code":"yuzhnosakhalinsk","minZoom":9,"maxZoom":18,"timeOffset":660,"traffic":null,"bound":[[47.5156337690436,142.447679650444],[46.5832085759882,142.971757646538]],"transport":true,"country_code":"ru"},{"code":"yakutsk","minZoom":9,"maxZoom":18,"timeOffset":600,"traffic":null,"bound":[[62.1878305123633,129.525801925885],[61.8005013951169,129.99230258145]],"transport":true,"country_code":"ru"},{"code":"yaroslavl","minZoom":9,"maxZoom":18,"timeOffset":240,"traffic":null,"bound":[[57.7761985248821,39.7178413590056],[57.5193090101217,40.0128826713777]],"transport":true,"country_code":"ru"}]')
}(this,document);